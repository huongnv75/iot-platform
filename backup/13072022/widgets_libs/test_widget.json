{
  "widgetsBundle": {
    "alias": "test_widget",
    "title": "test_widget",
    "image": null,
    "description": null
  },
  "widgetTypes": [
    {
      "alias": "asset_admin_table",
      "name": "admin_test_linhnv10",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 6.5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
          }
        ],
        "templateHtml": "<div class=\"container\">\r\n          <div class=\"header_wrap\">\r\n    <input type=\"text\" id=\"search_input_all\" onkeyup=\"filterAllTable()\" placeholder=\"Tìm kiếm\" class=\"form-control\">\r\n    </div>\r\n    <table id=\"table_stage\"\r\n        class=\"table table-striped table-bordered table-fixed\" >\r\n    </table>\r\n    <div class='pagination-container'>\r\n\t\t<div class=\"pagination\">\r\n          <a>&laquo;</a>\r\n          <a class=\"active\">1</a>\r\n          <a>2</a>\r\n          <a>3</a>\r\n          <a>4</a>\r\n          <a>5</a>\r\n          <a>&raquo;</a>\r\n        </div>\r\n\t</div>\r\n    <div class=\"rows_count\"></div>\r\n</div>\r\n",
        "templateCss": "body{\n\n    background-color: #eee; \n}\n\ntable th , table td{\n    text-align: center;\n}\n\ntable tr:nth-child(even){\n    background-color: #e4e3e3\n}\n\nth {\n  background: #333;\n  color: #fff;\n}\n\n.pagination {\n  margin: 0;\n}\n\n.pagination li:hover{\n    cursor: pointer;\n}\n\n.header_wrap {\n  padding:30px 0;\n}\n.num_rows {\n  width: 20%;\n  float:left;\n}\n.tb_search{\n  width: 20%;\n  float:right;\n}\n.pagination-container {\n  float:right;\n}\n\n.rows_count {\n  width: 20%;\n  float:right;\n  text-align:right;\n  color: #999;\n}\n.pagination {\n  display: inline-block;\n}\n\n.pagination a {\n  color: black;\n  float: left;\n  padding: 8px 16px;\n  text-decoration: none;\n}\n.pagination a.active {\n  background-color: #0d6efd;\n  color: white;\n}",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\nvar list_stage;\r\nvar _data;\r\nlet customDialog;\r\nvar list_error;\r\nvar datasource;\r\nvar totalPages;\r\nvar stage_on_save;\r\nself.onInit = function () {\r\n\r\n    $scope = self.ctx.$scope;\r\n    utils = $scope.$injector.get(self.ctx.servicesMap.get(\r\n        'utils'));\r\n    settings = utils.deepClone(self.ctx.settings) || {};\r\n    settings.showLabel = utils.defaultValue(settings\r\n        .showLabel, true);\r\n    settings.showResultMessage = utils.defaultValue(settings\r\n        .showResultMessage, true);\r\n    $scope.settings = settings;\r\n    $scope = self.ctx.$scope;\r\n    customDialog = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('customDialog'));\r\n    attributeService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('attributeService'));\r\n    datasource = self.ctx.datasources;\r\n    console.log(\"datasource\",datasource);\r\n    getPagination(1);\r\n    $(document).ready(function () {\r\n        console.log(\"ready!\");\r\n        $('.pagination').on(\"click\", \"a\", function (e) {\r\n            e.preventDefault();\r\n            var pageNum = $(this).text();\r\n            if (pageNum == '«') {\r\n                preview();\r\n            } else if (pageNum == '»') {\r\n                next();\r\n            } else {\r\n                getPagination(pageNum);\r\n                $('.pagination a').removeClass('active');\r\n                $(this).addClass('active');\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfilterAllTable = function () {\r\n    var pageLink = self.ctx.pageLink();\r\n    pageLink.pageSize = 10;\r\n    pageLink.textSearch = $('#search_input_all').val();\r\n\r\n    assetService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('assetService'));\r\n\r\n    const partData = self.ctx.data;\r\n    assetService.getTenantAssetInfos(pageLink, \"stage\").subscribe(d => {\r\n        list_stage = d.data;\r\n\r\n        var list_stage_template =\r\n            '<table class=\"table\">' +\r\n            '<thead>' +\r\n            '<tr>' +\r\n            '<th scope=\"col\">STT</th>' +\r\n            '<th scope=\"col\">Mã công đoạn</th>' +\r\n            '<th scope=\"col\">Tên công đoạn</th>' +\r\n            '<th scope=\"col\">Hành động</th>' +\r\n            '</tr>' +\r\n            '</thead>' +\r\n            '<tbody>' +\r\n            infoTable_Stage(list_stage, 1) +\r\n            '</tbody>' +\r\n            '</table>'\r\n\r\n        $('#table_stage').html(list_stage_template);\r\n    });\r\n}\r\n\r\ngetPagination = function (page) {\r\n    var pageLink = self.ctx.pageLink();\r\n    pageLink.pageSize = 5;\r\n    pageLink.page = page;\r\n\r\n    assetService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('assetService'));\r\n\r\n    const partData = self.ctx.data;\r\n    assetService.getTenantAssetInfos(pageLink, \"stage\").subscribe(d => {\r\n        list_stage = d.data;\r\n        totalPages = d.totalPages;\r\n        var list_stage_template =\r\n            '<table class=\"table\">' +\r\n            '<thead>' +\r\n            '<tr>' +\r\n            '<th scope=\"col\">STT</th>' +\r\n            '<th scope=\"col\">Mã công đoạn</th>' +\r\n            '<th scope=\"col\">Tên công đoạn</th>' +\r\n            '<th scope=\"col\">Hành động</th>' +\r\n            '</tr>' +\r\n            '</thead>' +\r\n            '<tbody>' +\r\n            infoTable_Stage(list_stage, page) +\r\n            '</tbody>' +\r\n            '</table>'\r\n\r\n        $('#table_stage').html(list_stage_template);\r\n    });\r\n}\r\n\r\ninfoTable = function (data) {\r\n    console.log(\"data\", data);\r\n    var info = '';\r\n    var index = 1;\r\n    data.forEach((element, i) => {\r\n        info = info + `<tr><td>${index}</td><td>${element.name}</td><td>${element.label}</td><td class=\"status\"><input class=\"form-check-input\" type=\"checkbox\" class=\"checkBoxClass\" value=\"\" ${element.checked ? \"checked\" : \"\"}></td></tr>`\r\n        index = index + 1;\r\n    });\r\n\r\n    return info;\r\n\r\n}\r\nnext = function () {\r\n    var lastPage = parseInt($('.pagination a.active').text());\r\n    if (lastPage < totalPages) {\r\n        if (lastPage % 5 != 0) {\r\n            $('.pagination a').removeClass('active');\r\n            $('.pagination a:contains(' + (lastPage + 1) + ')').addClass('active');\r\n        } else {\r\n            $('.pagination').empty();\r\n            $('.pagination').append('<a>&laquo;</a>');\r\n            $('.pagination').append('<a class=\"active\">' + (lastPage + 1) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage + 2) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage + 3) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage + 4) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage + 5) + '</a>');\r\n            $('.pagination').append('<a>&raquo;</a>');\r\n        }\r\n        getPagination(lastPage + 1);\r\n    }\r\n}\r\npreview = function () {\r\n    var lastPage = parseInt($('.pagination a.active').text());\r\n    if (lastPage > 1) {\r\n        if (lastPage % 5 != 1) {\r\n            $('.pagination a').removeClass('active');\r\n            $('.pagination a:contains(' + (lastPage - 1) + ')').addClass('active');\r\n        } else {\r\n            $('.pagination').empty();\r\n            $('.pagination').append('<a>&laquo;</a>');\r\n            $('.pagination').append('<a>' + (lastPage - 5) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage - 4) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage - 3) + '</a>');\r\n            $('.pagination').append('<a>' + (lastPage - 2) + '</a>');\r\n            $('.pagination').append('<a class=\"active\">' + (lastPage - 1) + '</a>');\r\n            $('.pagination').append('<a>&raquo;</a>');\r\n        }\r\n        getPagination(lastPage - 1);\r\n    }\r\n}\r\ninfoTable_Stage = function (data, pageNumber) {\r\n    var info = '';\r\n    var index = (parseInt(pageNumber) - 1) * 5 + 1;\r\n    data.forEach((element, i) => {\r\n        console.log(\"element\", element);\r\n        var idStage = data[i].id ? data[i].id : 1;\r\n        info = info + `<tr><td>${index}</td><td>${element.name}</td><td>${element.label}</td><td><button id=\"start\" onClick=\"errForm(${i})\"type=\"button\"class=\"btn btn-primary btn-sm\" style=\"margin-right:5px\" >tích</button></tr>`\r\n        index = index + 1;\r\n    });\r\n    return info;\r\n\r\n}\r\n\r\nerrForm = function (i) {\r\n    const partData = self.ctx.data;\r\n    //     if (partData[0].data.length > 0) {\r\n    //         list_error = JSON.parse(partData[0].data[0][1]);\r\n    //     }\r\n    // else{\r\n    //     list_error = [];\r\n    // }\r\n\r\n    attributeService.getEntityAttributes(list_stage[i].id, 'SERVER_SCOPE', ['list_error']).subscribe(data => {\r\n        console.log(\"data[0]\", data[0].value)\r\n        list_error = data[0].value ? data[0].value : \"\";\r\n        stage_on_save = list_stage[i];\r\n\r\n        var infoDialogTemplate =\r\n            '<table id = \"table\" class=\"table\" style=\"height: 250px; display: block; overflow: auto;\" >' +\r\n            //   '<table id = \"table\" class=\"table\">' +\r\n            '<thead style=\"background: white;\">' +\r\n            // '<thead>' +\r\n            '<tr>' +\r\n            '<th scope=\"col\">STT</th>' +\r\n            '<th scope=\"col\">Mã lỗi</th>' +\r\n            '<th scope=\"col\">Tên lỗi</th>' +\r\n            '<th scope=\"col\">Trạng thái</th>' +\r\n            '</tr>' +\r\n            '</thead>' +\r\n            '<tbody>' +\r\n            infoTable(list_error) +\r\n            '</tbody>' +\r\n            '</table>'\r\n        infoDialogTemplate = infoDialogTemplate +\r\n            '<button type=\"button\" class=\"btn btn-danger btn-sm\" (click)=\"cancel()\" style=\"margin-right:10px; margin-bottom: 5px;float:right\">Đóng</button>' +\r\n            '<button id=\"update\" (click)=\"updateLine()\"' +\r\n            'type=\"button\"' +\r\n            'class=\"btn btn-success btn-sm\"  style=\"margin-right:5px\">Cập nhật</button>'\r\n        // '<button mat-button mat-icon-button (click)=\"cancel()\" type=\"button\"><mat-icon class=\"material-icons\">close</mat-icon></button>'\r\n\r\n        //   dialog = customDialog.customDialog(\r\n        //             infoDialogTemplate,\r\n        //             $scope.controlDialog).subscribe();\r\n        //openDialog(infoDialogTemplate);\r\n        //$('#table').append(infoDialogTemplate);\r\n        dialog = customDialog.customDialog(\r\n            infoDialogTemplate,\r\n            controlDialog).subscribe();\r\n        console.log(\"open dialog end: \", dialog);\r\n    });\r\n}\r\n\r\ncontrolDialog = async function (instance) {\r\n    let vm = instance;\r\n    vm.cancel = function () {\r\n        console.log(\"cancel\");\r\n        vm.dialogRef.close(null);\r\n    };\r\n    vm.updateLine = async function () {\r\n\r\n        //alert(\"555555\");\r\n        var list_err_save_group = [];\r\n        console.log(\"element\", stage_on_save);\r\n        var grid = document.getElementById(\"table\");\r\n\r\n        //Reference the CheckBoxes in Table.\r\n        var checkBoxes = grid.getElementsByTagName(\"INPUT\");\r\n        // var message = \"Id Name                  Country\\n\";\r\n        console.log(\"5555\",list_error);\r\n        //Loop through the CheckBoxes.\r\n        var index_save = 0;\r\n        for (var i = 0; i < checkBoxes.length; i++) {\r\n            if (checkBoxes[i].checked) {\r\n                list_error[i].checked = true;\r\n                list_err_save_group[index_save] =list_error[i];\r\n                index_save++;\r\n            } else {\r\n                list_error[i].checked = false;\r\n            }\r\n        }\r\n        //Cap nhat nhom loi\r\n        \r\n        // for (var i = 0; i < list_error.length; i++) {\r\n        //     var entityId_err = list_error[i].entityId;\r\n        //     console.log(\"list_error[i]\", list_error[i]);\r\n        //     var group_err;\r\n        //     //lay ten nhom loi\r\n\r\n        //     const myPromise = new Promise((resolve, reject) => {\r\n        //         attributeService.getEntityAttributes(entityId_err, 'SERVER_SCOPE', ['group_error']).subscribe(data => {\r\n        //             group_err = data[0] ? data[0].value[0] : \"NONE\";\r\n        //             console.log(\"group_err[i]\", group_err);\r\n\r\n        //             var elent_err_save = group_err;\r\n        //             // if (list_error[i].checked == true) {\r\n        //             //     console.log(\"group_err\", group_err);\r\n        //             // }\r\n        //             //list_err_save_group[i] = elent_err_save;\r\n\r\n        //         });\r\n        //     });\r\n        //     await myPromise;\r\n        //     list_err_save_group[i] = group_err;\r\n        // }\r\n\r\n        \r\n       // alert(\"3131313\");\r\n        console.log(\"list_error_luu lai\", list_err_save_group);\r\n        //console.log(\"list_error_luu lai\", list_err_save_group);\r\n\r\n        console.log(\"$scope.entityId\", datasource);\r\n        var attributeTimeSeries = [];\r\n        attributeTimeSeries.push({\r\n            key: stage_on_save.name,\r\n            value: list_err_save_group\r\n        });\r\n        attributeService.saveEntityAttributes(datasource[0].entity.id, 'SERVER_SCOPE', attributeTimeSeries).subscribe(\r\n            function success() {\r\n                console.log(\r\n                    \"Cập nhật trạng thái thành công\"\r\n                );\r\n                if (settings\r\n                    .showResultMessage\r\n                ) {\r\n                    $scope.showSuccessToast(\"Cập nhật thành công\");\r\n                }\r\n            },\r\n            function fail() {\r\n                if (settings\r\n                    .showResultMessage\r\n                ) {\r\n                    $scope.showErrorToast(\"Cập nhật thất bại\");\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n}\r\n\r\nself.listError = function () {\r\n    alert(\"11111\");\r\n}\r\nself.onDataUpdated = function () {\r\n}\r\n\r\n// updateLine = function () {\r\n//     console.log(\"list_error_in\", list_error);\r\n//     alert(\"111111\");\r\n//     var grid = document.getElementById(\"table\");\r\n\r\n//     //Reference the CheckBoxes in Table.\r\n//     var checkBoxes = grid.getElementsByTagName(\"INPUT\");\r\n//     // var message = \"Id Name                  Country\\n\";\r\n\r\n//     //Loop through the CheckBoxes.\r\n//     for (var i = 0; i < checkBoxes.length; i++) {\r\n//         if (checkBoxes[i].checked) {\r\n//             list_error[i].checked = true;\r\n//         } else {\r\n//             list_error[i].checked = false;\r\n//         }\r\n//     }\r\n\r\n//     //Display selected Row data in Alert Box.\r\n//     console.log(\"list_error_out\", list_error);\r\n//     console.log(\"$scope.entityId\", datasource[0].entity.id);\r\n//     var attributeTimeSeries = [];\r\n//     attributeTimeSeries.push({\r\n//         key: \"xxxxx\",\r\n//         value: list_error\r\n//     });\r\n//     attributeService.saveEntityAttributes(datasource[0].entity.id, 'SERVER_SCOPE', attributeTimeSeries).subscribe(\r\n//         function success() {\r\n//             console.log(\r\n//                 \"Cập nhật trạng thái thành công\"\r\n//             );\r\n//             if (settings\r\n//                 .showResultMessage\r\n//             ) {\r\n//                 $scope.showSuccessToast(\"Cập nhật thành công\");\r\n//             }\r\n//         },\r\n//         function fail() {\r\n//             if (settings\r\n//                 .showResultMessage\r\n//             ) {\r\n//                 $scope.showErrorToast(\"Cập nhật thất bại\");\r\n//             }\r\n//         }\r\n//     );\r\n\r\n// }\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"EntitiesTableSettings\",\n        \"properties\": {\n            \"entitiesTitle\": {\n                \"title\": \"Entities table title\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"enableSearch\": {\n                \"title\": \"Enable entities search\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"enableSelectColumnDisplay\": {\n                \"title\": \"Enable select columns to display\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"enableStickyHeader\": {\n                \"title\": \"Always display header\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"enableStickyAction\": {\n                \"title\": \"Always display actions column\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"displayEntityName\": {\n                \"title\": \"Display entity name column\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"entityNameColumnTitle\": {\n                \"title\": \"Entity name column title\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"displayEntityLabel\": {\n                \"title\": \"Display entity label column\",\n                \"type\": \"boolean\",\n                \"default\": false\n            },\n            \"entityLabelColumnTitle\": {\n                \"title\": \"Entity label column title\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"displayEntityType\": {\n                \"title\": \"Display entity type column\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"displayPagination\": {\n                \"title\": \"Display pagination\",\n                \"type\": \"boolean\",\n                \"default\": true\n            },\n            \"defaultPageSize\": {\n                \"title\": \"Default page size\",\n                \"type\": \"number\",\n                \"default\": 10\n            },\n            \"defaultSortOrder\": {\n                \"title\": \"Default sort order\",\n                \"type\": \"string\",\n                \"default\": \"entityName\"\n            },\n            \"useRowStyleFunction\": {\n                \"title\": \"Use row style function\",\n                \"type\": \"boolean\",\n                \"default\": false\n            },\n            \"rowStyleFunction\": {\n                \"title\": \"Row style function: f(entity, ctx)\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"entitiesTitle\",\n        \"enableSearch\",\n        \"enableSelectColumnDisplay\",\n        \"enableStickyHeader\",\n        \"enableStickyAction\",\n        \"displayEntityName\",\n        \"entityNameColumnTitle\",\n        \"displayEntityLabel\",\n        \"entityLabelColumnTitle\",\n        \"displayEntityType\",\n        \"displayPagination\",\n        \"defaultPageSize\",\n        \"defaultSortOrder\",\n        \"useRowStyleFunction\",\n        {\n            \"key\": \"rowStyleFunction\",\n            \"type\": \"javascript\",\n            \"condition\": \"model.useRowStyleFunction === true\"\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"DataKeySettings\",\n        \"properties\": {\n            \"columnWidth\": {\n                \"title\": \"Column width (px or %)\",\n                \"type\": \"string\",\n                \"default\": \"0px\"\n            },\n            \"useCellStyleFunction\": {\n                \"title\": \"Use cell style function\",\n                \"type\": \"boolean\",\n                \"default\": false\n            },\n            \"cellStyleFunction\": {\n                \"title\": \"Cell style function: f(value, entity, ctx)\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"useCellContentFunction\": {\n                \"title\": \"Use cell content function\",\n                \"type\": \"boolean\",\n                \"default\": false\n            },\n            \"cellContentFunction\": {\n                \"title\": \"Cell content function: f(value, entity, ctx)\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"defaultColumnVisibility\": {\n                \"title\": \"Default column visibility\",\n                \"type\": \"string\",\n                \"default\": \"visible\"\n            },\n            \"columnSelectionToDisplay\": {\n                \"title\": \"Column selection in 'Columns to Display'\",\n                \"type\": \"string\",\n                \"default\": \"enabled\"\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"columnWidth\",\n        \"useCellStyleFunction\",\n        {\n            \"key\": \"cellStyleFunction\",\n            \"type\": \"javascript\",\n            \"condition\": \"model.useCellStyleFunction === true\"\n        },\n        \"useCellContentFunction\",\n        {\n            \"key\": \"cellContentFunction\",\n            \"type\": \"javascript\",\n            \"condition\": \"model.useCellContentFunction === true\"\n        },\n        {\n            \"key\": \"defaultColumnVisibility\",\n            \"type\": \"rc-select\",\n            \"multiple\": false,\n            \"items\": [\n                {\n                    \"value\": \"visible\",\n                    \"label\": \"Visible\"\n                },\n                {\n                    \"value\": \"hidden\",\n                    \"label\": \"Hidden\"\n                }    \n            ]\n        },\n        {\n            \"key\": \"columnSelectionToDisplay\",\n            \"type\": \"rc-select\",\n            \"multiple\": false,\n            \"items\": [\n                {\n                    \"value\": \"enabled\",\n                    \"label\": \"Enabled\"\n                },\n                {\n                    \"value\": \"disabled\",\n                    \"label\": \"Disabled\"\n                }    \n            ]\n        }\n    ]\n}",
        "defaultConfig": "{\"timewindow\":{\"realtime\":{\"interval\":1000,\"timewindowMs\":86400000},\"aggregation\":{\"type\":\"NONE\",\"limit\":200}},\"showTitle\":true,\"backgroundColor\":\"rgb(255, 255, 255)\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"4px\",\"settings\":{\"enableSearch\":true,\"displayPagination\":true,\"defaultPageSize\":10,\"defaultSortOrder\":\"entityName\",\"displayEntityName\":true,\"displayEntityType\":true,\"entitiesTitle\":\"Asset admin table\",\"enableSelectColumnDisplay\":true},\"title\":\"admin_test_linhnv10\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400,\"padding\":\"5px 10px 5px 10px\"},\"useDashboardTimewindow\":false,\"showLegend\":false,\"datasources\":[{\"type\":\"function\",\"name\":\"Simulated\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#f44336\",\"settings\":{\"columnWidth\":\"0px\",\"useCellStyleFunction\":false,\"cellStyleFunction\":\"\",\"useCellContentFunction\":false,\"cellContentFunction\":\"\"},\"_hash\":0.6401141393938932,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"showTitleIcon\":false,\"titleIcon\":\"more_horiz\",\"iconColor\":\"rgba(0, 0, 0, 0.87)\",\"iconSize\":\"24px\",\"titleTooltip\":\"\",\"widgetStyle\":{},\"displayTimewindow\":true,\"actions\":{\"headerButton\":[{\"name\":\"Add asset\",\"icon\":\"add\",\"type\":\"customPretty\",\"customHtml\":\"<form #addAssetForm=\\\"ngForm\\\" [formGroup]=\\\"addAssetFormGroup\\\"\\n      (ngSubmit)=\\\"save()\\\" style=\\\"width: 480px;\\\">\\n  <mat-toolbar fxLayout=\\\"row\\\" color=\\\"primary\\\">\\n    <h2>Add asset</h2>\\n    <span fxFlex></span>\\n    <button mat-button mat-icon-button\\n            (click)=\\\"cancel()\\\"\\n            type=\\\"button\\\">\\n      <mat-icon class=\\\"material-icons\\\">close</mat-icon>\\n    </button>\\n  </mat-toolbar>\\n  <mat-progress-bar color=\\\"warn\\\" mode=\\\"indeterminate\\\" *ngIf=\\\"isLoading$ | async\\\">\\n  </mat-progress-bar>\\n  <div style=\\\"height: 4px;\\\" *ngIf=\\\"!(isLoading$ | async)\\\"></div>\\n  <div mat-dialog-content>\\n      <div class=\\\"mat-padding\\\" fxLayout=\\\"column\\\">\\n            <mat-form-field class=\\\"mat-block\\\">\\n                <mat-label>Asset name</mat-label>\\n                <input matInput formControlName=\\\"assetName\\\" required>\\n                <mat-error *ngIf=\\\"addAssetFormGroup.get('assetName').hasError('required')\\\">\\n                    Asset name is required.\\n                </mat-error>\\n            </mat-form-field>\\n            <div fxLayout=\\\"row\\\" fxLayoutGap=\\\"8px\\\">\\n                <tb-entity-subtype-autocomplete\\n                    fxFlex=\\\"50\\\"\\n                    formControlName=\\\"assetType\\\"\\n                    [required]=\\\"true\\\"\\n                    [entityType]=\\\"'ASSET'\\\"\\n                ></tb-entity-subtype-autocomplete>\\n                <mat-form-field fxFlex=\\\"50\\\" class=\\\"mat-block\\\">\\n                    <mat-label>Label</mat-label>\\n                    <input matInput formControlName=\\\"assetLabel\\\">\\n                </mat-form-field>\\n            </div>\\n            <div formGroupName=\\\"attributes\\\" fxLayout=\\\"row\\\" fxLayoutGap=\\\"8px\\\">\\n                <mat-form-field fxFlex=\\\"50\\\" class=\\\"mat-block\\\">\\n                    <mat-label>Latitude</mat-label>\\n                    <input type=\\\"number\\\" step=\\\"any\\\" matInput formControlName=\\\"latitude\\\">\\n                </mat-form-field>\\n                <mat-form-field fxFlex=\\\"50\\\" class=\\\"mat-block\\\">\\n                    <mat-label>Longitude</mat-label>\\n                    <input type=\\\"number\\\" step=\\\"any\\\" matInput formControlName=\\\"longitude\\\">\\n                </mat-form-field>\\n            </div>\\n      </div>  \\n  </div>\\n  <div mat-dialog-actions fxLayout=\\\"row\\\">\\n    <span fxFlex></span>\\n    <button mat-button color=\\\"primary\\\"\\n            type=\\\"button\\\"\\n            [disabled]=\\\"(isLoading$ | async)\\\"\\n            (click)=\\\"cancel()\\\" cdkFocusInitial>\\n      Cancel\\n    </button>\\n    <button mat-button mat-raised-button color=\\\"primary\\\"\\n            style=\\\"margin-right: 20px;\\\"\\n            type=\\\"submit\\\"\\n            [disabled]=\\\"(isLoading$ | async) || addAssetForm.invalid || !addAssetForm.dirty\\\">\\n      Create\\n    </button>\\n  </div>\\n</form>\\n\",\"customCss\":\"\",\"customFunction\":\"let $injector = widgetContext.$scope.$injector;\\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\\n\\nopenAddAssetDialog();\\n\\nfunction openAddAssetDialog() {\\n    customDialog.customDialog(htmlTemplate, AddAssetDialogController).subscribe();\\n}\\n\\nfunction AddAssetDialogController(instance) {\\n    let vm = instance;\\n    \\n    vm.addAssetFormGroup = vm.fb.group({\\n      assetName: ['', [vm.validators.required]],\\n      assetType: ['', [vm.validators.required]],\\n      assetLabel: [''],\\n      attributes: vm.fb.group({\\n          latitude: [null],\\n          longitude: [null]\\n      })      \\n    });\\n    \\n    vm.cancel = function() {\\n        vm.dialogRef.close(null);\\n    };\\n    \\n    vm.save = function() {\\n        vm.addAssetFormGroup.markAsPristine();\\n        let asset = {\\n            name: vm.addAssetFormGroup.get('assetName').value,\\n            type: vm.addAssetFormGroup.get('assetType').value,\\n            label: vm.addAssetFormGroup.get('assetLabel').value\\n        };\\n        assetService.saveAsset(asset).subscribe(\\n            function (asset) {\\n                saveAttributes(asset.id).subscribe(\\n                    function () {\\n                        widgetContext.updateAliases();\\n                        vm.dialogRef.close(null);\\n                    }\\n                );\\n            }\\n        );\\n    };\\n    \\n    function saveAttributes(entityId) {\\n        let attributes = vm.addAssetFormGroup.get('attributes').value;\\n        let attributesArray = [];\\n        for (let key in attributes) {\\n            attributesArray.push({key: key, value: attributes[key]});\\n        }\\n        if (attributesArray.length > 0) {\\n            return attributeService.saveEntityAttributes(entityId, \\\"SERVER_SCOPE\\\", attributesArray);\\n        } else {\\n            return widgetContext.rxjs.of([]);\\n        }\\n    }\\n}\",\"customResources\":[],\"id\":\"70837a9d-c3de-a9a7-03c5-dccd14998758\"}],\"actionCellButton\":[{\"name\":\"Edit asset\",\"icon\":\"edit\",\"type\":\"customPretty\",\"customHtml\":\"<form #editAssetForm=\\\"ngForm\\\" [formGroup]=\\\"editAssetFormGroup\\\"\\n      (ngSubmit)=\\\"save()\\\" style=\\\"width: 480px;\\\">\\n  <mat-toolbar fxLayout=\\\"row\\\" color=\\\"primary\\\">\\n    <h2>Edit asset</h2>\\n    <span fxFlex></span>\\n    <button mat-button mat-icon-button\\n            (click)=\\\"cancel()\\\"\\n            type=\\\"button\\\">\\n      <mat-icon class=\\\"material-icons\\\">close</mat-icon>\\n    </button>\\n  </mat-toolbar>\\n  <mat-progress-bar color=\\\"warn\\\" mode=\\\"indeterminate\\\" *ngIf=\\\"isLoading$ | async\\\">\\n  </mat-progress-bar>\\n  <div style=\\\"height: 4px;\\\" *ngIf=\\\"!(isLoading$ | async)\\\"></div>\\n  <div mat-dialog-content>\\n      <div class=\\\"mat-padding\\\" fxLayout=\\\"column\\\">\\n            <mat-form-field class=\\\"mat-block\\\">\\n                <mat-label>Asset name</mat-label>\\n                <input matInput formControlName=\\\"assetName\\\" required>\\n                <mat-error *ngIf=\\\"editAssetFormGroup.get('assetName').hasError('required')\\\">\\n                    Asset name is required.\\n                </mat-error>\\n            </mat-form-field>\\n            <div fxLayout=\\\"row\\\" fxLayoutGap=\\\"8px\\\">\\n                <tb-entity-subtype-autocomplete\\n                    fxFlex=\\\"50\\\"\\n                    formControlName=\\\"assetType\\\"\\n                    [required]=\\\"true\\\"\\n                    [entityType]=\\\"'ASSET'\\\"\\n                ></tb-entity-subtype-autocomplete>\\n                <mat-form-field fxFlex=\\\"50\\\" class=\\\"mat-block\\\">\\n                    <mat-label>Label</mat-label>\\n                    <input matInput formControlName=\\\"assetLabel\\\">\\n                </mat-form-field>\\n            </div>\\n            <div formGroupName=\\\"attributes\\\" fxLayout=\\\"row\\\" fxLayoutGap=\\\"8px\\\">\\n                <mat-form-field fxFlex=\\\"50\\\" class=\\\"mat-block\\\">\\n                    <mat-label>Latitude</mat-label>\\n                    <input type=\\\"number\\\" step=\\\"any\\\" matInput formControlName=\\\"latitude\\\">\\n                </mat-form-field>\\n                <mat-form-field fxFlex=\\\"50\\\" class=\\\"mat-block\\\">\\n                    <mat-label>Longitude</mat-label>\\n                    <input type=\\\"number\\\" step=\\\"any\\\" matInput formControlName=\\\"longitude\\\">\\n                </mat-form-field>\\n            </div>\\n      </div>  \\n  </div>\\n  <div mat-dialog-actions fxLayout=\\\"row\\\">\\n    <span fxFlex></span>\\n    <button mat-button color=\\\"primary\\\"\\n            type=\\\"button\\\"\\n            [disabled]=\\\"(isLoading$ | async)\\\"\\n            (click)=\\\"cancel()\\\" cdkFocusInitial>\\n      Cancel\\n    </button>\\n    <button mat-button mat-raised-button color=\\\"primary\\\"\\n            type=\\\"submit\\\"\\n            style=\\\"margin-right: 20px;\\\"\\n            [disabled]=\\\"(isLoading$ | async) || editAssetForm.invalid || !editAssetForm.dirty\\\">\\n      Update\\n    </button>\\n  </div>\\n</form>\\n\",\"customCss\":\"\",\"customFunction\":\"let $injector = widgetContext.$scope.$injector;\\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\\n\\nopenEditAssetDialog();\\n\\nfunction openEditAssetDialog() {\\n    customDialog.customDialog(htmlTemplate, EditAssetDialogController).subscribe();\\n}\\n\\nfunction EditAssetDialogController(instance) {\\n    let vm = instance;\\n    \\n    vm.asset = null;\\n    vm.attributes = {};\\n    \\n    vm.editAssetFormGroup = vm.fb.group({\\n      assetName: ['', [vm.validators.required]],\\n      assetType: ['', [vm.validators.required]],\\n      assetLabel: [''],\\n      attributes: vm.fb.group({\\n          latitude: [null],\\n          longitude: [null]\\n      })      \\n    });\\n    \\n    vm.cancel = function() {\\n        vm.dialogRef.close(null);\\n    };\\n    \\n    vm.save = function() {\\n        vm.editAssetFormGroup.markAsPristine();\\n        vm.asset.name = vm.editAssetFormGroup.get('assetName').value,\\n        vm.asset.type = vm.editAssetFormGroup.get('assetType').value,\\n        vm.asset.label = vm.editAssetFormGroup.get('assetLabel').value\\n        assetService.saveAsset(vm.asset).subscribe(\\n            function () {\\n                saveAttributes().subscribe(\\n                    function () {\\n                        widgetContext.updateAliases();\\n                        vm.dialogRef.close(null);\\n                    }\\n                );\\n            }\\n        );\\n    };\\n    \\n    getEntityInfo();\\n    \\n    function getEntityInfo() {\\n        assetService.getAsset(entityId.id).subscribe(\\n            function (asset) {\\n                attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE',\\n                                                    ['latitude', 'longitude']).subscribe(\\n                   function (attributes) {\\n                        for (let i = 0; i < attributes.length; i++) {\\n                            vm.attributes[attributes[i].key] = attributes[i].value; \\n                        }\\n                        vm.asset = asset;\\n                        vm.editAssetFormGroup.patchValue(\\n                            {\\n                                assetName: vm.asset.name,\\n                                assetType: vm.asset.type,\\n                                assetLabel: vm.asset.label,\\n                                attributes: {\\n                                    latitude: vm.attributes.latitude,\\n                                    longitude: vm.attributes.longitude\\n                                }\\n                            }, {emitEvent: false}\\n                        );\\n                   } \\n                );\\n            }\\n        );    \\n    }\\n    \\n    function saveAttributes() {\\n        let attributes = vm.editAssetFormGroup.get('attributes').value;\\n        let attributesArray = [];\\n        for (let key in attributes) {\\n            attributesArray.push({key: key, value: attributes[key]});\\n        }\\n        if (attributesArray.length > 0) {\\n            return attributeService.saveEntityAttributes(entityId, 'SERVER_SCOPE', attributesArray);\\n        } else {\\n            return widgetContext.rxjs.of([]);\\n        }\\n    }\\n}\",\"customResources\":[],\"id\":\"93931e52-5d7c-903e-67aa-b9435df44ff4\"},{\"name\":\"Delete asset\",\"icon\":\"delete\",\"type\":\"custom\",\"customFunction\":\"let $injector = widgetContext.$scope.$injector;\\nlet dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\\n\\nopenDeleteAssetDialog();\\n\\nfunction openDeleteAssetDialog() {\\n    let title = \\\"Are you sure you want to delete the asset \\\" + entityName +  \\\"?\\\";\\n    let content = \\\"Be careful, after the confirmation, the asset and all related data will become unrecoverable!\\\";\\n    dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\\n        function (result) {\\n            if (result) {\\n                deleteAsset();\\n            }\\n        }\\n    );\\n}\\n\\nfunction deleteAsset() {\\n    assetService.deleteAsset(entityId.id).subscribe(\\n        function () {\\n            widgetContext.updateAliases();\\n        }\\n    );\\n}\\n\",\"id\":\"ec2708f6-9ff0-186b-e4fc-7635ebfa3074\"}]}}"
      },
      "image": "data:image/png;base64,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",
      "description": "Customized entity table widget with preconfigured actions to create, update and delete assets."
    },
    {
      "alias": "tu_ttt",
      "name": "tu_ttt",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [],
        "templateHtml": "<div id=\"modal_update\" class=\"modal\" tabindex=\"-1\">S\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\">Cập nhật</h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <div class=\"input-modal\">\r\n                    <label class=\"form-label\">Mã</label>\r\n                    <input type=\"\" id=\"input-code-update\" class=\"form-control\" placeholder=\"Mã\">\r\n                </div>\r\n                <div class=\"input-modal\">\r\n                    <label class=\"form-label\">Name</label>\r\n                    <input type=\"\" id=\"input-name-update\" class=\"form-control\" placeholder=\"Code\">\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n                <button type=\"button\" class=\"btn btn-primary\" id=\"submit-update\">Lưu</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id=\"modal_new\" class=\"modal\" tabindex=\"-1\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\">Thêm mới</h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <div class=\"input-modal\">\r\n                    <label class=\"form-label\">Mã</label>\r\n                    <input type=\"\" id=\"input-code\" class=\"form-control\" placeholder=\"Mã\">\r\n                </div>\r\n                <div class=\"input-modal\">\r\n                    <label class=\"form-label\">Name</label>\r\n                    <input type=\"\" id=\"input-name\" class=\"form-control\" placeholder=\"Code\">\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n                <button type=\"button\" class=\"btn btn-primary\" id=\"submit\">Lưu</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"main\">\r\n    <div class=\"search\">\r\n        <h4> Kết quả tìm kiếm</h4>\r\n        <div class=\"search-control\">\r\n            <button type=\"button\" data-bs-toggle=\"modal\" data-bs-target=\"#modal_new\" class=\"btn btn-primary\">Thêm mới\r\n            </button>\r\n            <input type=\"text\" class=\"form-control\" id=\"\" placeholder=\"Search\">\r\n        </div>\r\n    </div>\r\n    <div class=\"result\">\r\n        <table id=\"table\" class=\"table table-striped table-bordered\">\r\n            <thead>\r\n            <tr id=\"header-table\">\r\n            </tr>\r\n            </thead>\r\n            <tbody id=\"result_table\">\r\n\r\n\r\n            </tbody>\r\n        </table>\r\n        <div class=\"pagination-table\">\r\n            <div id=\"pagination-demo1\">\r\n\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}",
        "controllerScript": "let $scope;\nlet settings;\nlet attributeService;\nlet utils;\nlet translate;\nlet $container;\nlet dialog;\nvar list_stage;\nvar _data;\nlet customDialog;\ninit = function(){\n    \n        $scope = self.ctx.$scope;\n    utils = $scope.$injector.get(self.ctx.servicesMap.get(\n        'utils'));\n    settings = utils.deepClone(self.ctx.settings) || {};\n    settings.showLabel = utils.defaultValue(settings\n        .showLabel, true);\n    settings.showResultMessage = utils.defaultValue(settings\n        .showResultMessage, true);\n    $scope.settings = settings;\n    $scope = self.ctx.$scope;\n    customDialog = $scope.$injector.get(self.ctx.servicesMap\n        .get('customDialog'));\n        var pageLink = self.ctx.pageLink();\n    pageLink.pageSize = 1000;\n    pageLink.pageIndex = 0;\n\n    assetService = $scope.$injector.get(self.ctx\n        .servicesMap.get('assetService'));\n\n    var datasource = self.ctx.datasources;\n    console.log(\"$scope.entityId\", self.ctx);\n    var list_error;\n    const partData = self.ctx.data;\n    var index = 1;\n    assetService.getTenantAssetInfos(pageLink, \"stage\").subscribe(d => {\n    list_stage = d.data;\n    var data =[];\nfor (var i = 0; i < list_stage.length; i++) {\n    var element = {\n        id:index+1,\n        code:list_stage[i].name,\n        name:list_stage[i].label,\n        status:true\n    }\n    data[i] = element;\n    }\n    // var data = [\n    //     {\n    //         id: 1,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     },\n    //     {\n    //         id: 2,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: false\n    //     }\n    //     ,\n    //     {\n    //         id: 3,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     },\n    //     {\n    //         id: 4,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: false\n    //     },\n    //     {\n    //         id: 5,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     }\n    //     ,\n    //     {\n    //         id: 6,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     }\n    //     ,\n    //     {\n    //         id: 7,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     },\n    //     {\n    //         id: 8,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     },\n    //     {\n    //         id: 9,\n    //         code: 'Code',\n    //         name: 'Name',\n    //         status: true\n    //     }\n    // ]\n\n    $(function () {\n        (function (name) {\n            var container = $('#pagination-' + name);\n            var options = {\n                dataSource: data,\n                pageSize: 4,\n                callback: function (response, pagination) {\n                    window.console && console.log(response, pagination);\n\n                    var dataHtml = '<ul>';\n\n                    $.each(response, function (index, item) {\n                        dataHtml += '<li>' + item + '</li>';\n                    });\n\n                    dataHtml += '</ul>';\n\n                    container.prev().html(dataHtml);\n                }\n            };\n\n            //$.pagination(container, options);\n\n            container.addHook('beforeInit', function () {\n                window.console && console.log('beforeInit...');\n            });\n            container.pagination(options);\n\n            container.addHook('beforePageOnClick', function () {\n                window.console && console.log('beforePageOnClick...');\n                //return false\n            });\n        })('demo1');\n    });\n    $('#submit').click(function () {\n        $('#modal_new').modal('toggle');\n        let newData = {\n            code: $('#input-code').val(),\n            name: $('#input-name').val(),\n            status: \"true\",\n        }\n        data.push(newData)\n        console.log(data)\n        $('#result_table').empty();\n        $('#input-code').val('');\n        $('#input-code').val('')\n        getData();\n    })\n    $('#submit-update').click(function () {\n        $('#modal_update').modal('toggle');\n        let updateData = {\n            code: $('#input-code-update').val(),\n            name: $('#input-name-update').val(),\n            status: \"true\",\n        }\n    })\n    var listHeaderTable = ['Id', 'Mã', 'Tên', 'Trạng thái']\n\n    getHeaderTable();\n    getData();\n\n    function openModalUpdate(id) {\n        $('#modal_update').modal('show');\n        console.log(id)\n    }\n\n    function del(id) {\n        alert(\"Xóa bản ghi id: \" + id + \" thành công\")\n    }\n\n    function getHeaderTable() {\n        $('#header-table').append(`    <th  width=\"5%\"><input type=\"checkbox\"></th>\n            <th width=\"5%\" scope=\"col\">STT</th>`)\n\n        for (let i = 0; i < listHeaderTable.length; i++) {\n            $('#header-table').append(`<th scope=\"col\">${listHeaderTable[i]}</th>`)\n            console.log(listHeaderTable[i])\n        }\n        $('#header-table').append(`<th  width=\"10%\" scope=\"col\">Thao tác</th>`)\n        console.log(listHeaderTable)\n\n    }\n\n    function getData() {\n        for (let i = 0; i < data.length; i++) {\n            let trElm = `<tr>`\n            let tdElm = ` <td><input type=\"checkbox\"></td>\n                     <td >${i + 1}</td>`\n\n            for (const property in data[i]) {\n                if (typeof data[i][property] == 'boolean') {\n                    tdElm = tdElm + `<td class=\"status\"><input class=\"form-check-input\" type=\"checkbox\" value=\"\" ${data[i][property] ? 'checked' : ''}></td>`\n                } else {\n                    tdElm = tdElm + `<td>${data[i][property]}</td>`\n                }\n            }\n            tdElm = tdElm + `<td>\n                        <div class=\"action\">\n                            <i title=\"Xóa\" onclick=\"del(${data[i].id})\" class=\"bi bi-trash3\"></i>\n                            <i title=\"Cập nhật\" onclick=\"openModalUpdate(${data[i].id})\" class=\"bi bi-pencil-square\"></i>\n                        </div>\n                    </td>`\n            trElm = trElm + tdElm + `</tr>`;\n            $('#result_table').append(trElm)\n\n        }\n    }\n\n    $(document).ready(function () {\n        $(\"#table\").simpleCheckboxTable({\n            onCheckedStateChanged: function ($checkbox) {\n                // Do something\n                console.log($checkbox)\n            }\n        });\n\n    });\n    });\n}\n\nself.onInit = function() {\n    \n    init();\n    \n    //self.onResize();\n}\n\nself.onDataUpdated = function() {\n\n}\n\nself.onResize = function() {\n   \n}\n\nself.onDestroy = function() {\n}\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"tu_ttt\"}"
      },
      "image": null,
      "description": null
    }
  ]
}