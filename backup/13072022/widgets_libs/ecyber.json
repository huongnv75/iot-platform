{
  "widgetsBundle": {
    "alias": "ecyber",
    "title": "ecyber",
    "image": null,
    "description": null
  },
  "widgetTypes": [
    {
      "alias": "multi_series_pie32",
      "name": "huongnv75",
      "descriptor": {
        "type": "timeseries",
        "sizeX": 9,
        "sizeY": 8.5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js",
            "isModule": false
          },
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js"
          }
        ],
        "templateHtml": "<canvas id=\"pieChart\"></canvas>",
        "templateCss": "",
        "controllerScript": "let data;\r\nlet config\r\nvar list_stage;\r\n    $.getScript('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js', function(jd) {\r\n        $.getScript('https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js');\r\n    });\r\nself.onInit = function () {\r\n    // $.getScript('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js', function(jd) {\r\n    //     $.getScript('https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js');\r\n    // });\r\n    \r\n    const partData = self.ctx.data;\r\n    data = {\r\n        labels: [\r\n\r\n        ],\r\n        datasets: [{\r\n            label: 'Dữ liệu đầu vào',\r\n            data: [],\r\n            datalabels: {\r\n                color: '#000000'\r\n            },\r\n            backgroundColor: [\r\n            ],\r\n            hoverOffset: 4\r\n        }]\r\n    };\r\n    if (partData[0].data.length > 0) {\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n        console.log(\"list_stage\",list_stage);\r\n\r\n        if (list_stage != \"\") {\r\n            for (var i = 0; i < list_stage.length; i++) {\r\n                data.labels.push(list_stage[i].stage_name);\r\n                let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n                data.datasets[0].data.push(value);\r\n            }\r\n        }\r\n    }\r\n\r\n    var options = {\r\n        responsive: false,\r\n        maintainAspectRatio: false,\r\n        title: {\r\n            display: true,\r\n            text: 'Test title',\r\n            position: 'top',\r\n            fontSize: 16,\r\n            fontColor: '#111',\r\n            padding: 20\r\n        },\r\n        legend: {\r\n            display: true,\r\n            position: 'bottom',\r\n            labels: {\r\n                boxWidth: 20,\r\n                fontColor: '#000000',\r\n                padding: 15\r\n            }\r\n        },\r\n        tooltips: {\r\n            enabled: true\r\n        },\r\n        plugins: {\r\n            datalabels: {\r\n                color: '#000000',\r\n                display: true, \r\n                formatter: function (value, ctx) {\r\n                  let sum = 0;\r\n                  let dataArr = ctx.chart.data.datasets[0].data;\r\n                  dataArr.map(data => {\r\n                      sum += data;\r\n                  });\r\n                  if(sum > 0) {\r\n                      return (value*100 / sum).toFixed(2)+\"%\";\r\n                  }\r\n                  return '0%';\r\n\r\n                }\r\n            }\r\n        }\r\n    }\r\n    //huong add end\r\n    config = {\r\n        type: 'doughnut',\r\n        data: data,\r\n        plugins: [ChartDataLabels],\r\n        options: options\r\n\r\n    };\r\n    var ctx = $('#pieChart', self.ctx.$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n    data.labels = []; \r\n    data.datasets[0].data = [];\r\n    data.datasets[0].backgroundColor = [\"#f38b4a\",\r\n        \"#56d798\",\r\n        \"#ff8397\",\r\n        \"#6970d5\", \"#FFFF00\", \"#FF00FF\", \"#F0F0F0\"];\r\n    const partData = self.ctx.data\r\n    if (partData[0].data.length > 0) {\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n        if (list_stage != \"\") {\r\n            for (var i = 0; i < list_stage.length; i++) {\r\n                data.labels.push(list_stage[i].stage_name);\r\n                \r\n                let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n                data.datasets[0].data.push(value);\r\n            }\r\n        }\r\n    }\r\n    self.ctx.chart.update();\r\n\r\n}\r\n\r\nself.onResize = function () {\r\n    self.ctx.chart.resize();\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"borderWidth\": {\n                \"title\": \"Border width\",\n                \"type\": \"number\",\n                \"default\": 5\n            },\n            \"borderColor\": {\n                \"title\": \"Border color\",\n                \"type\": \"string\",\n                \"default\": \"#fff\"\n            },\n            \"legend\": {\n                \"title\": \"Legend settings\",\n                \"type\": \"object\",\n                \"properties\": {\n                    \"display\": {\n                        \"title\": \"Display legend\",\n                        \"type\": \"boolean\",\n                        \"default\": true\n                    },\n                    \"labelsFontColor\": {\n                        \"title\": \"Labels font color\",\n                        \"type\": \"string\",\n                        \"default\": \"#666\"\n                    }\n                }\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"borderWidth\", \n        {\n            \"key\": \"borderColor\",\n            \"type\": \"color\"\n        }, \n        {\n            \"key\": \"legend\",\n            \"items\": [\n                \"legend.display\",\n                {\n                    \"key\": \"legend.labelsFontColor\",\n                    \"type\": \"color\"\n                }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#26a69a\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#f57c00\",\"settings\":{},\"_hash\":0.545701115289893,\"funcBody\":\"var value = (prevValue-20) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+20;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Third\",\"color\":\"#afb42b\",\"settings\":{},\"_hash\":0.2592906835158064,\"funcBody\":\"var value = (prevValue-40) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+40;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Fourth\",\"color\":\"#673ab7\",\"settings\":{},\"_hash\":0.12880275585455747,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"borderWidth\":5,\"borderColor\":\"#fff\",\"legend\":{\"display\":true,\"labelsFontColor\":\"#666666\"}},\"title\":\"huongnv75\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400}}"
      },
      "image": "data:image/png;base64,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",
      "description": "Displays latest values of the attributes or timeseries data for multiple entities in a doughnut chart. Supports numeric values only."
    },
    {
      "alias": "update_state",
      "name": "Khai báo lỗi",
      "descriptor": {
        "type": "latest",
        "sizeX": 8.5,
        "sizeY": 7,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          }
        ],
        "templateHtml": "<div class=\"m-2 row\">\n    <div class=\"col-6\">\n        <b>Tên sản phẩm: </b>{{productName}}<br>\n        <b>Mã sản phẩm: </b>{{productCode}}<br>\n        <b>Lưu ý sản xuất:</b>\n    </div>\n    <div class=\"col-6\">\n        <b>Lệnh sản xuất: </b>{{productName}}<br>\n        <b>Số lô: </b>{{productCode}}<br>\n    </div>\n    <h2 class=\"text-center\">Danh sách khai báo lỗi</h2>\n    <!--<div class=\"text-center\">-->\n    <!--    <button class=\"w-25 btn btn-info\">Serial</button>-->\n    <!--</div>-->\n    <form *ngIf=\"claimDeviceFormGroup\" #claimDeviceForm=\"ngForm\" [formGroup]=\"claimDeviceFormGroup\"\n      tb-toast toastTarget=\"{{ toastTargetId }}\"\n      class=\"claim-form mt-2\" (ngSubmit)=\"claim()\">\n        <mat-form-field appearance=\"outline\" class=\"mat-block w-50\">\n                        <mat-label>Serial</mat-label>\n                            <input matInput type=\"text\" formControlName=\"serial\" />\n                        <!--<mat-error *ngIf=\"claimDeviceFormGroup.get('deviceName').hasError('required')\">-->\n                        <!--    {{requiredErrorDevice}}-->\n                        <!--</mat-error>-->\n                    </mat-form-field>\n        <div class=\"row border\">\n            <div class=\"col-6 mt-1\" formArrayName=\"errors\" *ngFor=\"let error of errors().controls; let i=index\">\n                <fieldset class=\"d-flex justify-content-around\" *ngIf=\"i>=pageStart && i<pageEnd\" [disabled]=\"(isLoading$ | async) || loading\">\n                    <button class=\"mt-2\" mat-fab type=\"button\" (click)=\"subtractValue(i)\" color=\"warn\" aria-label=\"Example icon button with a heart icon\">\n                            -\n                        </button>\n                    <mat-form-field appearance=\"outline\" class=\"mat-block w-50\">\n                        <mat-label>{{relation[i].label}}</mat-label>\n                            <input matInput type=\"number\" [formControlName]=\"i\" required />\n                        <!--<mat-error *ngIf=\"claimDeviceFormGroup.get('deviceName').hasError('required')\">-->\n                        <!--    {{requiredErrorDevice}}-->\n                        <!--</mat-error>-->\n                        <mat-error *ngIf=\"claimDeviceFormGroup.get('errors').controls[i].invalid\">Min: 0</mat-error>\n                    </mat-form-field>\n                        <button class=\"mt-2\" mat-fab type=\"button\" (click)=\"addValue(i)\" color=\"warn\" aria-label=\"Example icon button with a heart icon\">\n                            +\n                        </button>\n                        \n    \n                </fieldset>\n            </div>\n        </div>\n        <div class=\"mat-block mt-2\" fxLayout=\"row\" fxLayoutAlign=\"end center\">\n            <button mat-button mat-raised-button color=\"primary\"\n                type=\"submit\" [disabled]=\"(isLoading$ | async)\">\n                Xác nhận\n            </button>\n        </div>\n    </form>\n    <mat-paginator [length]=\"allErrorLength\"\n                  [pageSize]=\"6\"\n                  [pageSizeOptions]=\"[6, 12, 24]\"\n                  aria-label=\"Select page\"\n                  (page)=\"onPageChange($event)\">\n    </mat-paginator>\n</div>",
        "templateCss": ".attribute-update-form {\n    overflow: hidden;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.attribute-update-form__grid {\n    display: flex;\n}\n.grid__element:first-child {\n    flex: 1;\n}\n.grid__element:last-child {\n    margin-top: 19px;\n    margin-left: 7px;\n}\n.grid__element {\n    display: flex;\n}\n\n.attribute-update-form .mat-button.mat-icon-button {\n    width: 32px;\n    min-width: 32px;\n    height: 32px;\n    min-height: 32px;\n    padding: 0 !important;\n    margin: 0 !important;\n    line-height: 20px;\n}\n\n.attribute-update-form .mat-icon-button mat-icon {\n    width: 20px;\n    min-width: 20px;\n    height: 20px;\n    min-height: 20px;\n    font-size: 20px;\n}\n\n.tb-toast {\n    font-size: 14px!important;\n}",
        "controllerScript": "// let $scope;\n// let settings;\n// let attributeService;\n// let utils;\n// let translate;\n// let entityRelationService;\n// let assetService;\n// self.onInit = function() {\n//     self.ctx.ngZone.run(function() {\n//         init();\n//         self.ctx.detectChanges(true);\n//     });\n// };\n\n\n// function init() {\n\n//     $scope = self.ctx.$scope;\n//     attributeService = $scope.$injector.get(self.ctx\n//         .servicesMap.get('attributeService'));\n//     assetService = $scope.$injector.get(self.ctx\n//         .servicesMap.get('assetService'));\n//     entityRelationService = $scope.$injector.get(self.ctx\n//         .servicesMap.get('entityRelationService'));\n//     utils = $scope.$injector.get(self.ctx.servicesMap.get(\n//         'utils'));\n//     translate = $scope.$injector.get(self.ctx.servicesMap\n//         .get('translate'));\n//     $scope.toastTargetId = 'input-widget' + utils.guid();\n//     settings = utils.deepClone(self.ctx.settings) || {};\n//     settings.showLabel = utils.defaultValue(settings\n//         .showLabel, true);\n//     settings.showResultMessage = utils.defaultValue(settings\n//         .showResultMessage, true);\n//     $scope.settings = settings;\n//     $scope.isValidParameter = true;\n//     $scope.dataKeyDetected = false;\n//     $scope.pageStart = 0;\n//     $scope.pageEnd = 6;\n//     $scope.requiredErrorMessage = utils.customTranslation(\n//         settings.requiredErrorMessage, settings\n//         .requiredErrorMessage) || translate.instant(\n//         'widgets.input-widgets.entity-attribute-required'\n//     );\n//     $scope.labelValue = utils.customTranslation(settings\n//             .labelValue, settings.labelValue) || translate\n//         .instant('widgets.input-widgets.value');\n\n//     $scope.attributeUpdateFormGroup = $scope.fb.group({\n//         currentValue: [undefined, [$scope.validators\n//             .required,\n//             $scope.validators.min(settings\n//                 .minValue),\n//             $scope.validators.max(settings\n//                 .maxValue)\n//         ]],\n//     });\n\n//     $scope.claimDeviceFormGroup = $scope.fb.group({\n//         deviceName: [0],\n//         serial: [''],\n//         errors: $scope.fb.array([])\n//     });\n//     if ($scope.secretKeyField) {\n//         $scope.claimDeviceFormGroup.addControl(\n//             'deviceSecret', $scope.fb.control('', [\n//                 $scope.validators.required\n//             ]));\n//     }\n\n//     if (self.ctx.datasources && self.ctx.datasources\n//         .length) {\n//         console.log(\"self.ctx.datasources: \", self.ctx\n//             .datasources);\n//         var datasource = self.ctx.datasources[0];\n//         if (datasource.type === 'entity') {\n//             if (datasource.entityType && datasource\n//                 .entityId) {\n//                 $scope.entityName = datasource.entityName;\n//                 if (settings.widgetTitle && settings\n//                     .widgetTitle.length) {\n//                     $scope.titleTemplate = utils\n//                         .customTranslation(settings\n//                             .widgetTitle, settings\n//                             .widgetTitle);\n//                 } else {\n//                     $scope.titleTemplate = self.ctx\n//                         .widgetConfig.title;\n//                 }\n\n//                 $scope.entityDetected = true;\n//             }\n//         }\n//         if (datasource.dataKeys.length) {\n//             if (datasource.dataKeys[0].type !==\n//                 \"attribute\") {\n//                 $scope.isValidParameter = false;\n//             } else {\n//                 $scope.currentKey = datasource.dataKeys[0]\n//                     .name;\n//                 $scope.dataKeyType = datasource.dataKeys[0]\n//                     .type;\n//                 $scope.dataKeyDetected = true;\n//             }\n//         }\n//     }\n\n//     self.ctx.widgetTitle = utils.createLabelFromDatasource(\n//         self.ctx.datasources[0], $scope.titleTemplate);\n//     console.log(utils.createLabelFromDatasource(self.ctx\n//         .datasources[0], $scope.titleTemplate));\n//     console.log(\"datasources: \", self.ctx.data);\n//     $scope.data = self.ctx.data;\n//     if ($scope.data[0].data.length > 0) {\n//         $scope.productName = $scope.data[0].data[0][1];\n//         $scope.productCode = $scope.data[1].data[0][1];\n//         $scope.entityId = $scope.data[0].datasource.entity\n//             .id;\n//         console.log(\"entityId:\", $scope.entityId);\n//         $scope.relation = [];\n//         $scope.allErrorLength = 0;\n//         // $scope.errorFormArray = $scope.fb.array([]);\n//         entityRelationService.findInfoByFrom($scope\n//             .entityId).subscribe(data => {\n//             console.log(\"data: \", data);\n//             attributeService\n//                 .getEntityTimeseriesLatest($scope\n//                     .entityId, ['errors',\n//                         'total_hmi_error'\n//                     ]).subscribe(error => {\n//                     console.log(\"errors: \", JSON\n//                         .parse(error.errors[\n//                             0].value));\n//                     const oldErrors = error\n//                         .errors[0].value ? JSON\n//                         .parse(error.errors[0]\n//                             .value) : [];\n//                     $scope.total_hmi_error =\n//                         error.total_hmi_error ?\n//                         error.total_hmi_error[0]\n//                         .value : 0;\n//                     var assetIds = []\n//                     data.map(d => {\n//                         if (d.to\n//                             .entityType ==\n//                             \"ASSET\" && d\n//                             .type ==\n//                             \"machine_asset_error\"\n//                         ) {\n//                             console.log(\"d: \", d);\n//                             assetIds.push(d.to.id);\n//                             $scope\n//                                 .relation\n//                                 .push(d\n//                                     .toName\n//                                 );\n//                             let oldValue =\n//                                 0;\n//                             Object.keys(\n//                                     oldErrors\n//                                 )\n//                                 .map(\n//                                     oldErr => {\n//                                         if (d\n//                                             .toName ==\n//                                             oldErr\n//                                         )\n//                                             oldValue =\n//                                             oldErrors[\n//                                                 oldErr\n//                                             ];\n//                                     });\n//                             $scope.allErrorLength++;\n//                             $scope.errors()\n//                                 .push(\n//                                     $scope\n//                                     .fb\n//                                     .control(\n//                                         oldValue,\n//                                         [$scope\n//                                             .validators\n//                                             .required,\n//                                             $scope\n//                                             .validators\n//                                             .min(\n//                                                 0\n//                                             )\n//                                         ]\n//                                     )\n//                                 );\n//                         }\n//                     });\n//                     assetService.getAssets(assetIds).subscribe((data) => $scope.relation = data);\n//                 });\n\n\n//             // $scope.claimDeviceFormGroup.addControl('errors', $scope.errorFormArray);\n\n//             console.log(\n//                 \"$scope.errors().controls: \",\n//                 $scope.errors().controls);\n//         });\n//         console.log(\"$scope.relation: \", $scope.relation);\n\n\n//         // $scope.personMobile = $scope.data.data[0][1];\n//         // $scope.name = self.ctx.data[2].data[0][1];\n//     }\n//     $scope.errors = function() {\n//         return $scope.claimDeviceFormGroup.get(\n//             'errors');\n//     }\n\n//     // $scope.attributeUpdateFormGroup.get('name').patchValue(self.ctx.data[0].data[0]);\n\n//     $scope.claim = function() {\n//         console.log(\"clai: \", $scope\n//             .claimDeviceFormGroup.get('errors')\n//             .value);\n//         let errorNumbers = $scope.claimDeviceFormGroup\n//             .get('errors').value;\n//         let errors = {};\n//         let totalErrors = 0;\n//         errorNumbers.forEach((e, index) => {\n//             // errors.push({\n//             //     \"key\": $scope.relation[index],\n//             //     \"value\": e\n//             // });\n//             errors[$scope.relation[index].name] = e;\n//             totalErrors += e;\n//         });\n//         console.log(\"errors: \", errors);\n//         var totalerrors = parseInt(totalErrors) + (\n//                     $scope.total_hmi_error ?\n//                     parseInt($scope\n//                         .total_hmi_error) : 0);\n//         let attributesArray = [{\n//                 key: \"errors\",\n//                 value: errors\n//             },\n//             {\n//                 key: \"total_common_error\",\n//                 value: totalErrors\n//             },\n//             {\n//                 key: 'totalerrors',\n//                 value: totalerrors\n//             }\n//         ]\n        \n//         entityRelationService.findInfoByTo($scope.entityId).subscribe(data => \n//         {\n//             console.log(\"line: \", data);\n//             entityRelationService.findInfoByTo(data[0].from).subscribe(d => {\n//                 console.log(\"Wo_Line: \", d);\n//                 const saveParts = {\n//                     key: $scope.entityName,\n//                     value: JSON.stringify(attributesArray)\n//                 };\n//                 console.log(JSON.stringify(attributesArray));\n//                 console.log(\"saveParts: \", saveParts);\n//                 var parts = [];\n//                 var totalErrorsWoLine = 0;\n//                     attributeService.getEntityTimeseriesLatest(d[0].from, ['parts']).subscribe(data => {\n//                         console.log(\"parts: \", data);\n//                         parts = data.parts ? JSON.parse(data.parts[0].value): [];\n//                         if(parts.length > 0) {\n//                             let existPart = false;\n//                             parts = parts.map(part => {\n//                                 if(part.key != $scope.entityName) {\n//                                     let valuePart = JSON.parse(part.value);\n//                                     valuePart.map(attr => {\n//                                         if(attr.key == \"totalerrors\")\n//                                             totalErrorsWoLine = totalErrorsWoLine + parseInt(attr.value);\n//                                     });\n//                                     return part;\n//                                 } else {\n//                                     existPart = true;\n//                                     totalErrorsWoLine = totalErrorsWoLine + totalerrors;\n//                                     return saveParts;\n//                                 }\n//                             });\n//                             console.log(\"existPart: \", existPart);\n//                             if(!existPart)\n//                                 parts.push(saveParts);\n//                         } else {\n//                             totalErrorsWoLine = totalErrorsWoLine + totalerrors;\n//                             parts.push(saveParts);\n//                         }\n                        \n//                         attributeService.saveEntityTimeseries(d[0].from, \"SERVER_SCOPE\", [{\n//                             key: 'parts',\n//                             value: JSON.stringify(parts)\n//                         },\n//                         {\n//                             key: \"totalErrorsWoLine\",\n//                             value: totalErrorsWoLine\n//                         }\n//                         ]).subscribe(part => {\n//                             console.log(\"part: \", part);\n//                         })\n//                     })\n//                 });\n                \n//             });\n//         // attributeService.saveEntityAttributes($scope.entityId, \"SERVER_SCOPE\", attributesArray).subscribe((data) => {\n//         //     alert(\"Success\");\n//         // })\n        \n        \n\n//         attributeService.saveEntityTimeseries($scope\n//             .entityId, \"SERVER_SCOPE\",\n//             attributesArray).subscribe(\n//             (data) => {\n//                 $scope.showSuccessToast(\n//                     \"Update Successful\", 2000,\n//                     'bottom', 'left', $scope\n//                     .toastTargetId);\n\n//             },\n//             () => {\n//                 $scope.showErrorToast(\n//                     \"Update Failed\", 'bottom',\n//                     'left', $scope.toastTargetId\n//                 );\n//             }\n//         )\n\n//     }\n//     $scope.onPageChange = function(event) {\n//         console.log(\"Event: \", event);\n//         $scope.pageStart = event.pageIndex * event\n//             .pageSize;\n//         $scope.pageEnd = (event.pageIndex + 1) * event\n//             .pageSize;\n\n//     }\n//     $scope.subtractValue = function(i) {\n//         $scope.claimDeviceFormGroup.get('errors')\n//             .controls[i].patchValue($scope\n//                 .claimDeviceFormGroup.get('errors')\n//                 .controls[i].value - 1);\n\n//     }\n//     $scope.addValue = function(i) {\n//         $scope.claimDeviceFormGroup.get('errors')\n//             .controls[i].patchValue($scope\n//                 .claimDeviceFormGroup.get('errors')\n//                 .controls[i].value + 1);\n//     }\n//     $scope.updateAttribute = function(index, Wo_Id,\n//         Lot_Number, Line_Id, Product_Code) {\n//         var param = {};\n//         param.Cmd = index;\n//         param.Wo_Id = Wo_Id;\n//         param.Lot_Number = Lot_Number;\n//         param.Line_Id = Line_Id;\n//         param.Product_Code = Product_Code;\n//         $scope.isFocused = false;\n//         if ($scope.entityDetected) {\n//             var datasource = self.ctx.datasources[0];\n\n//             attributeService.saveEntityAttributes(\n//                 datasource.entity.id,\n//                 'SERVER_SCOPE',\n//                 [{\n//                     key: $scope.currentKey,\n//                     value: index\n//                 }]\n//             ).subscribe(\n//                 function success() {\n//                     $scope.originalValue = $scope\n//                         .attributeUpdateFormGroup\n//                         .get('currentValue').value;\n//                     if (settings\n//                         .showResultMessage) {\n//                         $scope.showSuccessToast(\n//                             translate.instant(\n//                                 'widgets.input-widgets.update-successful'\n//                             ), 1000,\n//                             'bottom', 'left',\n//                             $scope.toastTargetId\n//                         );\n//                     }\n//                 },\n//                 function fail() {\n//                     if (settings\n//                         .showResultMessage) {\n//                         $scope.showErrorToast(\n//                             translate.instant(\n//                                 'widgets.input-widgets.update-failed'\n//                             ), 'bottom',\n//                             'left', $scope\n//                             .toastTargetId);\n//                     }\n//                 }\n//             );\n//         }\n//     };\n\n// }\n\n// function correctValue(value) {\n//     if (typeof value !== \"number\") {\n//         return 0;\n//     }\n//     return value;\n// }\n\n// self.onResize = function() {\n\n// }\n\n// // self.typeParameters = function() {\n// //     return {\n// //         maxDatasources: ,\n// //         maxDataKeys: 1,\n// //         singleEntity: true\n// //     }\n// // }\n\n// self.onDestroy = function() {\n\n// }",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"EntitiesTableSettings\",\n        \"properties\": {\n            \"widgetTitle\": {\n                \"title\": \"Widget title\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"showLabel\":{\n                \"title\":\"Show label\",\n                \"type\":\"boolean\",\n                \"default\":true\n            },\n            \"name\": {\n              \"title\": \"name\",\n              \"type\": \"string\",\n              \"default\": \"\"\n            },\n            \"labelValue\": {\n                \"title\": \"Label\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"requiredErrorMessage\": {\n                \"title\": \"'Required' error message\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"maxValue\": {\n                \"title\": \"Max value\",\n                \"type\": \"number\",\n                \"default\": \"\"\n            },\n            \"minValue\": {\n                \"title\": \"Min value\",\n                \"type\": \"number\",\n                \"default\": \"\"\n            },\n            \"showResultMessage\":{\n                \"title\":\"Show result message\",\n                \"type\":\"boolean\",\n                \"default\":true\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"widgetTitle\",\n        \"showResultMessage\",\n        \"showLabel\",\n        \"name\",\n        \"labelValue\",\n        \"requiredErrorMessage\",\n        \"maxValue\",\n        \"minValue\"\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"showResultMessage\":true,\"showLabel\":true},\"title\":\"Khai báo lỗi\",\"dropShadow\":true,\"enableFullscreen\":false,\"widgetStyle\":{},\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"useDashboardTimewindow\":true,\"showLegend\":false,\"actions\":{}}"
      },
      "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACgCAAAAABslHx1AAAAAmJLR0QA/4ePzL8AAANMSURBVHja7d3fS5NRGAfw/SsrhSCKKIugburCi6KCLrropi4izME0c1kLUxquHybmKNPAi4qMJkm9hOkswhVkpaLMfhmlbjHYu+3Vaf7a3r3fLjad5nZh6NiZ3+diO+fAe/HhOc85Z+/Fjg4R2T0ieLjlMHQRT0iF4KGGPBGdHEIWREjWudVsgKhu3QiyIkYIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQghZS8jbbwDQOT9slJc/5HGJAOmoAaAUjKWERCO9z7RI5kPGC8cBxy3A5/wUBoyy1qNirg+I9jtlAPBcvGkt7xWgRmyvgKpu9JR3NF4HjHLk9DSCBmi2eqnsFwCEK8vGRSj2j9fgM85h0Ito4VgC0m/R4GwEgHZ72xMRIOHiwIv7wJ/HN6oKfAmIdL62tsoCAMps1CvE8vuwvWIIaHgehTEGmULQgPYGv9+vCLWP/Cg1a4ClG18LvDDKKPmJPgNGzwXgdQkF0S5JAPrPXqgzDcAo402R2WYAukorzUMi7uzR6YWqmY0BJzQeUQghhBBC1h9kZllDDIj2cumBaKZaijWk6hmRIFqLybl0RDJJi75EgWitJse/Y20mKf4hDkRrWe4AJJOUPB8ZC0mWj1hOUjgyDjJ9zw1Ae5rcsUKIbK9rmVzovatv+hJvfh5ec4hirfidYl6teGp1bd1/Km9XfDhasOnksZxGAIGmA/rWtU/J2NXL7tT5WEmxz+0sUqHsNsR69lwXcDc3AC13b0U6IFCsZanzsZLld1D/AYApP/5wDYBBfTfwPupPCwSKNbnj/zbE44WLOvYcLwCkCYLpVTyiODb2zDe/P7qypQnphKzioXF0myUxMw9t3+MUFBLcd2LxP1qo1bnDQkKmjhydWjqw4YGIkMiJ/MT5ufggAL9eEhCilWzudLlcLgWvbYBDfyfoPpOnCAiZ1MeiGeYdKtCcp9cfHhB11YoXeewFo2+Cv9kJIYQQQghZf5DbaQ1mhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCEkMyFZc0FwdlzZPC7rwtlxibaqy45rzVX8BUWnY6Q1/jMIAAAAAElFTkSuQmCC",
      "description": "Simple form to input new double value for pre-defined server-side attribute key."
    },
    {
      "alias": "tutt20",
      "name": "ecyberlinh-errFrom",
      "descriptor": {
        "type": "timeseries",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://pro.fontawesome.com/releases/v5.10.0/css/all.css",
            "isModule": false
          },
          {
            "url": "https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
          },
          {
            "url": "https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"
          },
          {
            "url": "https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
          }
        ],
        "templateHtml": "<div class=\"row\" style=\"margin-left:1px;overflow-y: scroll\"  id=\"multibox1\">\r\n</div>\r\n\r\n<div class=\"popup hide\" id=\"popup\">\r\n    \r\n</div>\r\n\r\n",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 1px;\n    padding: 1px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 0px;\n}\n\n.tbDatasource-table {\n    width: 80%;\n    box-shadow: 0 0 1px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 1px;\n    box-sizing: border-box;\n}\n   .box-custom {\n             background-color: lightgray;\n             width: 10%;\n             border: 1px solid black;\n             padding: 1px;\n             margin: 1px;\n             text-align: center;\n             display: inline-block;\n         }\n         .box-custom p {\n             font-size: 12px;\n             font-weight: bold;\n             text-align: left;\n         }\n         @media (max-width: 768px) {\n             .box-custom {\n                 background-color: lightgray;\n                 width: 85%;\n                 border: 1px solid black;\n                 padding: 10px;\n                 margin: 20px;\n                 text-align: center;\n             }\n         }\n \n         /* Extra small devices (phones, 600px and down) */\n         @media only screen and (max-width: 300px) {\n             .box-custom {\n                 background-color: lightgray;\n                 width: 85%;\n                 border: 1px solid black;\n                 padding: 1px;\n                 margin: 2px;\n                 text-align: center;\n             }\n \n         }\n \n         /* Small devices (portrait tablets and large phones, 600px and up) */\n         @media only screen and (min-width: 600px) {\n             .box-custom {\n                 background-color: lightgray;\n                 width: 80%;\n                 border: 1px solid black;\n                 padding: 1px;\n                 margin: 2px;\n                 text-align: center;\n             }\n         }\n \n         /* Medium devices (landscape tablets, 768px and up) */\n         @media only screen and (min-width: 768px) {\n             .box-custom {\n                 background-color: lightgray;\n                 width: 80%;\n                 border: 1px solid black;\n                 padding: 1px;\n                 margin: 2px;\n                 text-align: center;\n                 /*display: inline-block;*/\n             }\n         }\n \n         /* Large devices (laptops/desktops, 992px and up) */\n         @media only screen and (min-width: 992px) {\n             .box-custom {\n                 background-color: lightgray;\n                 width: 30%;\n                 border: 1px solid black;\n                 padding: 1px;\n                 margin: 2px;\n                 text-align: center;\n                 display: inline-block;\n \n             }\n         }\n \n         /* Extra large devices (large laptops and desktops, 1200px and up) */\n         @media only screen and (min-width: 1200px) {\n             .box-custom {\n                 background-color: lightgray;\n                 width: 19%;\n                 border: 1px solid black;\n                 padding: 1px;\n                 margin: 2px;\n                 text-align: center;\n                 display: inline-block;\n \n             }\n         }\n         .bottom-buffer { margin-bottom:20px !important; }\n         .row{\n             margin-bottom: 5px;\n         }\n         .main-content{\n             padding: 20px;\n         }\n         \n           .box-custom {\n            background-color: lightblue;\n            width: 19%;\n            border: 3px solid black;\n            padding: 2px;\n            text-align: center;\n            display: inline-block;\n        }\n        .box-custom p {\n            font-size: 10px;\n            font-weight: bold;\n            padding: 1px;\n            margin: 1px;\n        }\n        @media (max-width: 768px) {\n            .box-custom {\n                background-color: lightgray;\n                width: 85%;\n                border: 1px solid black;\n                padding: 10px;\n                margin: 20px;\n                text-align: center;\n            }\n        }\n\n        /* Extra small devices (phones, 600px and down) */\n        @media only screen and (max-width: 600px) {\n            .box-custom {\n                background-color: lightgray;\n                width: 85%;\n                border: 1px solid black;\n                padding: 10px;\n                margin: 20px;\n                text-align: center;\n            }\n\n        }\n\n        /* Small devices (portrait tablets and large phones, 600px and up) */\n        @media only screen and (min-width: 600px) {\n            .box-custom {\n                background-color: lightgray;\n                width: 80%;\n                border: 1px solid black;\n                padding: 10px;\n                margin: 20px;\n                text-align: center;\n            }\n        }\n\n        /* Medium devices (landscape tablets, 768px and up) */\n        @media only screen and (min-width: 768px) {\n            .box-custom {\n                background-color: lightgray;\n                width: 80%;\n                border: 1px solid black;\n                padding: 10px;\n                margin: 20px;\n                text-align: center;\n                /*display: inline-block;*/\n            }\n        }\n\n        /* Large devices (laptops/desktops, 992px and up) */\n        @media only screen and (min-width: 992px) {\n            .box-custom {\n                background-color: lightgray;\n                width: 30%;\n                border: 1px solid black;\n                padding: 10px;\n                margin: 20px;\n                text-align: center;\n                display: inline-block;\n\n            }\n        }\n\n        /* Extra large devices (large laptops and desktops, 1200px and up) */\n        @media only screen and (min-width: 1200px) {\n            .box-custom {\n                background-color: lightgray;\n                width: 19%;\n                border: 1px solid black;\n                padding: 10px;\n                margin: 20px;\n                text-align: center;\n                display: inline-block;\n\n            }\n        }\n\n.hide {\n    display: none;\n}\n\n.show {\n    display: flex;\n}\n\n.popup {\n    width: 350px;\n    height: 350px;\n    background-color: #dedede;\n    position: fixed;\n    top: 20px;\n    left: calc(50% - 175px);\n    align-items: center;\n    \n    flex-direction: column;\n}\n",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\nvar list_stage;\r\nvar err_hmi;\r\nvar _data;\r\nvar product_code;\r\nvar Group_Product;\r\nvar list_vattu = [\r\n    \"ERROR14\",\r\n    \"ERROR02\",\r\n    \"ERROR03\",\r\n    \"ERROR26\",\r\n    \"ERROR39\",\r\n    \"ERROR38\",\r\n    \"ERROR35\",\r\n    \"ERROR23\",\r\n    \"ERROR21\",\r\n    \"ERROR20\",\r\n    \"ERROR19\",\r\n    \"ERROR18\",\r\n    \"ERROR32\",\r\n    \"ERROR30\",\r\n    \"ERROR27\",\r\n    \"ERROR01\"]\r\n\r\n\r\nself.onInit = function () {\r\n    self.ctx.ngZone.run(function () {\r\n        var info = '';\r\n        init();\r\n        self.ctx.detectChanges(true);\r\n        //Khoi tao\r\n        const partData = self.ctx.data;\r\n        if (partData[0].data.length > 0) {\r\n            list_stage = JSON.parse(partData[0].data[0][1]);\r\n            //err_hmi = JSON.parse(partData[6].data[0][1])\r\n            //console.log(\"err_hmi\",(err_hmi))\r\n            //product_code = partData[6].data[0][1]\r\n            Group_Product = JSON.parse(partData[7].data[0][1]);\r\n            console.log(\"Group_Product\",Group_Product);\r\n            console.log(\"check2 list_stage onInit----->\", list_stage);\r\n            console.log(list_stage[0]);\r\n            console.log(list_stage[1]);\r\n            console.log(list_stage[2]);\r\n            console.log(list_stage[3]);\r\n        }\r\n        console.log(\"aaaaa\");\r\n        console.log(_data);\r\n        if (partData[0].data.length > 0) {\r\n            _data = list_stage;\r\n            // _data = json1;\r\n            _data.forEach((d, i) => {\r\n                var html = `\r\n            <div class=\"box-custom\">\r\n                <div class=\"col-md-12\">\r\n                  <p style=\"text-align: center;\"><strong>` + _data[i].stage_name + `</strong></p>\r\n                </div>\r\n                <div class=\"col-md-12\">\r\n                    <div class=\"col-md-6\">\r\n                        <p>IN: ` + _data[i].Number_Of_Input + `</p>\r\n                    </div>\r\n                    <div class=\"col-md-6\">\r\n                        <p>OUT: ` + _data[i].Number_Of_Output + `</p>\r\n                    </div>\r\n                </div>\r\n                <button type=\"button\" class=\"btn btn-danger btn-sm\"  style=\"margin-right:5px\" onClick=\"errForm(${i})\">Khai bao loi</button>\r\n                <button type=\"button\" class=\"btn btn-danger btn-sm\"  style=\"margin-right:5px\" onClick=\"detailErrForm(${i})\">Button moi</button>\r\n            </div>`;\r\n                info = info + html\r\n\r\n            });\r\n        }\r\n        console.log(\"info: \", info);\r\n        document.getElementById(\"multibox1\").innerHTML = info;\r\n\r\n    });\r\n};\r\n//var errList = [\"\"]\r\ndetailErrForm = function (index) {\r\n    var uuid = new Date().getTime();\r\n    alert('index: ' + index + '----- uuid: ' + uuid);\r\n    if (self.ctx.datasources && self.ctx.datasources.length) {\r\n        var stage_id = {\r\n            \"entityType\": \"ASSET\",\r\n            \"id\": \"db959720-78cf-11ec-82d9-63ea7cec5f19\"\r\n        };\r\n        stage_id.id = list_stage[index].asset_Id.id;\r\n\r\n        //lay danh sach label hien thi loi\r\n        if (product_code == \"\") {\r\n            alert(\"San pham khong ton tai\");\r\n            return;\r\n        }\r\n        const myPromise = new Promise((resolve, reject) => {\r\n            //Tim kiem danh sach loi dua vao productCode\r\n            // assetService.findByName(\"SP0100000\").subscribe(product => {\r\n            //     console.log(\"productInfo\", product);\r\n            // });\r\n            stage_id = Group_Product[0].entityId;\r\n            console.log(\"entityId: buildDetailErrForm\", self.ctx.datasources[0].entity.id);\r\n            console.log(\"stage_id buildDetailErrForm\", stage_id);\r\n            attributeService.getEntityAttributes(stage_id, 'SERVER_SCOPE', ['DAQ01']).subscribe(data => {\r\n                buildDetailErrForm(data, index, uuid);\r\n            });\r\n        });\r\n        //await myPromise;\r\n        myPromise.then(data => {\r\n            console.log(\"chem gio ti xem sao\");\r\n            data.map(d => {\r\n                if (d.to.entityType == \"ASSET\" && d.type == \"machine_asset_error\") {\r\n                    console.log(\"d: \", d);\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\nbuildDetailErrForm = function (data, index, uuid) {\r\n\r\n    console.log(\"danh sach loi: \", data);\r\n    var errorList = [];\r\n    errorList = data[0].value\r\n\r\n\r\n    console.log(\"errorList: \", errorList);\r\n    var fillData = list_stage[index].Error_Detail; //huong add to get data all errors.\r\n    var default_arr = [];\r\n    var fillData_HMI = list_stage[index] ? list_stage[index].Error_Detail_HMI : default_arr;\r\n    //alert(\"xxxxx\");\r\n    console.log(\"fillData_HMI: \", fillData_HMI);\r\n    console.log(\"fillData\",fillData);\r\n    var htmlForm = ''\r\n    if (errorList.length > 0) {\r\n        errorList.forEach((d, i) => {\r\n            var name_display = \"1111\";\r\n            if (d) {\r\n                //huong add to find fill value to form.\r\n                var error_code = d.name ? d.name : \"\";\r\n                var error_name = d.label ? d.label : \"\";\r\n                var v = getByErrorKey(fillData, error_code);\r\n                var v_hmi = 5;\r\n                var v_hmi = getByErrorKey_hmi(fillData_HMI, error_code);\r\n                console.log(\"linh_test_error_code\", fillData_HMI);\r\n                //var v_hmi = 0;\r\n                var html = `\r\n                    <div class=\"col-md-4\" style=\"padding-top: 10px;padding-bottom:20px; border: 1px solid black; background: antiquewhite;\">\r\n                        <div class=\"col-md-12 row\">\r\n                            <div id=\"inputLabel\" class=\"offset-md-1 col-md-5 text-left\"><strong>${error_code}</strong></div>\r\n                            <div id=\"nameErr\" class=\"col-md-5 text-right\"><strong>${error_name}</strong></div>\r\n                        </div>\r\n                        <div class=\"col-md-12 row\">\r\n                            <div class=\"offset-md-1 col-md-1\">\r\n                                <button class=\"btn btn-danger\" id=\"bt_dwn_${uuid}_${i}\">\r\n                                    <span class=\"glyphicon glyphicon-minus\"></span>\r\n                                </button>\r\n                            </div>\r\n                            <div class=\"col-md-4\">\r\n                                <input id=\"valueInput\" type=\"text\" value=\"${v}\" style=\"max-width: 100%;\">\r\n                            </div>\r\n                            <div class=\"col-md-4\">\r\n                                <input id=\"valueInput_hmi\" type=\"text\" disabled value=\"${v_hmi}\" style=\"max-width: 100%;\">\r\n                            </div>\r\n                            <div class=\"col-md-2\">\r\n                                <button class=\"btn btn-success\" id=\"bt_up_${uuid}_${i}\">\r\n                                    <span class=\"glyphicon glyphicon-plus\"></span>\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-12 row\">\r\n                            <div class=\"offset-md-2 col-md-4 text-left\">Số lỗi SCADA</div>\r\n                            <div class=\"col-md-4 text-right\">Số lượng HMI</div>\r\n                        </div>\r\n                        <div class=\"col-md-12 row\">\r\n                        <div class=\"offset-md-2 col-md-4 text-left\">Tổng Số lỗi SCADA</div>\r\n                    </div>\r\n                    </div>\r\n                    `;\r\n                htmlForm = htmlForm + html;\r\n                $(document).ready(function () {\r\n                    $(`#bt_dwn_${uuid}_${i}`).on('click', function () {\r\n                        var inputElement = $(this).parent().parent().find('#valueInput');\r\n                        var oldValue = inputElement.val().trim();\r\n                        if (oldValue > 0) {\r\n                            inputElement.val(parseInt(oldValue) - 1);\r\n                        } else {\r\n                            inputElement.val(0);\r\n                        }\r\n                    });\r\n\r\n                    $(`#bt_up_${uuid}_${i}`).on('click', function () {\r\n                        var inputElement = $(this).parent().parent().find('#valueInput');\r\n                        var oldValue = inputElement.val().trim();\r\n                        inputElement.val(parseInt(oldValue) + 1);\r\n                    });\r\n                })\r\n            }\r\n        });\r\n    } else {\r\n        htmlForm = \"Công đoạn chưa được gán lỗi nào!\"\r\n    }\r\n    const partData = self.ctx.data;\r\n    var productCode = partData[1].data[0][1];\r\n    var productName = partData[2].data[0][1];\r\n    var woId = partData[3].data[0][1];\r\n    var lotNumber = partData[4].data[0][1];\r\n    //var note = partData[5].data[0][1];\r\n    var infoDialogTemplate =\r\n        `\r\n        <div id=\"exampleModal\">\r\n            <mat-toolbar fxLayout=\"row\" color=\"accent\" >\r\n                <h2>${_data[index].stage_name}</h2>\r\n                <span fxFlex></span>\r\n                <button mat-button mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n                    <mat-icon class=\"material-icons\">close</mat-icon>\r\n                </button>\r\n            </mat-toolbar>\r\n            \r\n            <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\r\n            \r\n            <div mat-dialog-content>\r\n                <h2>Công đoạn: ${_data[index].stage_name}</h2>\r\n                <div class=\"col-md-12\">\r\n                    <div class=\"col-md-6\">\r\n                        <div style=\"display: flex; flex-direction: column;\">\r\n                            <div>Tên sản phẩm: ${productName}</div>\r\n                            <div>Mã sản phẩm: ${productCode}</div>\r\n                            <div>Lệnh sản xuất: ${woId}</div>\r\n                            <div>Số lô: ${lotNumber}</div>\r\n                            <div>Lưu ý sản xuất: ${note}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-md-6\">\r\n                        <div class=\"col-md-12\">Mã serial\r\n                        </div>\r\n                        <div class=\"col-md-12\">\r\n                            <input type=\"text\" id=\"scanSerial\" style=\"width:70%\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"main-content\">\r\n                    <div class=\"row bottom-buffer\">\r\n                      ${htmlForm}\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\"><i class=\"fa fa-check\"\r\n                                aria-hidden=\"true\"></i> Hoàn thành</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>`\r\n\r\n    console.log(\"My modal: \", infoDialogTemplate);\r\n    dialog = customDialog.customDialog(\r\n        infoDialogTemplate,\r\n        $scope.controlDialog).subscribe();\r\n    console.log(\"open dialog end: \", dialog);\r\n\r\n    $(document).ready(function () {\r\n        $(\".cdk-global-overlay-wrapper\").css(\"align-items\", \"unset\").css('max-heigh', '80%');\r\n        $(\".tb-fullscreen-dialog\").css('max-width', '90%');\r\n        $(\"#exampleModal > div.mat-dialog-content > div\").css('font-size', '12px');\r\n    });\r\n\r\n\r\n\r\n\r\n    $(document).on('click', `.number-spinner.item_${uuid} button`, function () {\r\n        //debugger\r\n        var btn = $(this),\r\n            oldValue = btn.closest('.number-spinner').find('input').val().trim(),\r\n            newVal = 0;\r\n\r\n        if (btn.attr('data-dir') == 'up') {\r\n            console.log(\"oldValue\", oldValue);\r\n            newVal = parseInt(oldValue) + 1;\r\n        } else {\r\n            if (oldValue > 0) {\r\n                newVal = parseInt(oldValue) - 1;\r\n            } else {\r\n                newVal = 0;\r\n            }\r\n        }\r\n        btn.closest('.number-spinner').find('input').val(newVal);\r\n    });\r\n    //xư lý lưu lại lỗi\r\n\r\n    $(document).on('click', `.modal-footer button`, async function (event) {\r\n        // console.log(\"TEST\")\r\n\r\n        var listItem = document.querySelectorAll(\"input#valueInput\");\r\n        var listLabel = document.querySelectorAll(\"div#inputLabel\");\r\n        var valueForm = []\r\n        for (i = 0; i < listLabel.length; i++) {\r\n            valueForm.push({\r\n                err_key: listLabel[i].textContent,\r\n                value: listItem[i].value\r\n            });\r\n        }\r\n        console.log(\"valueForm\", valueForm)\r\n        let attributeTimeSeries = [];\r\n        //luu du lieu khai bao loi\r\n        var stage_err;\r\n        const readPormise = new Promise((resolve, reject) => {\r\n            console.log(\"id thang cha\", $scope.entityId);\r\n            attributeService.getEntityTimeseriesLatest($scope.entityId, ['list_stage']).subscribe(data => {\r\n                //if (data.length > 0){\r\n                stage_err = JSON.parse(data.list_stage[0].value);\r\n                console.log(\"doc du lieu list_stage\", data.list_stage[0].value);\r\n\r\n                //}\r\n                resolve();\r\n            });\r\n        });\r\n        await readPormise;\r\n\r\n        var number_of_err = 0;\r\n        //console.log(\"VALUE FORM: \", valueForm)\r\n        var number_vatu_err = 0;\r\n        //tinh toan tong so loi cua valueForm\r\n        for (var j = 0; j < valueForm.length; j++) {\r\n            number_of_err += parseInt(valueForm[j].value);\r\n            console.log(\"valueForm[j]\", valueForm[j])\r\n            if (list_vattu.includes(valueForm[j].err_key)) {\r\n                number_vatu_err += parseInt(valueForm[j].value);\r\n            }\r\n        }\r\n        stage_err[index].Number_Of_Error = number_of_err;\r\n        stage_err[index].Error_Detail = valueForm;\r\n\r\n\r\n        //luu loi vat tu theo cong doan\r\n        stage_err[index].Error_vattu = number_vatu_err;\r\n        console.log(\"tong loi cong doan\", stage_err[index].Number_Of_Error);\r\n        //them danh sach loi chi tiet vao\r\n        //console.log\r\n        //Luu lai stage_err\r\n        attributeTimeSeries.push({\r\n            key: 'list_stage',\r\n            value: stage_err\r\n        });\r\n\r\n\r\n        const updatevalue = attributeService.saveEntityTimeseries($scope.entityId, 'SERVER_SCOPE', attributeTimeSeries).subscribe(function success() {\r\n            console.log(\r\n                \"cap nhat gia tri last\"\r\n            );\r\n            // let vm = instance;\r\n            // vm.dialogRef.close(null);\r\n\r\n        });\r\n\r\n        // event.preventDefault();\r\n        $scope.showSuccessToast(\"Cập nhật trạng thái thành công\");\r\n        $scope.controlDialog = async function (instance) {\r\n            let vm = instance;\r\n            vm.cancel = function () {\r\n                console.log(\"cancel\");\r\n                vm.dialogRef.close(null);\r\n                //location.reload(); //huong add to check\r\n            };\r\n\r\n        }\r\n\r\n    })\r\n\r\n}\r\nerrForm = function (index) {\r\n    var uuid = new Date().getTime(); //gen unique id \r\n\r\n\r\n    if (self.ctx.datasources && self.ctx.datasources.length) {\r\n        var stage_id = {\r\n            \"entityType\": \"ASSET\",\r\n            \"id\": \"db959720-78cf-11ec-82d9-63ea7cec5f19\"\r\n        };\r\n        stage_id.id = list_stage[index].asset_Id.id;\r\n\r\n        // //lay danh sach label hien thi loi\r\n        // if (product_code == \"\") {\r\n        //     alert(\"San pham khong ton tai\");\r\n        //     return;\r\n        // }\r\n        const myPromise = new Promise((resolve, reject) => {\r\n            //Tim kiem danh sach loi dua vao productCode\r\n            // assetService.findByName(\"SP0100000\").subscribe(product => {\r\n            //     //var productInfo = product[0];\r\n            //     console.log(\"productInfo\", product);\r\n            //     //lay nhom san pham\r\n            //     // attributeService.getEntityAttributes(product.id, 'SERVER_SCOPE', ['GroupProducts']).subscribe(groupProduct => {\r\n            //     //     attributeService.getEntityAttributes(stage_id, 'SERVER_SCOPE', list_stage[index].stage_name).subscribe(data => {\r\n\r\n\r\n            //     //     });\r\n\r\n            //     // });\r\n            // });\r\n            stage_id = Group_Product[0].entityId;\r\n            //console.log(\"entityId: \", self.ctx.datasources[0].entity.id);\r\n            console.log(\"stage_id\", stage_id);\r\n            var name  = list_stage[index].stage_name;\r\n            //alert(name);\r\n            attributeService.getEntityAttributes(stage_id, 'SERVER_SCOPE', [name]).subscribe(data => {\r\n                console.log(\"demohomnay\",data);\r\n                if(data.length>0)\r\n                buildDetailErrForm(data, index, uuid);\r\n                else\r\n                alert(\"chua khai bao loi trong nhom san pham\");\r\n            });\r\n\r\n\r\n            /*\r\n                        attributeService.getEntityAttributes(stage_id, 'SERVER_SCOPE', ['list_error']).subscribe(data => {\r\n                            console.log(\"danh sach loi: \", data);\r\n                            var errorList = [];\r\n                            errorList = data[0].value\r\n            \r\n            \r\n                            console.log(\"errorList: \", errorList);\r\n                            var fillData = list_stage[index].Error_Detail; //huong add to get data all errors.\r\n                            var default_arr = [];\r\n                            var fillData_HMI = list_stage[index].Error_HMI_Detail ? list_stage[index].Error_HMI_Detail : default_arr;\r\n                            //console.log('fillData: ', fillData);\r\n                            var htmlForm = ''\r\n                            if (errorList.length > 0) {\r\n                                errorList.forEach((d, i) => {\r\n                                    var name_display = \"1111\";\r\n                                    if (d) {\r\n                                        //huong add to find fill value to form.\r\n                                        var error_code = d.name ? d.name : \"\";\r\n                                        var error_name = d.label ? d.label : \"\";\r\n                                        var v = getByErrorKey(fillData, error_code);\r\n                                        var v_hmi = getByErrorKey(fillData_HMI, error_code);\r\n                                        var html = `\r\n                                        <div class=\"col-md-4\" style=\"padding-top: 10px;padding-bottom:20px; border: 1px solid black; background: antiquewhite;\">\r\n                                            <div class=\"col-md-12 row\">\r\n                                                <div id=\"inputLabel\" class=\"offset-md-1 col-md-5 text-left\"><strong>${error_code}</strong></div>\r\n                                                <div id=\"nameErr\" class=\"col-md-5 text-right\"><strong>${error_name}</strong></div>\r\n                                            </div>\r\n                                            <div class=\"col-md-12 row\">\r\n                                                <div class=\"offset-md-1 col-md-1\">\r\n                                                    <button class=\"btn btn-danger\" id=\"bt_dwn_${uuid}_${i}\">\r\n                                                        <span class=\"glyphicon glyphicon-minus\"></span>\r\n                                                    </button>\r\n                                                </div>\r\n                                                <div class=\"col-md-4\">\r\n                                                    <input id=\"valueInput\" type=\"text\" value=\"${v}\" style=\"max-width: 100%;\">\r\n                                                </div>\r\n                                                <div class=\"col-md-4\">\r\n                                                    <input id=\"valueInput_hmi\" type=\"text\" disabled value=\"${v_hmi}\" style=\"max-width: 100%;\">\r\n                                                </div>\r\n                                                <div class=\"col-md-2\">\r\n                                                    <button class=\"btn btn-success\" id=\"bt_up_${uuid}_${i}\">\r\n                                                        <span class=\"glyphicon glyphicon-plus\"></span>\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"col-md-12 row\">\r\n                                                <div class=\"offset-md-2 col-md-4 text-left\">Số lỗi SCADA</div>\r\n                                                <div class=\"col-md-4 text-right\">Số lượng HMI</div>\r\n                                            </div>\r\n                                            <div class=\"col-md-12 row\">\r\n                                            <div class=\"offset-md-2 col-md-4 text-left\">Tổng Số lỗi SCADA</div>\r\n                                        </div>\r\n                                        </div>\r\n                                        `;\r\n                                        htmlForm = htmlForm + html;\r\n                                        $(document).ready(function () {\r\n                                            $(`#bt_dwn_${uuid}_${i}`).on('click', function () {\r\n                                                var inputElement = $(this).parent().parent().find('#valueInput');\r\n                                                var oldValue = inputElement.val().trim();\r\n                                                if (oldValue > 0) {\r\n                                                    inputElement.val(parseInt(oldValue) - 1);\r\n                                                } else {\r\n                                                    inputElement.val(0);\r\n                                                }\r\n                                            });\r\n            \r\n                                            $(`#bt_up_${uuid}_${i}`).on('click', function () {\r\n                                                var inputElement = $(this).parent().parent().find('#valueInput');\r\n                                                var oldValue = inputElement.val().trim();\r\n                                                inputElement.val(parseInt(oldValue) + 1);\r\n                                            });\r\n                                        })\r\n                                    }\r\n            \r\n            \r\n                                    //});\r\n                                });\r\n                            } else {\r\n                                htmlForm = \"Công đoạn chưa được gán lỗi nào!\"\r\n                            }\r\n                            const partData = self.ctx.data;\r\n                            var productCode = partData[1].data[0][1];\r\n                            var productName = partData[2].data[0][1];\r\n                            var woId = partData[3].data[0][1];\r\n                            var lotNumber = partData[4].data[0][1];\r\n                            var note = partData[5].data[0][1];\r\n                            var infoDialogTemplate =\r\n                                `\r\n                <div id=\"exampleModal\">\r\n                    <mat-toolbar fxLayout=\"row\" color=\"accent\" >\r\n                        <h2>${_data[index].stage_name}</h2>\r\n                        <span fxFlex></span>\r\n                        <button mat-button mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n                            <mat-icon class=\"material-icons\">close</mat-icon>\r\n                        </button>\r\n                    </mat-toolbar>\r\n            \r\n                    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\r\n            \r\n                    <div mat-dialog-content>\r\n                        <h2>Công đoạn: ${_data[index].stage_name}</h2>\r\n                        <div style=\"display: flex; flex-direction: column;\">\r\n                                <div>Tên sản phẩm: ${productName}</div>\r\n                                <div>Mã sản phẩm: ${productCode}</div>\r\n                                <div>Lệnh sản xuất: ${woId}</div>\r\n                                <div>Số lô: ${lotNumber}</div>\r\n                                <div>Lưu ý sản xuất: ${note}</div>\r\n                            </div>\r\n                        <div class=\"main-content\">\r\n                    <div class=\"row bottom-buffer\">\r\n                      ${htmlForm}\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\"><i class=\"fa fa-check\"\r\n                                aria-hidden=\"true\"></i> Hoàn thành</button>\r\n                    </div>\r\n                </div>\r\n                    </div>\r\n                </div>`\r\n            \r\n                            // var myModal = document.getElementById(\r\n                            //     'exampleModal').outerHTML;\r\n            \r\n                            console.log(\"My modal: \", infoDialogTemplate);\r\n                            dialog = customDialog.customDialog(\r\n                                infoDialogTemplate,\r\n                                $scope.controlDialog).subscribe();\r\n                            console.log(\"open dialog end: \", dialog);\r\n            \r\n                            $(document).ready(function () {\r\n                                // code chuan nam o day\r\n                                $(\".cdk-global-overlay-wrapper\").css(\"align-items\", \"unset\").css('max-heigh', '80%');\r\n                                $(\".tb-fullscreen-dialog\").css('max-width', '90%');\r\n                                $(\"#exampleModal > div.mat-dialog-content > div\").css('font-size', '12px');\r\n                            });\r\n            \r\n            \r\n            \r\n            \r\n                            $(document).on('click', `.number-spinner.item_${uuid} button`, function () {\r\n                                //debugger\r\n                                var btn = $(this),\r\n                                    oldValue = btn.closest('.number-spinner').find('input').val().trim(),\r\n                                    newVal = 0;\r\n            \r\n                                if (btn.attr('data-dir') == 'up') {\r\n                                    console.log(\"oldValue\", oldValue);\r\n                                    newVal = parseInt(oldValue) + 1;\r\n                                } else {\r\n                                    if (oldValue > 0) {\r\n                                        newVal = parseInt(oldValue) - 1;\r\n                                    } else {\r\n                                        newVal = 0;\r\n                                    }\r\n                                }\r\n                                btn.closest('.number-spinner').find('input').val(newVal);\r\n                            });\r\n                            //xư lý lưu lại lỗi\r\n            \r\n                            $(document).on('click', `.modal-footer button`, async function (event) {\r\n                                // console.log(\"TEST\")\r\n            \r\n                                var listItem = document.querySelectorAll(\"input#valueInput\");\r\n                                var listLabel = document.querySelectorAll(\"div#inputLabel\");\r\n                                var valueForm = []\r\n                                for (i = 0; i < listLabel.length; i++) {\r\n                                    valueForm.push({\r\n                                        err_key: listLabel[i].textContent,\r\n                                        value: listItem[i].value\r\n                                    });\r\n                                }\r\n                                console.log(\"valueForm\", valueForm)\r\n                                let attributeTimeSeries = [];\r\n                                //luu du lieu khai bao loi\r\n                                var stage_err;\r\n                                const readPormise = new Promise((resolve, reject) => {\r\n                                    console.log(\"id thang cha\", $scope.entityId);\r\n                                    attributeService.getEntityTimeseriesLatest($scope.entityId, ['list_stage']).subscribe(data => {\r\n                                        //if (data.length > 0){\r\n                                        stage_err = JSON.parse(data.list_stage[0].value);\r\n                                        console.log(\"doc du lieu list_stage\", data.list_stage[0].value);\r\n            \r\n                                        //}\r\n                                        resolve();\r\n                                    });\r\n                                });\r\n                                await readPormise;\r\n            \r\n                                var number_of_err = 0;\r\n                                //console.log(\"VALUE FORM: \", valueForm)\r\n                                var number_vatu_err = 0;\r\n                                //tinh toan tong so loi cua valueForm\r\n                                for (var j = 0; j < valueForm.length; j++) {\r\n                                    number_of_err += parseInt(valueForm[j].value);\r\n                                    console.log(\"valueForm[j]\", valueForm[j])\r\n                                    if (list_vattu.includes(valueForm[j].err_key)) {\r\n                                        number_vatu_err += parseInt(valueForm[j].value);\r\n                                    }\r\n                                }\r\n                                stage_err[index].Number_Of_Error = number_of_err;\r\n                                stage_err[index].Error_Detail = valueForm;\r\n            \r\n            \r\n                                //luu loi vat tu theo cong doan\r\n                                stage_err[index].Error_vattu = number_vatu_err;\r\n                                console.log(\"tong loi cong doan\", stage_err[index].Number_Of_Error);\r\n                                //them danh sach loi chi tiet vao\r\n                                //console.log\r\n                                //Luu lai stage_err\r\n                                attributeTimeSeries.push({\r\n                                    key: 'list_stage',\r\n                                    value: stage_err\r\n                                });\r\n            \r\n            \r\n                                const updatevalue = attributeService.saveEntityTimeseries($scope.entityId, 'SERVER_SCOPE', attributeTimeSeries).subscribe(function success() {\r\n                                    console.log(\r\n                                        \"cap nhat gia tri last\"\r\n                                    );\r\n                                    // let vm = instance;\r\n                                    // vm.dialogRef.close(null);\r\n            \r\n                                });\r\n            \r\n                                // event.preventDefault();\r\n                                $scope.showSuccessToast(\"Cập nhật trạng thái thành công\");\r\n                                $scope.controlDialog = async function (instance) {\r\n                                    let vm = instance;\r\n                                    vm.cancel = function () {\r\n                                        console.log(\"cancel\");\r\n                                        vm.dialogRef.close(null);\r\n                                        //location.reload(); //huong add to check\r\n                                    };\r\n            \r\n                                }\r\n            \r\n                            })\r\n                        });\r\n            */\r\n        });\r\n        //await myPromise;\r\n        myPromise.then(data => {\r\n            console.log(\"chem gio ti xem sao\");\r\n            data.map(d => {\r\n                if (d.to.entityType == \"ASSET\" && d.type == \"machine_asset_error\") {\r\n                    console.log(\"d: \", d);\r\n                }\r\n            });\r\n        });\r\n\r\n\r\n\r\n        //lay danh sach luu loi theo tung label\r\n\r\n    }\r\n\r\n\r\n}\r\nbuildDetailErrForm = async function (data, index, uuid) {\r\n\r\n    console.log(\"danh sach loi: \", data);\r\n    var errorList = [];\r\n    errorList = data[0].value\r\n\r\n\r\n    console.log(\"errorList: \", errorList);\r\n    var stage_err =[];\r\n    const readPormise = new Promise((resolve, reject) => {\r\n        console.log(\"id thang cha\", $scope.entityId);\r\n        attributeService.getEntityTimeseriesLatest($scope.entityId, ['list_stage']).subscribe(data => {\r\n            //if (data.length > 0){\r\n            stage_err = JSON.parse(data.list_stage[0].value);\r\n            console.log(\"doc du lieu list_stage\", data.list_stage[0].value);\r\n\r\n            //}\r\n            resolve();\r\n        });\r\n    });\r\n    await readPormise;\r\n\r\n    var fillData = stage_err[index].Error_Detail; //huong add to get data all errors.\r\n    var default_arr = [];\r\n    var fillData_HMI = stage_err[index].Error_Detail_HMI;\r\n    //console.log('fillData: ', fillData);\r\n    var htmlForm = ''\r\n    if (errorList.length > 0) {\r\n        errorList.forEach((d, i) => {\r\n            var name_display = \"1111\";\r\n            if (d) {\r\n                //huong add to find fill value to form.\r\n                var error_code = d.name ? d.name : \"\";\r\n                var error_name = d.label ? d.label : \"\";\r\n                var v = getByErrorKey(fillData, error_code);\r\n                var v_hmi = getByErrorKey_hmi(fillData_HMI, error_code);\r\n                //v_hmi = 100;\r\n                console.log(\"xxxxxxxxx\", fillData_HMI);\r\n                console.log(\"xxxxxxxxxfillData\", list_stage[index]);\r\n                console.log(\"xxxxxxxxxfillDataxxx\", fillData);\r\n                var html = `\r\n                    <div class=\"col-md-4\" style=\"padding-top: 10px;padding-bottom:20px; border: 1px solid black; background: antiquewhite;\">\r\n                        <div class=\"col-md-12 row\">\r\n                            <div id=\"inputLabel\" class=\"offset-md-1 col-md-5 text-left\"><strong>${error_code}</strong></div>\r\n                            <div id=\"nameErr\" class=\"col-md-5 text-right\"><strong>${error_name}</strong></div>\r\n                        </div>\r\n                        <div class=\"col-md-12 row\">\r\n                            <div class=\"offset-md-1 col-md-1\">\r\n                                <button class=\"btn btn-danger\" id=\"bt_dwn_${uuid}_${i}\">\r\n                                    <span class=\"glyphicon glyphicon-minus\"></span>\r\n                                </button>\r\n                            </div>\r\n                            <div class=\"col-md-4\">\r\n                                <input id=\"valueInput\" type=\"text\" value=\"${v}\" style=\"max-width: 100%;\">\r\n                            </div>\r\n                            <div class=\"col-md-4\">\r\n                                <input id=\"valueInput_hmi\" type=\"text\" disabled value=\"${v_hmi}\" style=\"max-width: 100%;\">\r\n                            </div>\r\n                            <div class=\"col-md-2\">\r\n                                <button class=\"btn btn-success\" id=\"bt_up_${uuid}_${i}\">\r\n                                    <span class=\"glyphicon glyphicon-plus\"></span>\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-12 row\">\r\n                            <div class=\"offset-md-2 col-md-4 text-left\">Số lỗi SCADA</div>\r\n                            <div class=\"col-md-4 text-right\">Số lượng HMI</div>\r\n                        </div>\r\n                        <div class=\"col-md-12 row\">\r\n                        <div class=\"offset-md-2 col-md-4 text-left\">Tổng Số lỗi SCADA</div>\r\n                    </div>\r\n                    </div>\r\n                    `;\r\n                htmlForm = htmlForm + html;\r\n                $(document).ready(function () {\r\n                    $(`#bt_dwn_${uuid}_${i}`).on('click', function () {\r\n                        var inputElement = $(this).parent().parent().find('#valueInput');\r\n                        var oldValue = inputElement.val().trim();\r\n                        if (oldValue > 0) {\r\n                            inputElement.val(parseInt(oldValue) - 1);\r\n                        } else {\r\n                            inputElement.val(0);\r\n                        }\r\n                    });\r\n\r\n                    $(`#bt_up_${uuid}_${i}`).on('click', function () {\r\n                        var inputElement = $(this).parent().parent().find('#valueInput');\r\n                        var oldValue = inputElement.val().trim();\r\n                        inputElement.val(parseInt(oldValue) + 1);\r\n                    });\r\n                })\r\n            }\r\n\r\n\r\n            //});\r\n        });\r\n    } else {\r\n        htmlForm = \"Công đoạn chưa được gán lỗi nào!\"\r\n    }\r\n    const partData = self.ctx.data;\r\n    var productCode = partData[1].data[0][1];\r\n    var productName = partData[2].data[0][1];\r\n    var woId = partData[3].data[0][1];\r\n    var lotNumber = partData[4].data[0][1];\r\n    var note = partData[5].data[0][1];\r\n    var infoDialogTemplate =\r\n        `\r\n<div id=\"exampleModal\">\r\n    <mat-toolbar fxLayout=\"row\" color=\"accent\" >\r\n        <h2>${_data[index].stage_name}</h2>\r\n        <span fxFlex></span>\r\n        <button mat-button mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n            <mat-icon class=\"material-icons\">close</mat-icon>\r\n        </button>\r\n    </mat-toolbar>\r\n    \r\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\r\n    \r\n    <div mat-dialog-content>\r\n        <h2>Công đoạn: ${_data[index].stage_name}</h2>\r\n        <div class=\"col-md-12\">\r\n            <div class=\"col-md-6\">\r\n                <div style=\"display: flex; flex-direction: column;\">\r\n                    <div>Tên sản phẩm: ${productName}</div>\r\n                    <div>Mã sản phẩm: ${productCode}</div>\r\n                    <div>Lệnh sản xuất: ${woId}</div>\r\n                    <div>Số lô: ${lotNumber}</div>\r\n                    <div>Lưu ý sản xuất: ${note}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"col-md-6\">\r\n                <div class=\"col-md-12\">Mã serial\r\n                </div>\r\n                <div class=\"col-md-12\">\r\n                    <input type=\"text\" id=\"scanSerial\" style=\"width:70%\">\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"main-content\">\r\n            <div class=\"row bottom-buffer\">\r\n              ${htmlForm}\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\"><i class=\"fa fa-check\"\r\n                        aria-hidden=\"true\"></i> Hoàn thành</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>`\r\n\r\n    // var myModal = document.getElementById(\r\n    //     'exampleModal').outerHTML;\r\n\r\n    //console.log(\"My modal: \", infoDialogTemplate);\r\n    dialog = customDialog.customDialog(\r\n        infoDialogTemplate,\r\n        $scope.controlDialog).subscribe();\r\n    //console.log(\"open dialog end: \", dialog);\r\n\r\n    $(document).ready(function () {\r\n        $(\".cdk-global-overlay-wrapper\").css(\"align-items\", \"unset\").css('max-heigh', '80%');\r\n        $(\".tb-fullscreen-dialog\").css('max-width', '90%');\r\n        $(\"#exampleModal > div.mat-dialog-content > div\").css('font-size', '12px');\r\n    });\r\n\r\n\r\n\r\n\r\n    $(document).on('click', `.number-spinner.item_${uuid} button`, function () {\r\n        //debugger\r\n        var btn = $(this),\r\n            oldValue = btn.closest('.number-spinner').find('input').val().trim(),\r\n            newVal = 0;\r\n\r\n        if (btn.attr('data-dir') == 'up') {\r\n            console.log(\"oldValue\", oldValue);\r\n            newVal = parseInt(oldValue) + 1;\r\n        } else {\r\n            if (oldValue > 0) {\r\n                newVal = parseInt(oldValue) - 1;\r\n            } else {\r\n                newVal = 0;\r\n            }\r\n        }\r\n        btn.closest('.number-spinner').find('input').val(newVal);\r\n    });\r\n    //xư lý lưu lại lỗi\r\n\r\n    $(document).on('click', `.modal-footer button`, async function (event) {\r\n        // console.log(\"TEST\")\r\n\r\n        var listItem = document.querySelectorAll(\"input#valueInput\");\r\n        var listLabel = document.querySelectorAll(\"div#inputLabel\");\r\n        var valueForm = []\r\n        for (i = 0; i < listLabel.length; i++) {\r\n            valueForm.push({\r\n                err_key: listLabel[i].textContent,\r\n                value: listItem[i].value\r\n            });\r\n        }\r\n        console.log(\"valueForm\", valueForm)\r\n        let attributeTimeSeries = [];\r\n        //luu du lieu khai bao loi\r\n        var stage_err;\r\n        const readPormise = new Promise((resolve, reject) => {\r\n            console.log(\"id thang cha\", $scope.entityId);\r\n            attributeService.getEntityTimeseriesLatest($scope.entityId, ['list_stage']).subscribe(data => {\r\n                //if (data.length > 0){\r\n                stage_err = JSON.parse(data.list_stage[0].value);\r\n                console.log(\"doc du lieu list_stage\", data.list_stage[0].value);\r\n\r\n                //}\r\n                resolve();\r\n            });\r\n        });\r\n        await readPormise;\r\n\r\n        var number_of_err = 0;\r\n        //console.log(\"VALUE FORM: \", valueForm)\r\n        var number_vatu_err = 0;\r\n        //tinh toan tong so loi cua valueForm\r\n        for (var j = 0; j < valueForm.length; j++) {\r\n            number_of_err += parseInt(valueForm[j].value);\r\n            console.log(\"valueForm[j]\", valueForm[j])\r\n            if (list_vattu.includes(valueForm[j].err_key)) {\r\n                number_vatu_err += parseInt(valueForm[j].value);\r\n            }\r\n        }\r\n        stage_err[index].Number_Of_Error = number_of_err;\r\n        stage_err[index].Error_Detail = valueForm;\r\n\r\n\r\n        //luu loi vat tu theo cong doan\r\n        stage_err[index].Error_vattu = number_vatu_err;\r\n        console.log(\"tong loi cong doan\", stage_err[index].Number_Of_Error);\r\n        //them danh sach loi chi tiet vao\r\n        //console.log\r\n        //Luu lai stage_err\r\n        attributeTimeSeries.push({\r\n            key: 'list_stage',\r\n            value: stage_err\r\n        });\r\n\r\n\r\n        const updatevalue = attributeService.saveEntityTimeseries($scope.entityId, 'SERVER_SCOPE', attributeTimeSeries).subscribe(function success() {\r\n            console.log(\r\n                \"cap nhat gia tri last\"\r\n            );\r\n            // let vm = instance;\r\n            // vm.dialogRef.close(null);\r\n\r\n        });\r\n\r\n        // event.preventDefault();\r\n        $scope.showSuccessToast(\"Cập nhật trạng thái thành công\");\r\n        $scope.controlDialog = async function (instance) {\r\n            let vm = instance;\r\n            vm.cancel = function () {\r\n                //console.log(\"cancel\");\r\n                vm.dialogRef.close(null);\r\n                //location.reload(); //huong add to check\r\n            };\r\n\r\n        }\r\n\r\n    })\r\n\r\n\r\n\r\n}\r\n\r\n\r\nfunction init() {\r\n    $scope = self.ctx.$scope;\r\n    $container = self.ctx.$container;\r\n    attributeService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('attributeService'));\r\n    entityRelationService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('entityRelationService'));\r\n    assetService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('assetService'));\r\n    utils = $scope.$injector.get(self.ctx.servicesMap.get(\r\n        'utils'));\r\n    translate = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('translate'));\r\n    customDialog = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('customDialog'));\r\n    $scope.toastTargetId = 'input-widget' + utils.guid();\r\n    settings = utils.deepClone(self.ctx.settings) || {};\r\n    settings.showLabel = utils.defaultValue(settings\r\n        .showLabel, true);\r\n    settings.showResultMessage = utils.defaultValue(settings\r\n        .showResultMessage, true);\r\n    $scope.settings = settings;\r\n    $scope.isValidParameter = true;\r\n    $scope.dataKeyDetected = false;\r\n    if (self.ctx.datasources && self.ctx.datasources\r\n        .length) {\r\n        var datasource = self.ctx.datasources[0];\r\n        if (datasource.type === 'entity') {\r\n            if (datasource.entityType && datasource\r\n                .entityId) {\r\n                $scope.entityName = datasource.entityName;\r\n                $scope.entityId = datasource.entity.id;\r\n                if (settings.widgetTitle && settings\r\n                    .widgetTitle.length) {\r\n                    $scope.titleTemplate = utils\r\n                        .customTranslation(settings\r\n                            .widgetTitle, settings\r\n                            .widgetTitle);\r\n                } else {\r\n                    $scope.titleTemplate = self.ctx\r\n                        .widgetConfig.title;\r\n                }\r\n\r\n                $scope.entityDetected = true;\r\n            }\r\n        }\r\n        if (datasource.dataKeys.length) {\r\n            if (datasource.dataKeys[0].type !==\r\n                \"attribute\") {\r\n                $scope.isValidParameter = false;\r\n            } else {\r\n                $scope.currentKey = datasource.dataKeys[0]\r\n                    .name;\r\n                $scope.dataKeyType = datasource.dataKeys[0]\r\n                    .type;\r\n                $scope.dataKeyDetected = true;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    $scope.changeFocus = function () {\r\n        if ($scope.attributeUpdateFormGroup.get(\r\n            'currentValue').value === $scope\r\n                .originalValue) {\r\n            $scope.isFocused = false;\r\n        }\r\n    }\r\n\r\n    $scope.controlDialog = async function (instance) {\r\n        let vm = instance;\r\n        vm.cancel = function () {\r\n            console.log(\"cancel\");\r\n            vm.dialogRef.close(null);\r\n            // location.reload(); //huong add to check\r\n        };\r\n\r\n    }\r\n}\r\n\r\n\r\nfunction getByErrorKey(arr, key) {\r\n    if (arr == null || arr == undefined) {\r\n        return 0;\r\n    }\r\n\r\n    for (var i = 0, iLen = arr.length; i < iLen; i++) {\r\n        if (arr[i].err_key == key) return arr[i].value; // tim thay thi reurn value\r\n    }\r\n\r\n    return 0; // neu k tim thay\r\n}\r\nfunction getByErrorKey_hmi(arr, key) {\r\n    if (arr == null || arr == undefined) {\r\n        return 0;\r\n    }\r\n    if (arr[key] === undefined) {\r\n        return 0;\r\n    }\r\n    return arr[key];\r\n\r\n    //return arr.key; // neu k tim thay\r\n}\r\nself.onDataUpdated = function () {\r\n    //huong add function ngZone.run phai chay lai moi khi update data\r\n    self.ctx.ngZone.run(function () {\r\n        var info = '';\r\n        init();\r\n        self.ctx.detectChanges(true);\r\n        //Khoi tao\r\n\r\n        //var json = ${ list_stage }\r\n        //console.log(\"json\", json);/*{\r\n        const partData = self.ctx.data;\r\n        if (partData[0].data.length > 0) {\r\n            list_stage = JSON.parse(partData[0].data[0][1]);\r\n            console.log(\"check2 list_stage on onDataUpdated----->\", list_stage);\r\n            console.log(list_stage[0]);\r\n            console.log(list_stage[1]);\r\n            console.log(list_stage[2]);\r\n            console.log(list_stage[3]);\r\n        }\r\n        console.log(\"aaaaa\");\r\n        console.log(_data);\r\n        if (partData[0].data.length > 0) {\r\n            _data = list_stage;\r\n            // _data = json1;\r\n            _data.forEach((d, i) => {\r\n                var html = `\r\n            <div class=\"box-custom\">\r\n                <div class=\"col-md-12 row\">\r\n                  <p style=\"text-align: center;\"><strong>` + _data[i].stage_name + `</strong></p>\r\n                </div>\r\n                <div class=\"col-md-12 row\">\r\n                    <div class=\"col-md-6\">\r\n                        <p>IN: ` + _data[i].Number_Of_Input + `</p>\r\n                    </div>\r\n                    <div class=\"col-md-6\">\r\n                        <p>OUT: ` + _data[i].Number_Of_Output + `</p>\r\n                    </div>\r\n                </div>\r\n                <div class=\"col-md-12 row\">\r\n                    <div class=\"col-md-6\">\r\n                        <button type=\"button\" class=\"btn btn-danger btn-sm\" onClick=\"errForm(${i})\">Khai bao loi</button>\r\n                    </div>\r\n                    <div class=\"col-md-6\">\r\n                        <button type=\"button\" class=\"btn btn-success btn-sm\" onClick=\"detailErrForm(${i})\">Chi tiet</button>\r\n                    </div>\r\n                </div>\r\n            </div>`;\r\n                info = info + html\r\n\r\n            });\r\n        }\r\n        console.log(\"info: \", info);\r\n        document.getElementById(\"multibox1\").innerHTML = info;\r\n    });\r\n}\r\n//$scope.showSuccessToast(\"Cập nhật trạng thái thành công\");\r\n\r\nfunction correctValue(value) {\r\n    if (typeof value !== \"number\") {\r\n        return 0;\r\n    }\r\n    return value;\r\n}\r\n\r\nself.onResize = function () {\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n    //alert('on destroy')\r\n    this.ngOnInit(); //huong add to check\r\n}",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"ecyberlinh-errFrom\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "control_device",
      "name": "tutt20_control",
      "descriptor": {
        "type": "latest",
        "sizeX": 11.5,
        "sizeY": 5.5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          }
        ],
        "templateHtml": "<!--<div tb-toast toastTarget=\"{{ toastTargetId }}\"-->\n<!--    style=\"width: 100%; height: 100%;\">-->\n<!--</div>-->\n<!--    <form *ngIf=\"attributeUpdateFormGroup\"-->\n<!--          class=\"attribute-update-form\"-->\n<!--          [formGroup]=\"attributeUpdateFormGroup\"-->\n<!--          (ngSubmit)=\"updateAttribute()\">-->\n<!--        <div style=\"padding: 0 8px; margin: auto 0;\">-->\n<!--            <div class=\"attribute-update-form__grid\" [fxShow]=\"entityDetected && isValidParameter && dataKeyDetected\">-->\n<!--                <div class=\"grid__element\">-->\n<!--                    <mat-form-field class=\"mat-block\" style=\"width: 100%;\"-->\n<!--                                    floatLabel=\"{{settings.showLabel ? 'auto' : 'always'}}\"-->\n<!--                                    [hideRequiredMarker]=\"!settings.showLabel\">-->\n<!--                        <mat-label>{{ settings.showLabel ? labelValue : '' }}</mat-label>-->\n<!--                        <input matInput-->\n<!--                               formControlName=\"currentValue\"-->\n<!--                               required-->\n<!--                               type=\"number\"-->\n<!--                               (focus)=\"isFocused = true\"-->\n<!--                               (blur)=\"changeFocus()\"-->\n<!--                               max=\"{{settings.maxValue}}\"-->\n<!--                               min=\"{{settings.minValue}}\"/>-->\n<!--                        <mat-error *ngIf=\"attributeUpdateFormGroup.get('currentValue').hasError('required')\">-->\n<!--                            {{requiredErrorMessage}}-->\n<!--                        </mat-error>-->\n<!--                    </mat-form-field>    -->\n<!--                </div>-->\n\n<!--                <div class=\"grid__element\">-->\n<!--                    <button mat-button mat-icon-button class=\"applyChanges\"-->\n<!--                               type=\"submit\"-->\n<!--                               [disabled]=\"originalValue === attributeUpdateFormGroup.get('currentValue').value || attributeUpdateFormGroup.invalid || !attributeUpdateFormGroup.dirty\"-->\n<!--                               matTooltip=\"{{ 'widgets.input-widgets.update-attribute' | translate }}\"-->\n<!--                               matTooltipPosition=\"above\">-->\n<!--                        <mat-icon>check</mat-icon>-->\n<!--                    </button>-->\n<!--                    <button mat-button mat-icon-button class=\"discardChanges\"-->\n<!--                               type=\"button\"-->\n<!--                               [disabled]=\"originalValue === attributeUpdateFormGroup.get('currentValue').value\"-->\n<!--                               (click)=\"attributeUpdateFormGroup.get('currentValue').patchValue(originalValue); isFocused = false\"-->\n<!--                               matTooltip=\"{{ 'widgets.input-widgets.discard-changes' | translate }}\"-->\n<!--                               matTooltipPosition=\"above\">-->\n<!--                        <mat-icon>close</mat-icon>-->\n<!--                    </button>-->\n<!--                </div>-->\n<!--            </div>-->\n\n<!--            <div style=\"text-align: center; font-size: 18px; color: #a0a0a0;\" [fxHide]=\"entityDetected\" >-->\n<!--                {{ 'widgets.input-widgets.no-entity-selected' | translate }}-->\n<!--            </div>-->\n<!--            <div style=\"text-align: center; font-size: 18px; color: #a0a0a0;\"-->\n<!--                 [fxShow]=\"entityDetected && !dataKeyDetected\">-->\n<!--                {{ 'widgets.input-widgets.no-attribute-selected' | translate }}-->\n<!--            </div>-->\n<!--            <div style=\"text-align: center; font-size: 18px; color: #a0a0a0;\"-->\n<!--                 [fxShow]=\"entityDetected && !isValidParameter\">-->\n<!--                {{ 'widgets.input-widgets.timeseries-not-allowed' | translate }}-->\n<!--            </div>-->\n<!--        </div>-->\n<!--    </form>-->\n<!--</div>-->\n<!--<div class=\"m-2\">-->\n\n<!--<br>-->\n<!--<button id=\"start\" (click)=\"updateAttribute(1)\"-->\n<!--    type=\"button\"-->\n<!--    class=\"btn btn-primary mt-2 mr-2\">Start</button>-->\n<!--<button type=\"button\" (click)=\"updateAttribute(2)\"-->\n<!--    class=\"btn btn-success mt-2 mr-2\">Restart</button>-->\n<!--<button type=\"button mr-2\" (click)=\"updateAttribute(3)\"-->\n<!--    class=\"btn btn-danger mt-2\">Stop</button>-->\n<!--<button type=\"button\" (click)=\"updateAttribute(4)\"-->\n<!--    class=\"btn btn-secondary mt-2\">Resume</button>-->\n<!--</div>-->\n<!--<button type=\"button\" class=\"btn btn-primary\"-->\n<!--    data-bs-toggle=\"modal\" (click)=\"openDialog()\"-->\n<!--    data-bs-target=\"#exampleModal\">-->\n<!--    Config-->\n<!--</button>-->\n<button class=\"m-2\" mat-raised-button data-bs-toggle=\"modal\" data-bs-target=\"#exampleModal\" (click)=\"openDialog()\" type=\"button\">\n            <mat-icon class=\"material-icons\">settings</mat-icon> Config\n</button>\n<div class=\"m-2\">\n    <b><span class=\"text-primary\">Họ và tên:</span> </b>\n    {{name}}<br>\n    <b><span class=\"text-primary\">Số điện thoai:</span> </b>\n    {{personMobile}}<br>\n    <img height=\"30px\"\n        src=\"data:image/png;base64,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\" />\n    {{staffNumber}}<br>\n\n</div>\n<!--<b><span class=\"text-primary\">Họ và tên:</span> </b>-->\n\n<!--<div id=\"exampleModal\">-->\n<!--    <mat-toolbar fxLayout=\"row\" color=\"accent\">-->\n<!--        <h2>Control Device</h2>-->\n<!--        <span fxFlex></span>-->\n<!--        <button mat-button mat-icon-button-->\n<!--            (click)=\"cancel()\" type=\"button\">-->\n<!--            <mat-icon class=\"material-icons\">close-->\n<!--            </mat-icon>-->\n<!--        </button>-->\n<!--    </mat-toolbar>-->\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\"-->\n<!--        *ngIf=\"isLoading$ | async\">-->\n<!--    </mat-progress-bar>-->\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\">-->\n<!--    </div>-->\n<!--    <div mat-dialog-content>-->\n<!--        <table class=\"table\">-->\n<!--            <thead>-->\n<!--                <tr>-->\n<!--                    <th scope=\"col\">STT</th>-->\n<!--                    <th scope=\"col\">Đối tượng</th>-->\n<!--                    <th scope=\"col\">Thiết bị</th>-->\n<!--                    <th scope=\"col\">Điều Khiển</th>-->\n<!--                </tr>-->\n<!--            </thead>-->\n<!--            <tbody>-->\n<!--                <tr-->\n<!--                    *ngFor=\"let relation of relationData; let i=index\">-->\n<!--                    <th scope=\"row\">{{i+1}}</th>-->\n<!--                    <td>{{relation.toName}}</td>-->\n<!--                    <td>{{relation.device[0].toName}}</td>-->\n<!--                    <td>-->\n<!--                        <button id=\"start\" (click)=\"updateAttribute(relation.device[0].to, 1)\"-->\n<!--                          type=\"button\"-->\n<!--                          class=\"btn btn-primary\">Start</button>-->\n<!--                      <button type=\"button\" (click)=\"updateAttribute(relation.device[0].to, 2)\"-->\n<!--                          class=\"btn btn-success\">Restart</button>-->\n<!--                      <button type=\"button\" (click)=\"updateAttribute(relation.device[0].to, 0)\"-->\n<!--                          class=\"btn btn-danger\">Stop</button>-->\n<!--                      <button type=\"button\" (click)=\"updateAttribute(relation.device[0].to, 3)\"-->\n<!--                          class=\"btn btn-secondary\">Resume</button>-->\n<!--                      </td>-->\n<!--                </tr>-->\n<!--            </tbody>-->\n<!--        </table>-->\n\n<!--    </div>-->\n<!--</div>-->\n<!--<div id=\"exampleModal\"></div>-->",
        "templateCss": ".attribute-update-form {\n    overflow: hidden;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.attribute-update-form__grid {\n    display: flex;\n}\n.grid__element:first-child {\n    flex: 1;\n}\n.grid__element:last-child {\n    margin-top: 19px;\n    margin-left: 7px;\n}\n.grid__element {\n    display: flex;\n}\n\n.attribute-update-form .mat-button.mat-icon-button {\n    width: 32px;\n    min-width: 32px;\n    height: 32px;\n    min-height: 32px;\n    padding: 0 !important;\n    margin: 0 !important;\n    line-height: 20px;\n}\n\n.attribute-update-form .mat-icon-button mat-icon {\n    width: 20px;\n    min-width: 20px;\n    height: 20px;\n    min-height: 20px;\n    font-size: 20px;\n}\n\n.tb-toast {\n    font-size: 14px!important;\n}\n.mr-2 {\n    margin-right: 5px;\n}\nmat-form-field.mat-form-field {\n  color: '#fff';\n}",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\n\r\nself.onInit = function () {\r\n    self.ctx.ngZone.run(function () {\r\n        init();\r\n        self.ctx.detectChanges(true);\r\n    });\r\n};\r\nvar list_stage;\r\n\r\nfunction init() {\r\n\r\n    $scope = self.ctx.$scope;\r\n    $container = self.ctx.$container;\r\n    attributeService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('attributeService'));\r\n    entityRelationService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('entityRelationService'));\r\n    assetService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('assetService'));\r\n    utils = $scope.$injector.get(self.ctx.servicesMap.get(\r\n        'utils'));\r\n    translate = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('translate'));\r\n    customDialog = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('customDialog'));\r\n    $scope.toastTargetId = 'input-widget' + utils.guid();\r\n    settings = utils.deepClone(self.ctx.settings) || {};\r\n    settings.showLabel = utils.defaultValue(settings\r\n        .showLabel, true);\r\n    settings.showResultMessage = utils.defaultValue(settings\r\n        .showResultMessage, true);\r\n    $scope.settings = settings;\r\n    $scope.isValidParameter = true;\r\n    $scope.dataKeyDetected = false;\r\n\r\n    $scope.requiredErrorMessage = utils.customTranslation(\r\n        settings.requiredErrorMessage, settings\r\n        .requiredErrorMessage) || translate.instant(\r\n            'widgets.input-widgets.entity-attribute-required'\r\n        );\r\n    $scope.labelValue = utils.customTranslation(settings\r\n        .labelValue, settings.labelValue) || translate\r\n            .instant('widgets.input-widgets.value');\r\n\r\n    $scope.attributeUpdateFormGroup = $scope.fb.group({\r\n        currentValue: [undefined, [$scope.validators\r\n            .required,\r\n        $scope.validators.min(settings\r\n            .minValue),\r\n        $scope.validators.max(settings\r\n            .maxValue)\r\n        ]],\r\n        name: [self.ctx.data[0].data[0]],\r\n        personMobile: ['']\r\n    });\r\n\r\n\r\n    if (self.ctx.datasources && self.ctx.datasources\r\n        .length) {\r\n        var datasource = self.ctx.datasources[0];\r\n        if (datasource.type === 'entity') {\r\n            if (datasource.entityType && datasource\r\n                .entityId) {\r\n                $scope.entityName = datasource.entityName;\r\n                $scope.entityId = datasource.entity.id;\r\n                if (settings.widgetTitle && settings\r\n                    .widgetTitle.length) {\r\n                    $scope.titleTemplate = utils\r\n                        .customTranslation(settings\r\n                            .widgetTitle, settings\r\n                            .widgetTitle);\r\n                } else {\r\n                    $scope.titleTemplate = self.ctx\r\n                        .widgetConfig.title;\r\n                }\r\n\r\n                $scope.entityDetected = true;\r\n            }\r\n        }\r\n        if (datasource.dataKeys.length) {\r\n            if (datasource.dataKeys[0].type !==\r\n                \"attribute\") {\r\n                $scope.isValidParameter = false;\r\n            } else {\r\n                $scope.currentKey = datasource.dataKeys[0]\r\n                    .name;\r\n                $scope.dataKeyType = datasource.dataKeys[0]\r\n                    .type;\r\n                $scope.dataKeyDetected = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    self.ctx.widgetTitle = utils.createLabelFromDatasource(\r\n        self.ctx.datasources[0], $scope.titleTemplate);\r\n    console.log(utils.createLabelFromDatasource(self.ctx\r\n        .datasources[0], $scope.titleTemplate));\r\n    console.log(\"datasources: \", self.ctx.data[1]);\r\n    $scope.data = self.ctx.data;\r\n    if ($scope.data[1]) {\r\n        console.log(self.ctx.data[3]);\r\n        $scope.personMobile = $scope.data[1].data[0][1];\r\n        $scope.name = $scope.data[0].data[0][1];\r\n        $scope.staffNumber = $scope.data[2].data[0][1];\r\n    }\r\n    console.log(\"currentKey: \", datasource);\r\n    // $scope.attributeUpdateFormGroup.get('name').patchValue(self.ctx.data[0].data[0]);\r\n    // if(datasource.dataKeys.length);\r\n    $scope.relationData = [\r\n        // device: []\r\n    ];\r\n    if (datasource.entity.id) {\r\n        entityRelationService.findInfoByFrom(datasource.entity\r\n            .id)\r\n            .subscribe(data => {\r\n                console.log(\"Day chuyen xxxxx: \", data);\r\n                const readPormise = new Promise((resolve, reject) => {\r\n\r\n                    attributeService.getEntityAttributes(data[0].to, ['list_stage']).subscribe(data001 => {\r\n                        //console.log(\"doc du lieu list_stage\", data001.list_stage[0].value);\r\n                        console.log(\"yyyyyyyyyyyyyy\", data001[0].value);\r\n                        //}\r\n                        resolve();\r\n                    });\r\n                });\r\n                //await readPormise;\r\n\r\n\r\n\r\n                data.forEach((relation) => {\r\n                    entityRelationService.findInfoByFrom(relation.to).subscribe((stages) => {\r\n                        $scope.relationData = stages;\r\n                        console.log(\"Cong doan: \", stages);\r\n                        stages.forEach((stage, index) => {\r\n                            entityRelationService.findInfoByFrom(stage.to).subscribe(device => {\r\n\r\n                                if (device.length > 0) {\r\n                                    device = device.filter(d => d.type == 'Contains');\r\n                                    console.log(\"Device:\", device);\r\n                                    $scope.relationData[index].device = device;\r\n                                }\r\n                            })\r\n                        })\r\n\r\n                    })\r\n                })\r\n                console.log(\"relationData: \", $scope\r\n                    .relationData);\r\n            });\r\n    }\r\n\r\n\r\n\r\n    // $scope.updateAttribute = function(entity, index) {\r\n    //     $scope.isFocused = false;\r\n    //     var state = {\r\n    //         \"Cmd\": index,\r\n    //         \"Alert\": 0,\r\n    //     };\r\n    //     console.log($scope.data);\r\n    //     $scope.data.forEach(d => console.log(\r\n    //         \"attribute state: \", d));\r\n    //     if ($scope.entityDetected) {\r\n    //         var datasource = self.ctx.datasources[0];\r\n\r\n    //         attributeService.saveEntityAttributes(\r\n    //             entity,\r\n    //             'SERVER_SCOPE',\r\n    //             [{\r\n    //                 key: $scope.currentKey,\r\n    //                 value: index\r\n    //             }]\r\n    //         ).subscribe(\r\n    //             function success() {\r\n    //                 console.log(\"Update Success\");\r\n    //                 $scope.originalValue = $scope\r\n    //                     .attributeUpdateFormGroup\r\n    //                     .get('currentValue').value;\r\n    //                 if (settings\r\n    //                     .showResultMessage) {\r\n    //                     $scope.showSuccessToast(\r\n    //                         translate.instant(\r\n    //                             'widgets.input-widgets.update-successful'\r\n    //                         ), 1000,\r\n    //                         'bottom', 'left',\r\n    //                         $scope.toastTargetId\r\n    //                     );\r\n    //                 }\r\n    //             },\r\n    //             function fail() {\r\n    //                 if (settings\r\n    //                     .showResultMessage) {\r\n    //                     $scope.showErrorToast(\r\n    //                         translate.instant(\r\n    //                             'widgets.input-widgets.update-failed'\r\n    //                         ), 'bottom',\r\n    //                         'left', $scope\r\n    //                         .toastTargetId);\r\n    //                 }\r\n    //             }\r\n    //         );\r\n    //     }\r\n    // };\r\n\r\n    $scope.changeFocus = function () {\r\n        if ($scope.attributeUpdateFormGroup.get(\r\n            'currentValue').value === $scope\r\n                .originalValue) {\r\n            $scope.isFocused = false;\r\n        }\r\n    }\r\n    $scope.openDialog = function () {\r\n        console.log(\"Open dialog: \", $container);\r\n        var infoDialogTemplate =\r\n            '<div id=\"exampleModal\">' +\r\n            '<mat-toolbar fxLayout=\"row\" color=\"accent\">' +\r\n            '<h2>Control Device</h2>' +\r\n            '<span fxFlex></span>' +\r\n            '<button mat-button mat-icon-button (click)=\"cancel()\" type=\"button\">' +\r\n            '<mat-icon class=\"material-icons\">close</mat-icon>' +\r\n            '</button>' +\r\n            '</mat-toolbar>' +\r\n            '<mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">' +\r\n            '</mat-progress-bar>' +\r\n            '<div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>' +\r\n            '<div mat-dialog-content>' +\r\n            $scope.actionAll() +\r\n            '<table class=\"table\">' +\r\n            '<thead>' +\r\n            '<tr>' +\r\n            '<th scope=\"col\">STT</th>' +\r\n            '<th scope=\"col\">Công đoạn</th>' +\r\n            '<th scope=\"col\">Thiết bị</th>' +\r\n            '<th scope=\"col\">Điều Khiển</th>' +\r\n            '</tr>' +\r\n            '</thead>' +\r\n            '<tbody>' +\r\n            $scope.infoTable($scope.relationData) +\r\n            '</tbody>' +\r\n            '</table>' +\r\n            `<div tb-toast toastTarget=${$scope.toastTargetId}></div>` +\r\n            '</div>' +\r\n            '</div>';\r\n\r\n        // var myModal = document.getElementById(\r\n        //     'exampleModal').outerHTML;\r\n\r\n        console.log(\"My modal: \", infoDialogTemplate);\r\n        dialog = customDialog.customDialog(\r\n            infoDialogTemplate,\r\n            $scope.controlDialog).subscribe();\r\n        console.log(\"open dialog end: \", dialog);\r\n\r\n    }\r\n    $scope.actionAll = function () {\r\n        var info = `<div class=\"d-flex justify-content-end\">\r\n                        <button id=\"start\" (click)=\"updateAllAttribute(1)\"\r\n                              type=\"button\"\r\n                              class=\"btn btn-primary btn-sm\" style=\"margin-right:5px\">Start All</button>\r\n                        <button id=\"restart\" (click)=\"updateAllAttribute(2)\"\r\n                              type=\"button\"\r\n                              class=\"btn btn-success btn-sm\"  style=\"margin-right:5px\">Restart All</button>\r\n                        <button id=\"stop\" (click)=\"updateAllAttribute(0)\"\r\n                              type=\"button\"\r\n                              class=\"btn btn-danger btn-sm\"  style=\"margin-right:5px\">Stop All</button>\r\n                        <button id=\"resume\" (click)=\"updateAllAttribute(3)\"\r\n                              type=\"button\"\r\n                              class=\"btn btn-secondary btn-sm\"  style=\"margin-right:5px\">Resume All</button>\r\n                        <button id=\"pause\" (click)=\"updateAllAttribute(4)\"\r\n                              type=\"button\"\r\n                              class=\"btn btn-warning btn-sm\"  style=\"margin-right:5px\">Pause All</button>\r\n                   </div>`;\r\n        return info;\r\n    }\r\n    $scope.infoTable = function (data) {\r\n        console.log(\"relationData: \", $scope.relationData);\r\n        var info = '';\r\n        $scope.relationData.forEach((d, index) => {\r\n\r\n            info = info + `<tr>\r\n                <th scope=\"row\">${index + 1}</th>\r\n                <td>${d.toName}</td>`;\r\n            console.log(\"d.device: \", d.device);\r\n            if (d.device && d.device.length > 0) {\r\n                var deviceEntityId = `'${d.device[0].to.id}'`;\r\n                var deviceEntityType = `'${d.device[0].to.entityType}'`;\r\n                var assetId = `'${d.to.id}'`;\r\n\r\n                info = info + `<td>${d.device[0].toName}</td>\r\n                <td>\r\n                    <button id=\"start\" (click)=\"updateAttribute(${assetId}, ${deviceEntityId}, ${deviceEntityType}, 1)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-primary btn-sm\" style=\"margin-right:5px\">Start</button>\r\n                    <button id=\"restart\" (click)=\"updateAttribute(${assetId}, ${deviceEntityId}, ${deviceEntityType}, 2)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-success btn-sm\"  style=\"margin-right:5px\">Restart</button>\r\n                    <button id=\"stop\" (click)=\"updateAttribute(${assetId}, ${deviceEntityId}, ${deviceEntityType}, 0)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-danger btn-sm\"  style=\"margin-right:5px\">Stop</button>\r\n                    <button id=\"resume\" (click)=\"updateAttribute(${assetId}, ${deviceEntityId}, ${deviceEntityType}, 4)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-secondary btn-sm\"  style=\"margin-right:5px\">Resume</button>\r\n                    <button id=\"pause\" (click)=\"updateAttribute(${assetId}, ${deviceEntityId}, ${deviceEntityType}, 3)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-warning btn-sm\"  style=\"margin-right:5px\">Pause</button>\r\n                </td>\r\n            </tr>`;\r\n            } else {\r\n                info = info + `<td></td>\r\n                            <td></td>`\r\n            }\r\n\r\n\r\n        });\r\n        info = info + `<tr>\r\n                <th scope=\"row\">${data.length + 1}</th>\r\n                <td>${$scope.entityName}</td>\r\n                <td></td>\r\n                <td>\r\n                    <button id=\"start\" (click)=\"updateLine(1)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-primary btn-sm\" style=\"margin-right:5px\" >Start_Line</button>\r\n                    <button id=\"restart\" (click)=\"updateLine(2)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-success btn-sm\"  style=\"margin-right:5px\" >Finish_Line</button>\r\n                    <button id=\"stop\" (click)=\"updateLine(3)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-danger btn-sm\"  style=\"margin-right:5px\">Stop_Line</button>\r\n                    <button id=\"resume\" (click)=\"updateLine(4)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-secondary btn-sm\"  style=\"margin-right:5px\">Resume_Line</button>\r\n                    <button id=\"pause\" (click)=\"updateLine(5)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-warning btn-sm\"  style=\"margin-right:5px\">Pause_Line</button>\r\n                          <button id=\"clear\" (click)=\"updateLine(0)\"\r\n                          type=\"button\"\r\n                          class=\"btn btn-warning btn-sm\"  style=\"margin-right:5px\">Clear_Line</button>\r\n                </td>\r\n            </tr>`;\r\n        return info;\r\n    }\r\n    $scope.controlDialog = async function (instance) {\r\n        const RUNNING = 1;//Start\r\n        const FINISH = 2;\r\n        const STOP = 3;\r\n        const RESUME = 4;\r\n        const PAUSE = 5;\r\n        console.log(\"Control Dialog: \", instance);\r\n        let vm = instance;\r\n        const myPromise = new Promise((resolve, reject) => {\r\n            attributeService.getEntityAttributes($scope.entityId, 'SERVER_SCOPE', ['STATUS']).subscribe(data => {\r\n                console.log(\"STATUS data: \", data);\r\n                if (data.length > 0)\r\n                    vm.STATUS = data[0].value;//trang thai cu\r\n                //vm.STORESTATUS = data[1].value;\r\n                resolve();\r\n            });\r\n        });\r\n        await myPromise;\r\n        vm.cancel = function () {\r\n            console.log(\"cancel\");\r\n            vm.dialogRef.close(null);\r\n        };\r\n        vm.updateLine = async function (index) {\r\n            console.log(\"Line update status: \", index);\r\n            let oldData;\r\n            //lấy dữ liệu cũ\r\n            const myPromise = new Promise((resolve, reject) => {\r\n                attributeService.getEntityTimeseriesLatest($scope.entityId, ['Start_Time', 'Stop_Time', 'Running_Time', 'Stopping_Time', 'Resume_Time']).subscribe(data => {\r\n                    oldData = data;\r\n                    resolve();\r\n                });\r\n            });\r\n            //lấy trạng thái cũ\r\n            //var old_status;\r\n            const myPromise2 = new Promise((resolve, reject) => {\r\n                attributeService.getEntityAttributes($scope.entityId, 'SERVER_SCOPE', ['STATUS', 'OLDSTATUS']).subscribe(data => {\r\n                    if (data.length > 0)\r\n                        vm.STATUS = data[0] ? data[0].value : 0;\r\n                    vm.STORESTATUS = data[1] ? data[1].value : 0;\r\n                    //old_status = data;\r\n                    resolve();\r\n                });\r\n            });\r\n            await myPromise;\r\n            await myPromise2;\r\n            // let attributeTimeSeries = [];\r\n            // const startTime = oldData.Start_Time[0].value;\r\n            //const oldRunningTime = oldData.Running_Time[0].value;\r\n            //const oldStoppingTime = oldData.Stopping_Time[0].value;\r\n            //const stopTime = oldData.Stop_Time[0].value;\r\n            const STATUS = vm.STATUS;//trang thai cu\r\n            console.log(\"Trang thai cu\");\r\n            console.log(STATUS);\r\n            var status_update = [];\r\n            //index là trạng thái mới cập nhật\r\n            let attributeTimeSeries = [];\r\n\r\n            console.log(\"lệnh index\" + index);\r\n            //Trang thai cu\r\n            var nowStatus = 0;\r\n            var oldStatus = 0;\r\n            var timenow = Date.now();\r\n            switch (index) {\r\n                case RUNNING:\r\n                    //Restart tất cả lại từ đầu\r\n                    console.log(\"bắt đầu từ con số 0\");\r\n                    attributeTimeSeries.push({\r\n                        key: 'Start_Time',\r\n                        value: timenow\r\n                    });\r\n                    attributeTimeSeries.push({\r\n                        key: 'Running_Time',\r\n                        value: 0\r\n                    });\r\n                    attributeTimeSeries.push({\r\n                        key: 'Stop_Time',\r\n                        value: timenow\r\n                    });\r\n                    attributeTimeSeries.push({\r\n                        key: 'Stopping_Time',\r\n                        value: 0\r\n                    });\r\n                    //luu thời điểm đầu tiên chạy\r\n                    attributeTimeSeries.push({\r\n                        key: 'Resume_Time',\r\n                        value: timenow\r\n                    });\r\n                    attributeTimeSeries.push({\r\n                        key: 'Old_Number_Of_Output',\r\n                        value: 0\r\n                    });\r\n\r\n                    nowStatus = RUNNING;\r\n                    oldStatus = RUNNING;\r\n                    attributeTimeSeries.push({\r\n                        key: 'Avarage_Productivity',\r\n                        value: \"[]\"\r\n                    });\r\n                    console.log(\"hahahahaahaha\");\r\n                    break;\r\n                case STOP:\r\n                    //luu lai thoi gian STOP\r\n                    var Stop_Time = oldData.Stop ? oldData.Stop_Time[0].value : 0;\r\n                    var Stopping_Time = oldData.Stopping_Time ? oldData.Stopping_Time[0].value : 0;\r\n                    //Stopping_Time = parseInt(timenow) + parseInt(Stopping_Time) - parseInt(Stop_Time);\r\n                    Stop_Time = timenow;//thoi diem gan nhat chay\r\n                    attributeTimeSeries.push({\r\n                        key: 'Stop_Time',\r\n                        value: Stop_Time\r\n                    });\r\n                    attributeTimeSeries.push({\r\n                        key: 'Stopping_Time',\r\n                        value: Stopping_Time\r\n                    });\r\n                    if (STATUS == RUNNING) {\r\n                        console.log(\"Neu dang chay thi luu lai du lieu Running chay để sau count tiếp\");\r\n                        var Start_Time = oldData.Start_Time ? oldData.Start_Time[0].value : 0;\r\n                        var Running_Time = oldData.Running_Time ? oldData.Running_Time[0].value : 0;\r\n                        Running_Time = parseInt(timenow) + parseInt(Running_Time) - parseInt(Start_Time);\r\n                        Start_Time = timenow;//thoi diem gan nhat chay\r\n                        attributeTimeSeries.push({\r\n                            key: 'Start_Time',\r\n                            value: Start_Time\r\n                        });\r\n                        attributeTimeSeries.push({\r\n                            key: 'Running_Time',\r\n                            value: Running_Time\r\n                        });\r\n                    }\r\n                    nowStatus = STOP;\r\n                    oldStatus = STATUS;\r\n                    break;\r\n                case PAUSE:\r\n                    nowStatus = PAUSE;\r\n                    alert(\"tam dung \" + nowStatus);\r\n                    switch (STATUS) {\r\n                        case RUNNING:\r\n                            console.log(\"Neu dang chay thi luu lai du lieu Running chay để sau count tiếp\");\r\n                            var Start_Time = oldData.Start_Time ? oldData.Start_Time[0].value : 0;\r\n                            var Running_Time = oldData.Running_Time ? oldData.Running_Time[0].value : 0;\r\n                            Running_Time = parseInt(timenow) + parseInt(Running_Time) - parseInt(Start_Time);\r\n                            Start_Time = timenow;//thoi diem gan nhat chay\r\n                            attributeTimeSeries.push({\r\n                                key: 'Start_Time',\r\n                                value: Start_Time\r\n                            });\r\n                            attributeTimeSeries.push({\r\n                                key: 'Running_Time',\r\n                                value: Running_Time\r\n                            });\r\n                            oldStatus = RUNNING;\r\n                            break;\r\n                        case STOP:\r\n                            console.log(\"Neu dang chay thi luu lai du lieu stop  để sau count tiếp\");\r\n                            var Stop_Time = oldData.Stop_Time ? oldData.Stop_Time[0].value : 0;\r\n                            var Stopping_Time = oldData.Stopping_Time ? oldData.Stopping_Time[0].value : 0;\r\n                            Stopping_Time = parseInt(timenow) + parseInt(Stopping_Time) - parseInt(Stop_Time);\r\n                            // }\r\n                            Stop_Time = timenow;//thoi diem gan nhat chay\r\n                            attributeTimeSeries.push({\r\n                                key: 'Stop_Time',\r\n                                value: Stop_Time\r\n                            });\r\n                            attributeTimeSeries.push({\r\n                                key: 'Stopping_Time',\r\n                                value: Stopping_Time\r\n                            });\r\n                            oldStatus = STOP;\r\n\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                    //nowStatus = PAUSE;\r\n                    break;\r\n                case RESUME:\r\n                    console.log(\"RESUME\" + STATUS + index + vm.STORESTATUS);\r\n                    nowStatus = RUNNING;\r\n                    oldStatus = STATUS;\r\n                    if (nowStatus == RUNNING) {\r\n                        attributeTimeSeries.push({\r\n                            key: 'Start_Time',\r\n                            value: timenow\r\n                        });\r\n\r\n                    } else if (nowStatus == STOP) {\r\n                        attributeTimeSeries.push({\r\n                            key: 'Stop_Time',\r\n                            value: timenow\r\n                        });\r\n\r\n                    }\r\n                    break;\r\n                case FINISH:\r\n                    switch (STATUS) {\r\n                        case RUNNING:\r\n                            console.log(\"Neu dang chay thi luu lai du lieu Running chay để sau count tiếp\");\r\n                            var Start_Time = oldData.Start_Time ? oldData.Start_Time[0].value : 0;\r\n                            var Running_Time = oldData.Running_Time ? oldData.Running_Time[0].value : 0;\r\n                            Running_Time = parseInt(timenow) + parseInt(Running_Time) - parseInt(Start_Time);\r\n                            Start_Time = timenow;//thoi diem gan nhat chay\r\n                            attributeTimeSeries.push({\r\n                                key: 'Start_Time',\r\n                                value: Start_Time\r\n                            });\r\n                            attributeTimeSeries.push({\r\n                                key: 'Running_Time',\r\n                                value: Running_Time\r\n                            });\r\n                            //oldStatus = RUNNING;\r\n                            break;\r\n                        case STOP:\r\n                            console.log(\"Neu dang chay thi luu lai du lieu stop  để sau count tiếp\");\r\n                            var Stop_Time = oldData.Stop_Time ? oldData.Stop_Time[0].value : 0;\r\n                            var Stopping_Time = oldData.Stopping_Time ? oldData.Stopping_Time[0].value : 0;\r\n                            Stopping_Time = parseInt(timenow) + parseInt(Stopping_Time) - parseInt(Stop_Time);\r\n                            // }\r\n                            Stop_Time = timenow;//thoi diem gan nhat chay\r\n                            attributeTimeSeries.push({\r\n                                key: 'Stop_Time',\r\n                                value: Stop_Time\r\n                            });\r\n                            attributeTimeSeries.push({\r\n                                key: 'Stopping_Time',\r\n                                value: Stopping_Time\r\n                            });\r\n                            //oldStatus = STOP;\r\n                            break;\r\n                        default:\r\n                            //oldStatus = STATUS;\r\n                            break;\r\n                    }\r\n                    nowStatus = FINISH;\r\n                default:\r\n                    break;\r\n            }\r\n            //cap nhat trang thai de dem\r\n            attributeTimeSeries.push({\r\n                key: 'STATUS',\r\n                value: nowStatus\r\n            });\r\n            attributeTimeSeries.push({\r\n                key: 'OLDSTATUS',\r\n                value: oldStatus\r\n            });\r\n\r\n\r\n            const updatevalue = attributeService.saveEntityTimeseries($scope.entityId, 'SERVER_SCOPE', attributeTimeSeries).subscribe(function success() {\r\n                console.log(\r\n                    \"cap nhat gia tri last\"\r\n                );\r\n\r\n            });\r\n            console.log(\"-----------------\" + nowStatus + \"-----\" + RESUME);\r\n            status_update.push({\r\n                key: 'STATUS',\r\n                value: nowStatus\r\n            });\r\n            status_update.push({\r\n                key: 'OLDSTATUS',\r\n                value: oldStatus\r\n            });\r\n\r\n            console.log(\"hahahahaa\");\r\n            $scope.relationData.forEach(d => {\r\n                if (d.device.length > 0) {\r\n                    vm.updateAttribute(d.to.id, d.device[0].to.id, d.device[0].to.entityType, index);\r\n                    console.log(\"iiiiii\", d.to.id);\r\n                }\r\n\r\n            })\r\n            const updatestatusSucess = new Promise((resolve, reject) => {\r\n                attributeService.saveEntityAttributes($scope.entityId, 'SERVER_SCOPE', status_update).subscribe(\r\n                    function success() {\r\n                        console.log(\r\n                            \"Cập nhật trạng thái line thành công\"\r\n                        );\r\n                        $scope.originalValue =\r\n                            $scope\r\n                                .attributeUpdateFormGroup\r\n                                .get('currentValue')\r\n                                .value;\r\n                        if (settings\r\n                            .showResultMessage\r\n                        ) {\r\n                            $scope.showSuccessToast(\"Cập nhật trạng thái thành công\");\r\n                            /*\r\n                                .showSuccessToast(\r\n                                    translate\r\n                                        .instant(\r\n                                            'widgets.input-widgets.update-successful'\r\n                                        ), 1000,\r\n                                    'bottom',\r\n                                    'left',\r\n                                    $scope\r\n                                        .toastTargetId\r\n                                );*/\r\n                        }\r\n                    },\r\n                    function fail() {\r\n                        if (settings\r\n                            .showResultMessage\r\n                        ) {\r\n                            $scope.showErrorToast(\"Cập nhật thất bại\");\r\n                            /*.showErrorToast(\r\n                                translate\r\n                                    .instant(\r\n                                        'widgets.input-widgets.update-failed'\r\n                                    ), 'bottom',\r\n                                'left',\r\n                                $scope\r\n                                    .toastTargetId\r\n                            );*/\r\n                        }\r\n                    }\r\n                );\r\n            });\r\n            await updatestatusSucess;//Đợi cập nhật xong trạng thái\r\n            await updatevalue;\r\n\r\n            //updateAllAttribute(index);\r\n        }\r\n        vm.secondsToHms = function (d) {\r\n            if (d == 0) return \"00:00:00\"\r\n            d = Number(d);\r\n            var h = Math.floor(d / 3600);\r\n            var m = Math.floor(d % 3600 / 60);\r\n            var s = Math.floor(d % 3600 % 60);\r\n            //var hDisplay = h > 0 ? h + (h == 1 ? \" hour, \" : \" hours, \") : \"\";\r\n            //var mDisplay = m > 0 ? m + (m == 1 ? \" minute, \" : \" minutes, \") : \"\";\r\n            //var sDisplay = s > 0 ? s + (s == 1 ? \" second\" : \" seconds\") : \"\";\r\n            var hDisplay = h > 0 ? h + (h == 1 ? \":\" : \":\") : \"\";\r\n            var mDisplay = m > 0 ? m + (m == 1 ? \":\" : \":\") : \"\";\r\n            var sDisplay = s > 0 ? s + (s == 1 ? \"\" : \"\") : \"\";\r\n            return hDisplay + mDisplay + sDisplay;\r\n        }\r\n        vm.updateAttribute = async function (assetId, entityId,\r\n            entityType, index) {\r\n            console.log(\"iiiiaaaaa\",assetId+entityId+entityType+index);\r\n            var assetInfo;\r\n            var numberOfPackage;\r\n            var groupProduct = \"\";\r\n            var product;\r\n            var groupProductSave;\r\n            const myPromise = new Promise((resolve, reject) => {\r\n                assetService.getAssetInfo(assetId).subscribe(d => {\r\n                    console.log('Asset infor: ', d);\r\n                    assetInfo = d;\r\n                    resolve();\r\n                });\r\n            });\r\n            await myPromise;\r\n            const entity = {\r\n                id: entityId,\r\n                entityType: entityType\r\n            };\r\n            //lay attribute\r\n            const myPromise_1 = new Promise((resolve, reject) => {\r\n                attributeService.getEntityAttributes($scope.entityId, 'SERVER_SCOPE', ['Group_Products','Number_Of_Package']).subscribe(data => {\r\n                    console.log(\"numberOfPackage\",data);\r\n                    if (data.length > 0) {\r\n                        \r\n                        product = data[0]?data[0].value:\"\";\r\n                        numberOfPackage = data[1]?data[1].value:\"\";\r\n                    }else{\r\n                        numberOfPackage = \"\";\r\n                        product = \"\";\r\n                    }\r\n                    // if (product != null) {\r\n\r\n                    //     assetService.findByName(\"38681\").subscribe(dataGroup => {\r\n                    //         product = dataGroup;\r\n                    //         attributeService.getEntityAttributes(product.id, 'SERVER_SCOPE', ['GroupProducts']).subscribe(group => {\r\n                    //             groupProduct = group[0].value;\r\n                    //             console.log(\"dataGroup\",groupProduct);\r\n                    //             resolve();\r\n                    //         });\r\n\r\n                    //     })\r\n                    // }\r\n                    resolve();\r\n                });\r\n            });\r\n            await myPromise_1;\r\n            console.log(\"numberOfPackage\",numberOfPackage);\r\n            // const myPromise_2 = new Promise((resolve, reject) => {\r\n            //     if (product != null) {\r\n            //         assetService.findByName(product).subscribe(dataGroup => {\r\n            //             product = dataGroup;\r\n            //             attributeService.getEntityAttributes(product.id, 'SERVER_SCOPE', ['GroupProducts']).subscribe(group => {\r\n            //                 if (group.length > 0) {\r\n            //                     var list_group = (group[0].value);\r\n            //                     groupProduct = list_group[0].name;\r\n            //                     groupProductSave = list_group;\r\n            //                     // if (list_group.length > 0) {\r\n            //                     //     groupProduct = list_group[0].name;\r\n            //                     // }\r\n            //                     console.log(\"dataGroup\", groupProduct);\r\n            //                 }\r\n            //                 resolve();\r\n            //             });\r\n\r\n            //         })\r\n            //     }\r\n            // });\r\n            // await myPromise_2;\r\n\r\n            var state = {\r\n                \"Cmd\": index,\r\n                \"Alert\": 0,\r\n            };\r\n            console.log(\"Entity: \", entity);\r\n            console.log($scope.data);\r\n            $scope.data.forEach((d, index) => {\r\n                if (index > 2)\r\n                    state[d.dataKey.name] = d.data[0][1];\r\n            });\r\n            console.log('Assetinfor: ', assetInfo);\r\n            if (assetInfo.type == 'production lines') {\r\n                state['Line_Id'] = assetInfo.name;\r\n            } else if (assetInfo.type == 'stage') {\r\n                state['Machine_Id'] = assetInfo.name;\r\n            }\r\n            var groupProduct = JSON.parse(product);\r\n            state[\"Group_Product\"] = groupProduct[0].name;\r\n            state[\"Number_Of_Package\"] = numberOfPackage;\r\n            //state[\"Number_Of_Package\"] = numberOfPackage;\r\n            $scope.isFocused = false;\r\n            console.log(\"numberOfPackagestate\",state);\r\n            if ($scope.entityDetected) {\r\n                var datasource = self.ctx\r\n                    .datasources[0];\r\n                console.log(\"State: \", state);\r\n                attributeService\r\n                    .saveEntityAttributes(\r\n                        entity,\r\n                        'SERVER_SCOPE',\r\n                        [{\r\n                            key: \"state\",\r\n                            value: state\r\n                        }]\r\n                    ).subscribe(\r\n                        function success() {\r\n                            console.log(\r\n                                \"Update Success\"\r\n                            );\r\n                            $scope.originalValue =\r\n                                $scope\r\n                                    .attributeUpdateFormGroup\r\n                                    .get('currentValue')\r\n                                    .value;\r\n                            if (settings\r\n                                .showResultMessage\r\n                            ) {\r\n                                $scope\r\n                                    .showSuccessToast(\r\n                                        translate\r\n                                            .instant(\r\n                                                'widgets.input-widgets.update-successful'\r\n                                            ), 1000,\r\n                                        'bottom',\r\n                                        'left',\r\n                                        $scope\r\n                                            .toastTargetId\r\n                                    );\r\n                            }\r\n                        },\r\n                        function fail() {\r\n                            if (settings\r\n                                .showResultMessage\r\n                            ) {\r\n                                $scope\r\n                                    .showErrorToast(\r\n                                        translate\r\n                                            .instant(\r\n                                                'widgets.input-widgets.update-failed'\r\n                                            ), 'bottom',\r\n                                        'left',\r\n                                        $scope\r\n                                            .toastTargetId\r\n                                    );\r\n                            }\r\n                        }\r\n                    );\r\n                //luu them group nua\r\n                //alert(groupProductSave);\r\n\r\n\r\n            }\r\n        };\r\n        vm.updateAllAttribute = function (index) {\r\n            $scope.relationData.forEach(d => {\r\n                if (d.device.length > 0) {\r\n                    vm.updateAttribute(d.to.id, d.device[0].to.id, d.device[0].to.entityType, index);\r\n                    console.log(\"iiiiii\", d.to.id);\r\n                }\r\n\r\n            })\r\n            //updateLine(index);\r\n        }\r\n    }\r\n    // $scope.openDialog();\r\n    // $scope.cancel = function() {\r\n    //     console.log(\"AAAA\");\r\n    //     dialog.close(null);\r\n    // }\r\n}\r\n// self.controlDialog = function(instance) {\r\n//     console.log(\"Control Dialog\");\r\n//         let vm = instance;\r\n\r\n//         vm.cancel = function() {\r\n//             console.log(\"cancel\");\r\n//             vm.dialogRef.close(null);\r\n//         };\r\n// }\r\n\r\nself.onDataUpdated = function () {\r\n\r\n    // try {\r\n    //     if ($scope.dataKeyDetected) {\r\n    //         if (!$scope.isFocused) {\r\n    //             $scope.originalValue = self.ctx\r\n    //                 .data[0].data[0][1];\r\n    //             $scope.attributeUpdateFormGroup.get(\r\n    //                 'currentValue').patchValue(\r\n    //                 correctValue($scope\r\n    //                     .originalValue));\r\n    //             self.ctx.detectChanges();\r\n    //         }\r\n    //     }\r\n    // } catch (e) {\r\n    //     console.log(e);\r\n    // }\r\n}\r\n\r\nfunction correctValue(value) {\r\n    if (typeof value !== \"number\") {\r\n        return 0;\r\n    }\r\n    return value;\r\n}\r\n\r\nself.onResize = function () {\r\n\r\n}\r\n\r\n\r\n\r\n// self.typeParameters = function() {\r\n//     return {\r\n//         maxDatasources: ,\r\n//         maxDataKeys: 1,\r\n//         singleEntity: true\r\n//     }\r\n// }\r\n\r\nself.onDestroy = function () {\r\n\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"EntitiesTableSettings\",\n        \"properties\": {\n            \"widgetTitle\": {\n                \"title\": \"Widget title\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"showLabel\":{\n                \"title\":\"Show label\",\n                \"type\":\"boolean\",\n                \"default\":true\n            },\n            \"name\": {\n              \"title\": \"name\",\n              \"type\": \"string\",\n              \"default\": \"\"\n            },\n            \"labelValue\": {\n                \"title\": \"Label\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"requiredErrorMessage\": {\n                \"title\": \"'Required' error message\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"maxValue\": {\n                \"title\": \"Max value\",\n                \"type\": \"number\",\n                \"default\": \"\"\n            },\n            \"minValue\": {\n                \"title\": \"Min value\",\n                \"type\": \"number\",\n                \"default\": \"\"\n            },\n            \"showResultMessage\":{\n                \"title\":\"Show result message\",\n                \"type\":\"boolean\",\n                \"default\":true\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"widgetTitle\",\n        \"showResultMessage\",\n        \"showLabel\",\n        \"name\",\n        \"labelValue\",\n        \"requiredErrorMessage\",\n        \"maxValue\",\n        \"minValue\"\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"showResultMessage\":true,\"showLabel\":true},\"title\":\"tutt20_control\",\"dropShadow\":true,\"enableFullscreen\":false,\"widgetStyle\":{},\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"useDashboardTimewindow\":true,\"showLegend\":false,\"actions\":{}}"
      },
      "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACgCAAAAABslHx1AAAAAmJLR0QA/4ePzL8AAANMSURBVHja7d3fS5NRGAfw/SsrhSCKKIugburCi6KCLrropi4izME0c1kLUxquHybmKNPAi4qMJkm9hOkswhVkpaLMfhmlbjHYu+3Vaf7a3r3fLjad5nZh6NiZ3+diO+fAe/HhOc85Z+/Fjg4R2T0ieLjlMHQRT0iF4KGGPBGdHEIWREjWudVsgKhu3QiyIkYIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQghZS8jbbwDQOT9slJc/5HGJAOmoAaAUjKWERCO9z7RI5kPGC8cBxy3A5/wUBoyy1qNirg+I9jtlAPBcvGkt7xWgRmyvgKpu9JR3NF4HjHLk9DSCBmi2eqnsFwCEK8vGRSj2j9fgM85h0Ito4VgC0m/R4GwEgHZ72xMRIOHiwIv7wJ/HN6oKfAmIdL62tsoCAMps1CvE8vuwvWIIaHgehTEGmULQgPYGv9+vCLWP/Cg1a4ClG18LvDDKKPmJPgNGzwXgdQkF0S5JAPrPXqgzDcAo402R2WYAukorzUMi7uzR6YWqmY0BJzQeUQghhBBC1h9kZllDDIj2cumBaKZaijWk6hmRIFqLybl0RDJJi75EgWitJse/Y20mKf4hDkRrWe4AJJOUPB8ZC0mWj1hOUjgyDjJ9zw1Ae5rcsUKIbK9rmVzovatv+hJvfh5ec4hirfidYl6teGp1bd1/Km9XfDhasOnksZxGAIGmA/rWtU/J2NXL7tT5WEmxz+0sUqHsNsR69lwXcDc3AC13b0U6IFCsZanzsZLld1D/AYApP/5wDYBBfTfwPupPCwSKNbnj/zbE44WLOvYcLwCkCYLpVTyiODb2zDe/P7qypQnphKzioXF0myUxMw9t3+MUFBLcd2LxP1qo1bnDQkKmjhydWjqw4YGIkMiJ/MT5ufggAL9eEhCilWzudLlcLgWvbYBDfyfoPpOnCAiZ1MeiGeYdKtCcp9cfHhB11YoXeewFo2+Cv9kJIYQQQghZf5DbaQ1mhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCEkMyFZc0FwdlzZPC7rwtlxibaqy45rzVX8BUWnY6Q1/jMIAAAAAElFTkSuQmCC",
      "description": "Simple form to input new double value for pre-defined server-side attribute key."
    },
    {
      "alias": "chart_thoigian",
      "name": "chart-thoigian",
      "descriptor": {
        "type": "timeseries",
        "sizeX": 8,
        "sizeY": 5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
          },
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js"
          }
        ],
        "templateHtml": "<canvas id=\"multiSeriesChart\"></canvas>",
        "templateCss": ".legend {\n    font-size: 13px;\n    line-height: 10px;\n}\n\n.legend table { \n    border-spacing: 0px;\n    border-collapse: separate;\n}\n\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n",
        "controllerScript": "let data;\r\nlet ChartDataLabels;\r\nvar list_stage;\r\n    $.getScript('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js', function(jd) {\r\n        $.getScript('https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js');\r\n    });\r\nself.onInit = function() {\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        list_stage = JSON.parse(partData[0].data[0][1]);\r\n        //console.log(\"check2 list_stage onInit----->\", list_stage);\r\n        console.log(\"list_stage\",list_stage);\r\n        //console.log(list_stage[1]);\r\n        //console.log(list_stage[2]);\r\n        //console.log(list_stage[3]);\r\n    }\r\n    data = {\r\n        labels: [\r\n        ],\r\n        // labels: [\"Sản lượng kế  hoạch\",\r\n        //     \"Sản lượng còn lại\",\r\n        //     \"Thời gian chạy\",\r\n        //     \"Thời gian còn lại\"\r\n        // ],\r\n        datasets: [{\r\n                backgroundColor: ['#38227d',\r\n                    'hsl(180, 100%, 35%)'\r\n                ],\r\n                data: []\r\n            },\r\n            {\r\n                backgroundColor: ['#f44336',\r\n                    '#4caf50'\r\n                ],\r\n                data: []\r\n            }\r\n\r\n        ]\r\n    };\r\n\r\n    console.log(\"Data multiSeriesChart: \", self.ctx\r\n        .data);\r\n    if (self.ctx.data[0].data.length > 0) {\r\n        //console.log(\"AAAAAAAAAAA\");\r\n        var numberOfOutput = parseFloat(self.ctx.data[0]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                0]\r\n            .data[0][1]) : 0;\r\n        var numberOfPlanning = parseFloat(self.ctx.data[\r\n                1]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                1]\r\n            .data[0][1]) : 0;\r\n        var runningTime = parseFloat(self.ctx.data[2]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                2]\r\n            .data[0][1]) : 0;\r\n        var planningTime = parseFloat(self.ctx.data[3]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                3]\r\n            .data[0][1]) : 0;\r\n        var totalNumber = (numberOfPlanning +\r\n            numberOfOutput) != 0 ? (\r\n            numberOfPlanning +\r\n            numberOfOutput) : 1;\r\n        var totalTime = (runningTime +\r\n            planningTime) != 0 ? (runningTime +\r\n            planningTime) : 1;\r\n        data.datasets[0].data.push(numberOfOutput /\r\n            totalNumber * 100);\r\n        data.datasets[0].data.push(numberOfPlanning /\r\n            totalNumber * 100);\r\n        data.datasets[1].data.push(runningTime /\r\n            totalTime * 100);\r\n        data.datasets[1].data.push(planningTime /\r\n            totalTime * 100);\r\n\r\n    }\r\n    console.log(data);\r\n\r\n    const config = {\r\n        type: 'doughnut',\r\n        data: data,\r\n        plugins: [ChartDataLabels ? ChartDataLabels: ''],\r\n        options: {\r\n            responsive: false,\r\n            maintainAspectRatio: false,\r\n            plugins: {\r\n                datalabels: {\r\n                    display: true,\r\n                    formatter: (value) => {\r\n                        return Math.round(\r\n                                value * 100) /\r\n                            100 + '%';\r\n                    },\r\n                    color: \"#fff\"\r\n                },\r\n\r\n                legend: {\r\n                    labels: {\r\n                        display: true,\r\n                        generateLabels: function(\r\n                            chart) {\r\n                            // Get the default label list\r\n                            const original =\r\n                                Chart.overrides\r\n                                .pie.plugins\r\n                                .legend.labels\r\n                                .generateLabels;\r\n                            const\r\n                                labelsOriginal =\r\n                                original.call(\r\n                                    this, chart\r\n                                );\r\n\r\n                            // Build an array of colors used in the datasets of the chart\r\n                            let datasetColors =\r\n                                chart.data\r\n                                .datasets.map(\r\n                                    function(\r\n                                        e) {\r\n                                        return e\r\n                                            .backgroundColor;\r\n                                    });\r\n                            datasetColors =\r\n                                datasetColors\r\n                                .flat();\r\n\r\n                            // Modify the color and hide state of each label\r\n                            labelsOriginal\r\n                                .forEach(\r\n                                    label => {\r\n                                        // There are twice as many labels as there are datasets. This converts the label index into the corresponding dataset index\r\n                                        label\r\n                                            .datasetIndex =\r\n                                            (label\r\n                                                .index -\r\n                                                label\r\n                                                .index %\r\n                                                2\r\n                                            ) /\r\n                                            2;\r\n\r\n                                        // The hidden state must match the dataset's hidden state\r\n                                        label\r\n                                            .hidden = !\r\n                                            chart\r\n                                            .isDatasetVisible(\r\n                                                label\r\n                                                .datasetIndex\r\n                                            );\r\n\r\n                                        // Change the color to match the dataset\r\n                                        label\r\n                                            .fillStyle =\r\n                                            datasetColors[\r\n                                                label\r\n                                                .index\r\n                                            ];\r\n                                    });\r\n\r\n                            const chartTitle =\r\n                                labelsOriginal\r\n                                .filter(\r\n                                    function(\r\n                                        value,\r\n                                        index,\r\n                                        arr) {\r\n                                        if (index ==\r\n                                            0) {\r\n                                            value\r\n                                                .text =\r\n                                                \"Sản lượng\";\r\n                                            return value;\r\n                                        }\r\n                                        if (index ==\r\n                                            2) {\r\n                                            value\r\n                                                .text =\r\n                                                \"Thời gian\";\r\n                                            return value;\r\n                                        }\r\n                                    })\r\n                            console.log(\r\n                                labelsOriginal\r\n                            )\r\n                            return chartTitle;\r\n                        }\r\n                    },\r\n                    onClick: function(mouseEvent,\r\n                        legendItem, legend) {\r\n                        // toggle the visibility of the dataset from what it currently is\r\n                        legend.chart\r\n                            .getDatasetMeta(\r\n                                legendItem\r\n                                .datasetIndex\r\n                            ).hidden = legend\r\n                            .chart\r\n                            .isDatasetVisible(\r\n                                legendItem\r\n                                .datasetIndex);\r\n                        legend.chart.update();\r\n                    }\r\n                },\r\n                tooltip: {\r\n                    callbacks: {\r\n                        label: function(context) {\r\n                            const labelIndex = (\r\n                                    context\r\n                                    .datasetIndex *\r\n                                    2) + context\r\n                                .dataIndex;\r\n                            return context.chart\r\n                                .data.labels[\r\n                                    labelIndex\r\n                                ] + ': ' +\r\n                                context\r\n                                .formattedValue;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    var ctx = $('#multiSeriesChart', self.ctx\r\n        .$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function() {\r\n    var data1 = [];\r\n    var data2 = [];\r\n    console.log(\"cập nhật dữ liệu: \", self.ctx\r\n        .data);\r\n    if (self.ctx.data[0].data.length > 0) {\r\n        //console.log(\"AAAAAAAAAAA\");\r\n        // var numberOfOutput = parseFloat(self.ctx.data[0]\r\n        //     .data[0][1]) ? parseFloat(self.ctx.data[\r\n        //         0]\r\n        //     .data[0][1]) : 0;\r\n        var numberOfOutput = [list_stage.length-1].Number_Of_Output?list_stage[list_stage.length-1].Number_Of_Output:0\r\n        console.log(\"numberOfOutput\",numberOfOutput)\r\n        var numberOfPlanning = parseFloat(self.ctx.data[1].data[0][1]) ? parseFloat(self.ctx.data[1].data[0][1]) : 0;\r\n        //tinh toan Running_Time\r\n        var runningTime = parseFloat(self.ctx.data[2].data[0][1]) ? parseFloat(self.ctx.data[2].data[0][1]) : 0;\r\n        console.log(\"runningTime\",runningTime)\r\n        var startTime = parseFloat(self.ctx.data[4].data[0][1]) ? parseFloat(self.ctx.data[4].data[0][1]) : 0;\r\n        runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime))/1000);\r\n        console.log(\"runningTime_2\",runningTime)\r\n        var planningTime = parseFloat(self.ctx.data[3].data[0][1]) ? parseFloat(self.ctx.data[3].data[0][1]) : 0;\r\n        var totalNumber = (numberOfPlanning +\r\n            numberOfOutput) != 0 ? (\r\n            numberOfPlanning +\r\n            numberOfOutput) : 1;\r\n        var totalTime = (runningTime +\r\n            planningTime) != 0 ? (runningTime +\r\n            planningTime) : 1;\r\n        var percent_sanluong = parseFloat(numberOfOutput / numberOfPlanning *100).toFixed(2);\r\n        var percent_sanluong_con = parseFloat(100-percent_sanluong).toFixed(2);\r\n        const data1 = [percent_sanluong,\r\n            percent_sanluong_con\r\n        ];\r\n        var time_chay = parseFloat(runningTime / planningTime *100).toFixed(2);\r\n        var time_con = parseFloat(100-time_chay).toFixed(2);\r\n        const data2 = [time_chay,time_con\r\n        ];\r\n        data.datasets[0].data = data1;\r\n        data.datasets[1].data = data2;\r\n\r\n    }\r\n    // console.log(\"Self data ctx: \", self.ctx.data);\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n    //     var cellData = self.ctx.data[i];\r\n    //     if (cellData.data.length > 0) {\r\n    //         var decimals;\r\n    //         if (typeof cellData.dataKey.decimals !== 'undefined' \r\n    //             && cellData.dataKey.decimals !== null ) {\r\n    //             decimals = cellData.dataKey.decimals; \r\n    //         } else {\r\n    //             decimals = self.ctx.decimals;\r\n    //         }\r\n    //         var tvPair = cellData.data[cellData.data.length - 1];\r\n    //         var value = self.ctx.utils.formatValue(tvPair[1], decimals);\r\n    //         self.ctx.chart.data.datasets[0].data[i] = parseFloat(value);\r\n    //     }\r\n    // }\r\n    self.ctx.chart.update();\r\n\r\n}\r\n\r\nself.onResize = function() {\r\n    self.ctx.chart.resize();\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"borderWidth\": {\n                \"title\": \"Border width\",\n                \"type\": \"number\",\n                \"default\": 5\n            },\n            \"borderColor\": {\n                \"title\": \"Border color\",\n                \"type\": \"string\",\n                \"default\": \"#fff\"\n            },\n            \"legend\": {\n                \"title\": \"Legend settings\",\n                \"type\": \"object\",\n                \"properties\": {\n                    \"display\": {\n                        \"title\": \"Display legend\",\n                        \"type\": \"boolean\",\n                        \"default\": true\n                    },\n                    \"labelsFontColor\": {\n                        \"title\": \"Labels font color\",\n                        \"type\": \"string\",\n                        \"default\": \"#666\"\n                    }\n                }\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"borderWidth\", \n        {\n            \"key\": \"borderColor\",\n            \"type\": \"color\"\n        }, \n        {\n            \"key\": \"legend\",\n            \"items\": [\n                \"legend.display\",\n                {\n                    \"key\": \"legend.labelsFontColor\",\n                    \"type\": \"color\"\n                }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1},\"legend\":{\"show\":true,\"position\":\"nw\",\"backgroundColor\":\"#f0f0f0\",\"backgroundOpacity\":0.85,\"labelBoxBorderColor\":\"rgba(1, 1, 1, 0.45)\"},\"decimals\":1,\"stack\":false,\"tooltipIndividual\":false},\"title\":\"chart-thoigian\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "multi_series_pie322",
      "name": "Multi series pie",
      "descriptor": {
        "type": "latest",
        "sizeX": 9,
        "sizeY": 8.5,
        "resources": [
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0/chartjs-plugin-datalabels.min.js",
            "isModule": false
          },
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.0/chart.min.js"
          }
        ],
        "templateHtml": "<canvas id=\"multiSeriesChart\"></canvas>",
        "templateCss": "",
        "controllerScript": "let data;\r\nlet ChartDataLabels;\r\nself.onInit = function () {\r\n    data = {\r\n        labels: [\"Sản lượng kế  hoạch\",\r\n            \"Sản lượng hoàn thành\",\r\n            \"Thời gian chạy\",\r\n            \"Thời gian kế hoạch\"\r\n        ],\r\n        datasets: [{\r\n            backgroundColor: ['#38227d',\r\n                'hsl(180, 100%, 35%)'\r\n            ],\r\n            data: []\r\n        },\r\n        {\r\n            backgroundColor: ['#f44336',\r\n                '#4caf50'\r\n            ],\r\n            data: []\r\n        }\r\n\r\n        ]\r\n    };\r\n\r\n    //console.log(\"Data multiSeriesChart: \", self.ctx\r\n    //   .data);\r\n    if (self.ctx.data[0].data.length > 0) {\r\n        console.log(\"linhnv10\");\r\n        // var numberOfOutput = parseFloat(self.ctx.data[0]\r\n        //     .data[0][1]) ? parseFloat(self.ctx.data[\r\n        //         0]\r\n        //         .data[0][1]) : 0;\r\n        // var numberOfPlanning = parseFloat(self.ctx.data[\r\n        //     1]\r\n        //     .data[0][1]) ? parseFloat(self.ctx.data[\r\n        //         1]\r\n        //         .data[0][1]) : 0;\r\n        // var runningTime = parseFloat(self.ctx.data[2]\r\n        //     .data[0][1]) ? parseFloat(self.ctx.data[\r\n        //         2]\r\n        //         .data[0][1]) : 0;\r\n        // var planningTime = parseFloat(self.ctx.data[3]\r\n        //     .data[0][1]) ? parseFloat(self.ctx.data[\r\n        //         3]\r\n        //         .data[0][1]) : 0;\r\n        const partData = self.ctx.data;\r\n        var list_stage;\r\n\r\n        if (partData[0].data.length > 0) {\r\n            list_stage = JSON.parse(partData[0].data[0][1]);\r\n        }\r\n        console.log(\"list_stage\",list_stage);\r\n        var numberOfOutput = list_stage ? list_stage[list_stage.length - 1].Number_Of_Ouput : 0\r\n        console.log(\"numberOfOutput\", numberOfOutput);\r\n        var numberOfPlanning = parseFloat(self.ctx.data[\r\n            1]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                1]\r\n                .data[0][1]) : 0;\r\n        console.log(\"numberOfPlanning\", numberOfPlanning);\r\n        //list_stage,Number_Of_Planning,Running_Time,Start_Time,PlanningTime\r\n        var runningTime = parseFloat(self.ctx.data[2]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                2]\r\n                .data[0][1]) : 0;\r\n        console.log(\"runningTime\", runningTime);\r\n        var startTime = parseFloat(self.ctx.data[3]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                2]\r\n                .data[0][1]) : 0;\r\n        runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)));\r\n        console.log(\"runningTime_\", runningTime);\r\n        var planningTime = parseFloat(self.ctx.data[3]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                3]\r\n                .data[0][1]) : 0;\r\n        console.log(\"planningTime\", planningTime);\r\n        var totalNumber = (numberOfPlanning +\r\n            numberOfOutput) != 0 ? (\r\n            numberOfPlanning +\r\n            numberOfOutput) : 1;\r\n        var totalTime = (runningTime +\r\n            planningTime) != 0 ? (runningTime +\r\n                planningTime) : 1;\r\n        data.datasets[0].data.push(numberOfOutput /\r\n            totalNumber * 100);\r\n        data.datasets[0].data.push(numberOfPlanning /\r\n            totalNumber * 100);\r\n        data.datasets[1].data.push(runningTime /\r\n            totalTime * 100);\r\n        data.datasets[1].data.push(planningTime /\r\n            totalTime * 100);\r\n\r\n    }\r\n    //console.log(data);\r\n\r\n    const config = {\r\n        type: 'doughnut',\r\n        data: data,\r\n        plugins: [ChartDataLabels ? ChartDataLabels : ''],\r\n        options: {\r\n            responsive: false,\r\n            maintainAspectRatio: false,\r\n            plugins: {\r\n                datalabels: {\r\n                    display: true,\r\n                    formatter: (value) => {\r\n                        return Math.round(\r\n                            value * 100) /\r\n                            100 + '%';\r\n                    },\r\n                    color: \"#fff\"\r\n                },\r\n\r\n                legend: {\r\n                    labels: {\r\n                        display: true,\r\n                        generateLabels: function (\r\n                            chart) {\r\n                            // Get the default label list\r\n                            const original =\r\n                                Chart.overrides\r\n                                    .pie.plugins\r\n                                    .legend.labels\r\n                                    .generateLabels;\r\n                            const\r\n                                labelsOriginal =\r\n                                    original.call(\r\n                                        this, chart\r\n                                    );\r\n\r\n                            // Build an array of colors used in the datasets of the chart\r\n                            let datasetColors =\r\n                                chart.data\r\n                                    .datasets.map(\r\n                                        function (\r\n                                            e) {\r\n                                            return e\r\n                                                .backgroundColor;\r\n                                        });\r\n                            datasetColors =\r\n                                datasetColors\r\n                                    .flat();\r\n\r\n                            // Modify the color and hide state of each label\r\n                            labelsOriginal\r\n                                .forEach(\r\n                                    label => {\r\n                                        // There are twice as many labels as there are datasets. This converts the label index into the corresponding dataset index\r\n                                        label\r\n                                            .datasetIndex =\r\n                                            (label\r\n                                                .index -\r\n                                                label\r\n                                                    .index %\r\n                                                2\r\n                                            ) /\r\n                                            2;\r\n\r\n                                        // The hidden state must match the dataset's hidden state\r\n                                        label\r\n                                            .hidden = !\r\n                                            chart\r\n                                                .isDatasetVisible(\r\n                                                    label\r\n                                                        .datasetIndex\r\n                                                );\r\n\r\n                                        // Change the color to match the dataset\r\n                                        label\r\n                                            .fillStyle =\r\n                                            datasetColors[\r\n                                            label\r\n                                                .index\r\n                                            ];\r\n                                    });\r\n\r\n                            const chartTitle =\r\n                                labelsOriginal\r\n                                    .filter(\r\n                                        function (\r\n                                            value,\r\n                                            index,\r\n                                            arr) {\r\n                                            if (index ==\r\n                                                0) {\r\n                                                value\r\n                                                    .text =\r\n                                                    \"Sản lượng\";\r\n                                                return value;\r\n                                            }\r\n                                            if (index ==\r\n                                                2) {\r\n                                                value\r\n                                                    .text =\r\n                                                    \"Thời gian\";\r\n                                                return value;\r\n                                            }\r\n                                        })\r\n                            console.log(\r\n                                labelsOriginal\r\n                            )\r\n                            return chartTitle;\r\n                        }\r\n                    },\r\n                    onClick: function (mouseEvent,\r\n                        legendItem, legend) {\r\n                        // toggle the visibility of the dataset from what it currently is\r\n                        legend.chart\r\n                            .getDatasetMeta(\r\n                                legendItem\r\n                                    .datasetIndex\r\n                            ).hidden = legend\r\n                                .chart\r\n                                .isDatasetVisible(\r\n                                    legendItem\r\n                                        .datasetIndex);\r\n                        legend.chart.update();\r\n                    }\r\n                },\r\n                tooltip: {\r\n                    callbacks: {\r\n                        label: function (context) {\r\n                            const labelIndex = (\r\n                                context\r\n                                    .datasetIndex *\r\n                                2) + context\r\n                                    .dataIndex;\r\n                            return context.chart\r\n                                .data.labels[\r\n                                labelIndex\r\n                            ] + ': ' +\r\n                                context\r\n                                    .formattedValue;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    var ctx = $('#multiSeriesChart', self.ctx\r\n        .$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n    var data1 = [];\r\n    var data2 = [];\r\n    // console.log(\"Data multiSeriesChart: \", self.ctx\r\n    //     .data);\r\n    const partData = self.ctx.data;\r\n    var list_stage;\r\n    if (self.ctx.data[0].data.length > 0) {\r\n        if (partData[0].data.length > 0) {\r\n            list_stage = JSON.parse(partData[0].data[0][1]);\r\n        }\r\n        var numberOfOutput = list_stage ? list_stage[list_stage.length - 1].Number_Of_Ouput : 0\r\n        console.log(\"numberOfOutput\", numberOfOutput);\r\n        var numberOfPlanning = parseFloat(self.ctx.data[\r\n            1]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                1]\r\n                .data[0][1]) : 0;\r\n        console.log(\"numberOfPlanning\", numberOfPlanning);\r\n        //list_stage,Number_Of_Planning,Running_Time,Start_Time,PlanningTime\r\n        var runningTime = parseFloat(self.ctx.data[2]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                2]\r\n                .data[0][1]) : 0;\r\n        console.log(\"runningTime\", runningTime);\r\n        var startTime = parseFloat(self.ctx.data[3]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                2]\r\n                .data[0][1]) : 0;\r\n        runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)));\r\n        console.log(\"runningTime_\", runningTime);\r\n        var planningTime = parseFloat(self.ctx.data[3]\r\n            .data[0][1]) ? parseFloat(self.ctx.data[\r\n                3]\r\n                .data[0][1]) : 0;\r\n        console.log(\"planningTime\", planningTime);\r\n        var totalNumber = (numberOfPlanning +\r\n            numberOfOutput) != 0 ? (\r\n            numberOfPlanning +\r\n            numberOfOutput) : 1;\r\n        var totalTime = (runningTime +\r\n            planningTime) != 0 ? (runningTime +\r\n                planningTime) : 1;\r\n        const data1 = [numberOfOutput / totalNumber *\r\n            100,\r\n        numberOfPlanning / totalNumber * 100\r\n        ];\r\n        const data2 = [runningTime /\r\n            totalTime * 100,\r\n        planningTime /\r\n        totalTime * 100\r\n        ];\r\n        data.datasets[0].data = data1;\r\n        data.datasets[1].data = data2;\r\n\r\n    }\r\n    // console.log(\"Self data ctx: \", self.ctx.data);\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n    //     var cellData = self.ctx.data[i];\r\n    //     if (cellData.data.length > 0) {\r\n    //         var decimals;\r\n    //         if (typeof cellData.dataKey.decimals !== 'undefined' \r\n    //             && cellData.dataKey.decimals !== null ) {\r\n    //             decimals = cellData.dataKey.decimals; \r\n    //         } else {\r\n    //             decimals = self.ctx.decimals;\r\n    //         }\r\n    //         var tvPair = cellData.data[cellData.data.length - 1];\r\n    //         var value = self.ctx.utils.formatValue(tvPair[1], decimals);\r\n    //         self.ctx.chart.data.datasets[0].data[i] = parseFloat(value);\r\n    //     }\r\n    // }\r\n    self.ctx.chart.update();\r\n\r\n}\r\n\r\nself.onResize = function () {\r\n    self.ctx.chart.resize();\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"borderWidth\": {\n                \"title\": \"Border width\",\n                \"type\": \"number\",\n                \"default\": 5\n            },\n            \"borderColor\": {\n                \"title\": \"Border color\",\n                \"type\": \"string\",\n                \"default\": \"#fff\"\n            },\n            \"legend\": {\n                \"title\": \"Legend settings\",\n                \"type\": \"object\",\n                \"properties\": {\n                    \"display\": {\n                        \"title\": \"Display legend\",\n                        \"type\": \"boolean\",\n                        \"default\": true\n                    },\n                    \"labelsFontColor\": {\n                        \"title\": \"Labels font color\",\n                        \"type\": \"string\",\n                        \"default\": \"#666\"\n                    }\n                }\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"borderWidth\", \n        {\n            \"key\": \"borderColor\",\n            \"type\": \"color\"\n        }, \n        {\n            \"key\": \"legend\",\n            \"items\": [\n                \"legend.display\",\n                {\n                    \"key\": \"legend.labelsFontColor\",\n                    \"type\": \"color\"\n                }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#26a69a\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#f57c00\",\"settings\":{},\"_hash\":0.545701115289893,\"funcBody\":\"var value = (prevValue-20) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+20;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Third\",\"color\":\"#afb42b\",\"settings\":{},\"_hash\":0.2592906835158064,\"funcBody\":\"var value = (prevValue-40) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+40;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Fourth\",\"color\":\"#673ab7\",\"settings\":{},\"_hash\":0.12880275585455747,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"borderWidth\":5,\"borderColor\":\"#fff\",\"legend\":{\"display\":true,\"labelsFontColor\":\"#666666\"}},\"title\":\"Multi series pie\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400}}"
      },
      "image": "data:image/png;base64,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",
      "description": "Displays latest values of the attributes or timeseries data for multiple entities in a doughnut chart. Supports numeric values only."
    },
    {
      "alias": "ecyber_bar_line_chart",
      "name": "ecyber_bar_line_chart",
      "descriptor": {
        "type": "latest",
        "sizeX": 8,
        "sizeY": 5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
          },
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js"
          }
        ],
        "templateHtml": "<canvas id=\"barmixlinechart\"></canvas>",
        "templateCss": ".legend {\n    font-size: 13px;\n    line-height: 10px;\n}\n\n.legend table { \n    border-spacing: 0px;\n    border-collapse: separate;\n}\n\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n",
        "controllerScript": "let data;\r\nlet ChartDataLabels;\r\n//var avarage_productivity=[];\r\n// var partData;\r\n//     $.getScript('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js', function(jd) {\r\n//         $.getScript('https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js');\r\n//     });\r\nself.onInit = function () {\r\n    var partData = self.ctx.data;\r\n    console.log(\"partData\",partData);\r\n    var avarage_productivity = [];\r\n    if (partData[0].data.length > 0) {\r\n        avarage_productivity = JSON.parse(partData[0].data[0][1]);\r\n        console.log(\"avarage_productivity\",avarage_productivity);\r\n        //var runningTime = parseFloat(partData[2].data[0][1]) ? parseFloat(self.ctx.data[2].data[0][1]) : 0;\r\n        //so giay cua Running_Time\r\n        //runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n    }\r\n    data = {\r\n        labels: [],\r\n        datasets: [{\r\n            type: 'line',\r\n            label: 'Năng suất bình quân',\r\n            data: [],\r\n            fill: false,\r\n            backgroundColor: 'rgba(255, 255, 0)',\r\n            borderColor: 'rgb(255, 0, 0)'\r\n        },{\r\n            type: 'bar',\r\n            label: 'Sản lượng theo giờ',\r\n            data: [],\r\n            borderColor: 'rgb(255, 99, 132)',\r\n            backgroundColor: 'rgba(255, 99, 132, 0.2)'\r\n        } ]\r\n    };\r\n    const d = new Date();\r\n    let hour = d.getHours();\r\n    for(i=0;i<avarage_productivity.length;i++){\r\n        var v = avarage_productivity[i];\r\n        console.log(\"vvvvvv\",v);\r\n        var normal_productivity = partData[1].data[0][1]?partData[1].data[0][1]:0\r\n        \r\n        data.labels.push(v.Time);\r\n        data.datasets[1].data.push(v.Avg_Productivity)\r\n        data.datasets[0].data.push(normal_productivity);\r\n    }\r\n    \r\n        //data.labels = [hour-4 + \":00\", hour-3+ \":00\", hour-2+ \":00\", hour-1+ \":00\", hour+ \":00\"];\r\n         //data.datasets[0].data = [1000, 2000, 3000, 4000, 5000]\r\n    console.log(\"data.labels\",data.labels);\r\n    console.log(\"data.datasets[0].data\",data.datasets[0].data);\r\n         //data.datasets[1].data = [1, 1, 1, 1, 1];\r\n\r\n\r\n    const config = {\r\n        type: 'scatter',\r\n        data: data,\r\n        options: {\r\n            responsive: false,\r\n            maintainAspectRatio: false,\r\n            scales: {\r\n                y: {\r\n                    beginAtZero: true\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n    var ctx = $('#barmixlinechart', self.ctx\r\n        .$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n    data.labels = [];\r\n    data.datasets[0].data\r\n    data.datasets[1].data = [];\r\n    data.datasets[1].backgroundColor = [\"#0032ff\"];\r\n    data.datasets[0].backgroundColor = [\"#FFFF00\"];\r\n    var partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        var normal_productivity = partData[1].data[0][1]?partData[1].data[0][1]:0\r\n        var avarage_productivity = JSON.parse(partData[0].data[0][1])\r\n        var runningTime = parseFloat(partData[2].data[0][1]) ? parseFloat(partData[2].data[0][1]) : 0;\r\n        console.log(\"runningTime\",runningTime)\r\n        var startTime = parseFloat(partData[3].data[0][1]) ? parseFloat(partData[3].data[0][1]) : 0;\r\n        runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime))/1000);\r\n        var maxxx = parseInt(runningTime/30);\r\n        console.log(\"maxxx\",maxxx);\r\n        //console.log(\"avarage_productivity_update\",avarage_productivity);\r\n    \r\n        for(i=0;i<avarage_productivity.length;i++){\r\n        var v = avarage_productivity[i];\r\n        console.log(\"vvvvvv\",v);\r\n        //var time_show = startTime\r\n        data.labels.push(v.Time+\":00\");\r\n        data.datasets[1].data.push(v.Avg_Productivity)\r\n        data.datasets[0].data.push(normal_productivity);\r\n    }\r\n    }\r\n    self.ctx.chart.update();\r\n}\r\n\r\nself.onResize = function () {\r\n    self.ctx.chart.resize();\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"borderWidth\": {\n                \"title\": \"Border width\",\n                \"type\": \"number\",\n                \"default\": 5\n            },\n            \"borderColor\": {\n                \"title\": \"Border color\",\n                \"type\": \"string\",\n                \"default\": \"#fff\"\n            },\n            \"legend\": {\n                \"title\": \"Legend settings\",\n                \"type\": \"object\",\n                \"properties\": {\n                    \"display\": {\n                        \"title\": \"Display legend\",\n                        \"type\": \"boolean\",\n                        \"default\": true\n                    },\n                    \"labelsFontColor\": {\n                        \"title\": \"Labels font color\",\n                        \"type\": \"string\",\n                        \"default\": \"#666\"\n                    }\n                }\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"borderWidth\", \n        {\n            \"key\": \"borderColor\",\n            \"type\": \"color\"\n        }, \n        {\n            \"key\": \"legend\",\n            \"items\": [\n                \"legend.display\",\n                {\n                    \"key\": \"legend.labelsFontColor\",\n                    \"type\": \"color\"\n                }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"shadowSize\":4,\"fontColor\":\"#545454\",\"fontSize\":10,\"xaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"yaxis\":{\"showLabels\":true,\"color\":\"#545454\"},\"grid\":{\"color\":\"#545454\",\"tickColor\":\"#DDDDDD\",\"verticalLines\":true,\"horizontalLines\":true,\"outlineWidth\":1},\"legend\":{\"show\":true,\"position\":\"nw\",\"backgroundColor\":\"#f0f0f0\",\"backgroundOpacity\":0.85,\"labelBoxBorderColor\":\"rgba(1, 1, 1, 0.45)\"},\"decimals\":1,\"stack\":false,\"tooltipIndividual\":false},\"title\":\"ecyber_bar_line_chart\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "hopcach",
      "name": "Hopcach",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0/chartjs-plugin-datalabels.min.js"
          },
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.3.0/Chart.min.js"
          }
        ],
        "templateHtml": "<canvas id=\"pieChart\"></canvas>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}",
        "controllerScript": "let data;\r\nlet ChartDataLabels;\r\nlet config\r\n//const partData = self.ctx.data;\r\n//const error_list = self.ctx.data[0] ? oldData.list_stage[0].value : 0;\r\nvar list_stage;\r\n//var partData = self.ctx.data;\r\nself.onInit = function () {\r\n    console.log(\"Self.ctx.data: ---->\", self.ctx.data);\r\n    console.log(\"Self.ctx.datasource: ------>\", self.ctx.datasources);\r\n    const partData = self.ctx.data;\r\n    //const error_list = self.ctx.data[0] ? oldData.list_stage[0].value : 0;\r\n    // list_stage;\r\n    var label = [];\r\n    //var \r\n    if (partData[0].data.length > 0) {\r\n        list_stage = JSON.parse(partData[0].data[0][1]);\r\n    }\r\n    data = {\r\n        labels: [\r\n        ],\r\n        datasets: [{\r\n            label: 'Dữ liệu đầu vào',\r\n            data: [],\r\n            backgroundColor: [\r\n            ],\r\n            hoverOffset: 4\r\n        }]\r\n    };\r\n    if (partData[0].data.length > 0) {\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n\r\n        if (list_stage != \"\") {\r\n            var sum_loi_vattu = 0;\r\n\r\n            //const parts = JSON.parse(partData[0].data[0][1]);\r\n            for (var i = 0; i < list_stage.length; i++) {\r\n                //data.labels.push(list_stage[i].stage_name);\r\n                //let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                //let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n                var loi_vattu = list_stage[i].Error_vattu?parseInt(list_stage[i].Error_vattu):0\r\n                sum_loi_vattu = sum_loi_vattu + loi_vattu;\r\n                \r\n            }\r\n            var input = list_stage[0].Number_Of_Input;\r\n            var tile_loi_vatu = input!=0?parseInt(sum_loi_vattu)*100/input:0\r\n            data.labels.push(\"Hợp cách\");\r\n            data.labels.push(\"Còn lại\");\r\n            var hopcach = 100-tile_loi_vatu;\r\n            data.datasets[0].data.push(hopcach);\r\n            data.datasets[0].data.push(tile_loi_vatu);\r\n        }\r\n        //data.datasets[0].data.push(2);\r\n    }\r\n\r\n\r\n    var options = {\r\n        responsive: false,\r\n        maintainAspectRatio: false,\r\n        title: {\r\n            display: true,\r\n            text: 'hợp cách',\r\n            position: 'top',\r\n            fontSize: 16,\r\n            fontColor: '#111',\r\n            padding: 10\r\n        },\r\n        legend: {\r\n            display: true,\r\n            position: 'bottom',\r\n            labels: {\r\n                boxWidth: 20,\r\n                fontColor: '#111',\r\n                padding: 15\r\n            }\r\n        },\r\n        tooltips: {\r\n            enabled: true\r\n        },\r\n\t\telements: {\r\n    center: {\r\n      text: 'Red is 2/3 the total numbers',\r\n      color: '#FF6384', // Default is #000000\r\n      fontStyle: 'Arial', // Default is Arial\r\n      sidePadding: 20, // Default is 20 (as a percentage)\r\n      minFontSize: 20, // Default is 20 (in px), set to false and text will not wrap.\r\n      lineHeight: 25 // Default is 25 (in px), used for when text wraps\r\n    \r\n    }\r\n    },\r\n        plugins: {\r\n            datalabels: {\r\n                color: '#fffff',\r\n                formatter: function (value, ctx) {\r\n                    //alert('ok');\r\n                  let sum = 0;\r\n                  let dataArr = ctx.chart.data.datasets[0].data;\r\n                  dataArr.map(data => {\r\n                      sum += data;\r\n                  });\r\n                  let percentage = (value*100 / sum).toFixed(2)+\"%\";\r\n                  return percentage;\r\n\r\n                }\r\n            }\r\n        }\r\n    }\r\n    //huong add end\r\n    config = {\r\n        type: 'doughnut',\r\n        data: data,\r\n        options: options\r\n        // options: {\r\n        //     responsive: false,\r\n        //     maintainAspectRatio: false\r\n        // }\r\n\r\n\r\n    };\r\n    console.log('config----->', config);\r\n    var ctx = $('#pieChart', self.ctx\r\n        .$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n    console.log('config---->', config);\r\n    data.labels = [];\r\n    data.datasets[0].data = [];\r\n    data.datasets[0].backgroundColor = [\"#f38b4a\",\r\n        \"#56d798\",\r\n        \"#ff8397\",\r\n        \"#6970d5\", \"#FFFF00\", \"#FF00FF\", \"#F0F0F0\"];\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n\r\n        if (list_stage != \"\") {\r\n            var sum_loi_vattu = 0;\r\n\r\n            //const parts = JSON.parse(partData[0].data[0][1]);\r\n            for (var i = 0; i < list_stage.length; i++) {\r\n                //data.labels.push(list_stage[i].stage_name);\r\n                //let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                //let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n                var loi_vattu = list_stage[i].Error_vattu?parseInt(list_stage[i].Error_vattu):0\r\n                sum_loi_vattu = sum_loi_vattu + loi_vattu;\r\n                \r\n            }\r\n            var input = list_stage[0].Number_Of_Input;\r\n            var tile_loi_vatu = input!=0?(parseInt(sum_loi_vattu)*100/input).toFixed(2):0\r\n            data.labels.push(\"Hợp cách\");\r\n            data.labels.push(\"Còn lại\");\r\n            var hopcach = (100-tile_loi_vatu).toFixed(2);\r\n            data.datasets[0].data.push(hopcach);\r\n            data.datasets[0].data.push(tile_loi_vatu);\r\n        }\r\n        \r\n        //data.datasets[0].data.push(2);\r\n    }\r\n    self.ctx.chart.update();\r\n\r\n\r\n}\r\n\r\nself.onResize = function () {\r\n    self.ctx.chart.resize();\r\n}",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"Hopcach\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "multi_series_pie323",
      "name": "char_stage_err",
      "descriptor": {
        "type": "latest",
        "sizeX": 9,
        "sizeY": 8.5,
        "resources": [
          {
            "url": "https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js",
            "isModule": false
          },
          {
            "url": "https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
          }
        ],
        "templateHtml": "<canvas id=\"pieChart001\"></canvas>",
        "templateCss": "",
        "controllerScript": "let data;\r\n//let config\r\n//var list_stage;\r\n    // $.getScript('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js', function(jd) {\r\n    //     $.getScript('https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js');\r\n    // });\r\n\r\nself.onInit = function () {\r\n    // $.getScript('https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js', function(jd) {\r\n    //     $.getScript('https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/0.6.0/chartjs-plugin-datalabels.min.js');\r\n    // });\r\n    \r\n    var partData = self.ctx.data;\r\n    data = {\r\n        labels: [\r\n\r\n        ],\r\n        datasets: [{\r\n            label: 'Dữ liệu đầu vào',\r\n            data: [],\r\n            datalabels: {\r\n                color: '#000000'\r\n            },\r\n        backgroundColor: [\r\n        \"#f38b4a\",\r\n        \"#56d798\",\r\n        \"#ff8397\",\r\n        \"#6970d5\", \"#FFFF00\", \"#FF00FF\", \"#F0F0F0\"\r\n        ],\r\n            hoverOffset: 4\r\n        }]\r\n    };\r\n     if (partData[0].data.length > 0) {\r\n         var list_stage = JSON.parse(partData[0].data[0][1]);\r\n    //     console.log(\"list_stage\",list_stage);\r\n\r\n         if (list_stage != \"\") {\r\n             for (var i = 0; i < list_stage.length; i++) {\r\n                 data.labels.push(list_stage[i].stage_name);\r\n             }\r\n         }\r\n     }\r\n    //             let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n    //             let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n    //             data.datasets[0].data.push(value);\r\n    //         }\r\n    //     }\r\n    // }\r\n\r\n    // var options = {\r\n    //     responsive: false,\r\n    //     maintainAspectRatio: false,\r\n    //     title: {\r\n    //         display: true,\r\n    //         text: 'Test title',\r\n    //         position: 'top',\r\n    //         fontSize: 16,\r\n    //         fontColor: '#111',\r\n    //         padding: 20\r\n    //     },\r\n    //     legend: {\r\n    //         display: true,\r\n    //         position: 'top',\r\n    //         labels: {\r\n    //             boxWidth:20,\r\n    //             fontColor: '#000000',\r\n    //             padding: 10\r\n    //         }\r\n    //     },\r\n    //     tooltips: {\r\n    //         enabled: true\r\n    //     },\r\n    //     plugins: {\r\n    //         datalabels: {\r\n    //             color: '#000000',\r\n    //             display: true, \r\n    //             formatter: function (value, ctx) {\r\n    //               let sum = 0;\r\n    //               let dataArr = ctx.chart.data.datasets[0].data;\r\n    //               dataArr.map(data => {\r\n    //                   sum += data;\r\n    //               });\r\n    //               if(sum > 0) {\r\n    //                   return (value*100 / sum).toFixed(2)+\"%\";\r\n    //               }\r\n    //               return '0%';\r\n\r\n    //             }\r\n    //         }\r\n    //     }\r\n    // }\r\n\t var options= {\r\n      responsive: false,\r\n      maintainAspectRatio: false,\r\n      plugins: {\r\n        labels: {\r\n          render: 'percentage',\r\n          fontColor: ['green', 'white', 'red'],\r\n          precision: 2\r\n        }\r\n      }\r\n\t }\r\n    //huong add end\r\n    var config = {\r\n        type: 'doughnut',\r\n        data: data,\r\n        plugins: [ChartDataLabels],\r\n        options: options\r\n\r\n    };\r\n    var ctx = $('#pieChart001', self.ctx.$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n    // setInterval(function () {\r\n    //     console.log(\"interval_err\", \"interval_err = 2000\");\r\n    //     chart_data();\r\n    //     self.ctx.chart.update();\r\n    // }, 2000);\r\nfunction chart_data(){\r\n\r\n    // var partData = self.ctx.data;\r\n    //     if (partData[0].data.length > 0) {\r\n    //     var list_stage = JSON.parse(partData[0].data[0][1]);\r\n    //     console.log(\"list_stage\",list_stage);\r\n    //     if (list_stage != \"\") {\r\n            for (var i = 0; i < 5; i++) {\r\n                // data.labels[i]=(list_stage[i].stage_name);\r\n                // var value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                // var common_err = list_stage[i].Number_Of_Error?parseInt(list_stage[i].Number_Of_Error):0\r\n                // var value = (common_err)+value_hmi_err\r\n                // data.datasets[0].data[i] = value;\r\n                data.labels[i] = i;\r\n                data.datasets[0].data[i]=i;\r\n            }\r\n       // }\r\n    //}\r\n}\r\nself.onDataUpdated = function () {\r\n    data.labels = []; \r\n    data.datasets[0].data = [];\r\n    data.datasets[0].backgroundColor = [\"#f38b4a\",\r\n        \"#56d798\",\r\n        \"#ff8397\",\r\n        \"#6970d5\", \"#FFFF00\", \"#FF00FF\", \"#F0F0F0\"];\r\n    const partData = self.ctx.data\r\n    if (partData[0].data.length > 0) {\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n        if (list_stage != \"\") {\r\n            for (var i = 0; i < list_stage.length; i++) {\r\n                //data.labels[i]=(list_stage[i].stage_name);\r\n                let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n                data.datasets[0].data[i] = value;\r\n            }\r\n        }\r\n    }\r\n    console.log(\"update\");\r\n    //chart_data();\r\n    self.ctx.chart.update();\r\n\r\n}\r\n\r\nself.onResize = function () {\r\n    self.ctx.chart.resize();\r\n}\r\nself.onDestroy = function () {\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"borderWidth\": {\n                \"title\": \"Border width\",\n                \"type\": \"number\",\n                \"default\": 5\n            },\n            \"borderColor\": {\n                \"title\": \"Border color\",\n                \"type\": \"string\",\n                \"default\": \"#fff\"\n            },\n            \"legend\": {\n                \"title\": \"Legend settings\",\n                \"type\": \"object\",\n                \"properties\": {\n                    \"display\": {\n                        \"title\": \"Display legend\",\n                        \"type\": \"boolean\",\n                        \"default\": true\n                    },\n                    \"labelsFontColor\": {\n                        \"title\": \"Labels font color\",\n                        \"type\": \"string\",\n                        \"default\": \"#666\"\n                    }\n                }\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"borderWidth\", \n        {\n            \"key\": \"borderColor\",\n            \"type\": \"color\"\n        }, \n        {\n            \"key\": \"legend\",\n            \"items\": [\n                \"legend.display\",\n                {\n                    \"key\": \"legend.labelsFontColor\",\n                    \"type\": \"color\"\n                }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#26a69a\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#f57c00\",\"settings\":{},\"_hash\":0.545701115289893,\"funcBody\":\"var value = (prevValue-20) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+20;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Third\",\"color\":\"#afb42b\",\"settings\":{},\"_hash\":0.2592906835158064,\"funcBody\":\"var value = (prevValue-40) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+40;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Fourth\",\"color\":\"#673ab7\",\"settings\":{},\"_hash\":0.12880275585455747,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"borderWidth\":5,\"borderColor\":\"#fff\",\"legend\":{\"display\":true,\"labelsFontColor\":\"#666666\"}},\"title\":\"char_stage_err\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400}}"
      },
      "image": "data:image/png;base64,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",
      "description": "Displays latest values of the attributes or timeseries data for multiple entities in a doughnut chart. Supports numeric values only."
    },
    {
      "alias": "gauge_4",
      "name": "chart_thoigian_gause",
      "descriptor": {
        "type": "latest",
        "sizeX": 7,
        "sizeY": 7.5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"
          }
        ],
        "templateHtml": "<div id=\"echart\" style=\"width:800px; height:500px;\"></div>",
        "templateCss": "\n#echart\n{\n\n  margin-left: 10rem;\n}",
        "controllerScript": "//https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js\r\nvar gaugeData = [];\r\nvar list_stage;\r\nvar interval = 1000;\r\nfunction chart_data() {\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        list_stage = JSON.parse(partData[0].data[0][1]);\r\n        //console.log(\"list_stage\", list_stage);\r\n        var numberOfOutput = list_stage[list_stage.length - 1].Number_Of_Output ? list_stage[list_stage.length - 1].Number_Of_Output : 0\r\n        console.log(\"numberOfOutput\", numberOfOutput)\r\n        var numberOfPlanning = parseFloat(self.ctx.data[1].data[0][1]) ? parseFloat(self.ctx.data[1].data[0][1]) : 0;\r\n        console.log(\"numberOfPlanning\", numberOfPlanning)\r\n        //tinh toan Running_Time\r\n        var runningTime = parseFloat(self.ctx.data[2].data[0][1]) ? parseFloat(self.ctx.data[2].data[0][1]) : 0;\r\n        console.log(\"runningTime\", runningTime)\r\n        var startTime = parseFloat(self.ctx.data[3].data[0][1]) ? parseFloat(self.ctx.data[3].data[0][1]) : 0;\r\n        runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n        console.log(\"runningTime_2\", runningTime)\r\n        var planningTime = parseFloat(self.ctx.data[4].data[0][1]) ? parseFloat(self.ctx.data[4].data[0][1]) : 0;\r\n        console.log(\"planningTime\", planningTime)\r\n        var percent_ouput = numberOfPlanning ? parseFloat(numberOfOutput) / numberOfPlanning : 0;\r\n        var percent_time = planningTime ? (parseFloat(runningTime) / planningTime) : 0;\r\n        console.log(\"percent_ouput\",percent_ouput);\r\n        console.log(\"percent_time\",percent_time);\r\n        percent_ouput = percent_ouput < 1 ? (percent_ouput*100).toFixed(2) : 100;\r\n        percent_time = percent_time < 1 ? (percent_time*100).toFixed(2) : 100\r\n\r\n        gaugeData[0].value = percent_ouput;\r\n        gaugeData[1].value = percent_time;\r\n        \r\n        //interval = parseInt(self.ctx.data[5].data[0][1]) ? parseInt(self.ctx.data[1].data[0][1]) : 1000;\r\n    } else {\r\n\r\n        gaugeData[0].value = 0;\r\n        gaugeData[1].value = 0;\r\n    }\r\n}\r\nself.onInit = function () {\r\n    //Linhnv10\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        list_stage = JSON.parse(partData[0].data[0][1]);\r\n        console.log(\"list_stage\", list_stage);\r\n    }\r\n    var gaugeData_Kehoach_Element = {\r\n        name: \"Kế hoạch\",\r\n        title: {\r\n            fontSize :30,\r\n            font:'tahoma',\r\n            color :'green',\r\n            offsetCenter: [0 + '%', -40 + 0 * 60 + '%']\r\n        },\r\n        detail: {\r\n            valueAnimation: true,\r\n            offsetCenter: [0 + '%', -20 + 0 * 60 + '%'],\r\n            color :'green'\r\n        }\r\n    }\r\n    var gaugeData_Thoigian_Element = {\r\n        name: \"Thời gian\",\r\n        title: {\r\n            fontSize :30,\r\n            color :'blue',\r\n            font:'tahoma',\r\n            offsetCenter: [0 + '%', -50 + 1 * 60 + '%']\r\n        },\r\n        detail: {\r\n            valueAnimation: true,\r\n            offsetCenter: [0 + '%', -30 + 1 * 60 + '%'],\r\n            color :'blue'\r\n        }\r\n    }\r\n    gaugeData.push(gaugeData_Kehoach_Element);\r\n    gaugeData.push(gaugeData_Thoigian_Element);\r\n\r\n    //End LinhNV10\r\n\r\n\r\n    //tam comment\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n\r\n    //     let gaugeDataElement = {\r\n\r\n\r\n    //         name: self.ctx.data[i].dataKey.label,\r\n    //         title: {\r\n    //             offsetCenter: [0 + '%', -30 + i * 30 + '%']\r\n    //         },\r\n    //         detail: {\r\n    //             valueAnimation: true,\r\n    //             offsetCenter: [0 + '%', -20 + i * 30 + '%']\r\n    //         }\r\n    //     }\r\n\r\n\r\n    //     gaugeData.push(gaugeDataElement);\r\n    // }\r\n    //tam comment\r\n\r\n    draw();\r\n    self.onResize();\r\n}\r\nvar gaugeData = [];\r\n\r\nfunction draw() {\r\n\r\n    var myChart = echarts.init($('#echart', self.ctx.$container)[0]);\r\n\r\n\r\n    var option;\r\n    option = {\r\n        series: [\r\n            {\r\n                type: 'gauge',\r\n                radius: '100%',\r\n                startAngle: 90,\r\n                endAngle: -270,\r\n                min: self.ctx.settings.minValue || 0,\r\n                max: self.ctx.settings.maxValue || 100,\r\n                pointer: {\r\n                    show: false\r\n                },\r\n                color: [\r\n                    'green', 'blue'\r\n\r\n                ],\r\n                progress: {\r\n                    show: true,\r\n                    overlap: false,\r\n                    roundCap: true,\r\n                    clip: false,\r\n                    itemStyle: {\r\n                        borderWidth: 0,\r\n                        borderColor: '#ffffff'\r\n                        //color:'red',\r\n                    }\r\n                },\r\n                axisLine: {\r\n                    lineStyle: {\r\n                        width: 50\r\n                    }\r\n                },\r\n                splitLine: {\r\n                    show: false,\r\n                    distance: 0,\r\n                    length: 15\r\n                },\r\n                axisTick: {\r\n                    show: false\r\n                },\r\n                axisLabel: {\r\n                    show: false,\r\n                    distance: 50\r\n                },\r\n                data: gaugeData,\r\n                title: {\r\n                    fontSize: 50\r\n                },\r\n                detail: {\r\n                    width: 100,\r\n                    height: 30,\r\n                    fontSize: 50,\r\n                    borderColor: 'red',\r\n                    borderRadius: 30,\r\n                    borderWidth: 0,\r\n                    formatter: '{value}' + ((self.ctx.settings.unitValue === undefined) ? '' : self.ctx.settings.unitValue)\r\n                }\r\n            },\r\n\r\n        ]\r\n    };\r\n    \r\n    setInterval(function () {\r\n        console.log(\"interval\",interval);\r\n    chart_data();\r\n      myChart.setOption({\r\n        series: [\r\n          {\r\n            data: gaugeData,\r\n            pointer: {\r\n              show: false\r\n            }\r\n          }\r\n        ]\r\n      });\r\n    }, interval);\r\n    option && myChart.setOption(option);\r\n}\r\n//1- list_stage\r\n//2- numberOfPlanning\r\n//3- runningTime\r\n//4- startTime\r\n//- planningTime\r\nself.onDataUpdated = function () {\r\n    console.log(gaugeData);\r\n    // const partData = self.ctx.data;\r\n    // if (partData[0].data.length > 0) {\r\n    //     list_stage = JSON.parse(partData[0].data[0][1]);\r\n    //     //console.log(\"list_stage\", list_stage);\r\n    //     var numberOfOutput = [list_stage.length - 1].Number_Of_Output ? list_stage[list_stage.length - 1].Number_Of_Output : 0\r\n    //     console.log(\"numberOfOutput\", numberOfOutput)\r\n    //     var numberOfPlanning = parseFloat(self.ctx.data[1].data[0][1]) ? parseFloat(self.ctx.data[1].data[0][1]) : 0;\r\n    //     console.log(\"numberOfPlanning\", numberOfPlanning)\r\n    //     //tinh toan Running_Time\r\n    //     var runningTime = parseFloat(self.ctx.data[2].data[0][1]) ? parseFloat(self.ctx.data[2].data[0][1]) : 0;\r\n    //     console.log(\"runningTime\", runningTime)\r\n    //     var startTime = parseFloat(self.ctx.data[3].data[0][1]) ? parseFloat(self.ctx.data[3].data[0][1]) : 0;\r\n    //     runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n    //     console.log(\"runningTime_2\", runningTime)\r\n    //     var planningTime = parseFloat(self.ctx.data[4].data[0][1]) ? parseFloat(self.ctx.data[4].data[0][1]) : 0;\r\n    //     console.log(\"planningTime\", planningTime)\r\n    //     var percent_ouput = numberOfPlanning ? parseFloat(numberOfOutput) / numberOfPlanning : 0;\r\n    //     var percent_time = planningTime ? (parseFloat(runningTime) / planningTime) : 0;\r\n    //     console.log(\"percent_ouput\",percent_ouput);\r\n    //     console.log(\"percent_time\",percent_time);\r\n    //     percent_ouput = percent_ouput < 1 ? (percent_ouput*100).toFixed(2) : 100;\r\n    //     percent_time = percent_time < 1 ? (percent_time*100).toFixed(2) : 100\r\n\r\n    //     gaugeData[0].value = percent_ouput;\r\n    //     gaugeData[1].value = percent_time;\r\n    // } else {\r\n\r\n    //     gaugeData[0].value = 0;\r\n    //     gaugeData[1].value = 0;\r\n    // }\r\n    //tam comment\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n    //     if (self.ctx.data[i].data[0] != undefined)\r\n    //         gaugeData[i].value = (self.ctx.data[i].data[0][1])\r\n    // }\r\n    chart_data();\r\n    //tam comment\r\n\r\n    draw();\r\n\r\n\r\n}\r\n\r\nself.onResize = function () {\r\n    if (self.ctx.width > self.ctx.height)\r\n        $('#echart', self.ctx.$container)[0].style.zoom = self.ctx.height / 500;\r\n    else\r\n        $('#echart', self.ctx.$container)[0].style.zoom = self.ctx.width / 500;\r\n\r\n    self.ctx.detectChanges();\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"maxValue\": {\n                \"title\": \"Maximum Value\",\n                \"type\": \"number\",\n                \"default\": 100\n            },\n            \"minValue\": {\n                \"title\": \"Minimum Value\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"unitValue\": {\n                \"title\": \"Unit\",\n                \"type\": \"string\",\n                \"default\": \"°C\"\n            }\n        },\n        \"required\": [\"maxValue\",\"unitValue\"]\n    },\n    \"form\": [\n        \"maxValue\",\n        \"minValue\",\n        \"unitValue\"\n       \n            ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random 2\",\"color\":\"#4caf50\",\"settings\":{},\"_hash\":0.3800055415482756,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random 3\",\"color\":\"#f44336\",\"settings\":{},\"_hash\":0.28112084108124735,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"maxValue1\":100,\"unitValue1\":\"°C\",\"maxValue2\":100,\"unitValue2\":\"°C\",\"maxValue3\":100,\"unitValue3\":\"°C\"},\"title\":\"chart_thoigian_gause\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "gauge_42",
      "name": "hopcach_Gauge 4",
      "descriptor": {
        "type": "latest",
        "sizeX": 10.5,
        "sizeY": 7.5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"
          }
        ],
        "templateHtml": "<div id=\"echart\" style=\"width:800px; height:500px;\"></div>",
        "templateCss": "\n\n#echart\n{\n\n  margin-right: -55px;\n}",
        "controllerScript": "//https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js\r\nvar gaugeData = [];\r\nvar list_stage;\r\nvar interval = 1000\r\nvar sum_vatu_err=0;\r\nfunction chart_data() {\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        list_stage = JSON.parse(partData[0].data[0][1]);\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n\r\n        if (list_stage != \"\") {\r\n            // var sum_loi_vattu = 0;\r\n            // for (var i = 0; i < list_stage.length; i++) {\r\n            //     var loi_vattu = list_stage[i].Error_vattu ? parseInt(list_stage[i].Error_vattu) : 0\r\n            //     sum_loi_vattu = sum_loi_vattu + loi_vattu;\r\n\r\n            // }\r\n            // var input = list_stage[0].Number_Of_Input;\r\n            // var tile_loi_vatu = input!=0?parseInt(sum_loi_vattu)*100/input:0;\r\n            // var hopcach = (100-tile_loi_vatu).toFixed(2);\r\n            // hopcach = hopcach>0 ?hopcach:0;\r\n            // console.log(\"hopach_input\",input);\r\n            // console.log(\"hopach_list_stage\",list_stage);\r\n            // gaugeData[0].value = hopcach;\r\n        _data = list_stage;\r\n        json = list_stage;\r\n        sum_vatu_err = 0;\r\n\tfor (let i = 0; i < _data.length; i++) {\r\n\t\tvar vatu = json[i].Error_vattu?parseInt(json[i].Error_vattu):0\r\n\t\tsum_vatu_err = sum_vatu_err+vatu;\r\n\t\t//var detail_err = JSON.parse(json[i].Error_Detail?json[i].Error_Detail:\"[]\");\r\n\t\t//console.log(\"detail_err\",detail_err)\r\n// \t\tfor(let j=0;j<detail_err.length;j++){\r\n// \t\t    if(detail_err.value in )\r\n// \t\t}\r\n\t}\r\n\tvar input = json[0].Number_Of_Input;\r\n\tvar ratioErr_VT;\r\n\t\tif(input!=0){\r\n\t    ratioErr_VT = parseFloat(parseInt(sum_vatu_err)/parseInt(input)*100).toFixed(2);\r\n\t}else{\r\n\t\tratioErr_VT = 0;\r\n\t}\r\n\tgaugeData[0].value = 100-ratioErr_VT;\r\n        }\r\n\r\n        //interval = parseInt(self.ctx.data[5].data[0][1]) ? parseInt(self.ctx.data[1].data[0][1]) : 1000;\r\n    } else {\r\n\r\n        gaugeData[0].value = 0;\r\n    }\r\n}\r\nself.onInit = function () {\r\n    //Linhnv10\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        list_stage = JSON.parse(partData[0].data[0][1]);\r\n        console.log(\"list_stage\", list_stage);\r\n    }\r\n    var gaugeData_hopcach_Element = {\r\n        name: \"Hợp cách\",\r\n        title: {\r\n            fontSize: 30,\r\n            font: 'tahoma',\r\n            color: 'green',\r\n            offsetCenter: [0 + '%', -20 + 0 * 60 + '%']\r\n        },\r\n        detail: {\r\n            valueAnimation: true,\r\n            offsetCenter: [0 + '%', 0 + 0 * 60 + '%'],\r\n            color: 'green'\r\n        }\r\n    }\r\n    gaugeData.push(gaugeData_hopcach_Element);\r\n\r\n    //End LinhNV10\r\n\r\n\r\n    //tam comment\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n\r\n    //     let gaugeDataElement = {\r\n\r\n\r\n    //         name: self.ctx.data[i].dataKey.label,\r\n    //         title: {\r\n    //             offsetCenter: [0 + '%', -30 + i * 30 + '%']\r\n    //         },\r\n    //         detail: {\r\n    //             valueAnimation: true,\r\n    //             offsetCenter: [0 + '%', -20 + i * 30 + '%']\r\n    //         }\r\n    //     }\r\n\r\n\r\n    //     gaugeData.push(gaugeDataElement);\r\n    // }\r\n    //tam comment\r\n\r\n    draw();\r\n    self.onResize();\r\n}\r\nvar gaugeData = [];\r\n\r\nfunction draw() {\r\n\r\n    var myChart = echarts.init($('#echart', self.ctx.$container)[0]);\r\n\r\n\r\n    var option;\r\n    option = {\r\n        series: [\r\n            {\r\n                type: 'gauge',\r\n                radius: '100%',\r\n                startAngle: 90,\r\n                endAngle: -270,\r\n                min: self.ctx.settings.minValue || 0,\r\n                max: self.ctx.settings.maxValue || 100,\r\n                pointer: {\r\n                    show: false\r\n                },\r\n                color: [\r\n                    'green', 'blue'\r\n\r\n                ],\r\n                progress: {\r\n                    show: true,\r\n                    overlap: false,\r\n                    roundCap: true,\r\n                    clip: false,\r\n                    itemStyle: {\r\n                        borderWidth: 0,\r\n                        borderColor: '#ffffff'\r\n                        //color:'red',\r\n                    }\r\n                },\r\n                axisLine: {\r\n                    lineStyle: {\r\n                        width: 50\r\n                    }\r\n                },\r\n                splitLine: {\r\n                    show: false,\r\n                    distance: 0,\r\n                    length: 15\r\n                },\r\n                axisTick: {\r\n                    show: false\r\n                },\r\n                axisLabel: {\r\n                    show: false,\r\n                    distance: 50\r\n                },\r\n                data: gaugeData,\r\n                title: {\r\n                    fontSize: 50\r\n                },\r\n                detail: {\r\n                    width: 100,\r\n                    height: 30,\r\n                    fontSize: 50,\r\n                    borderColor: 'red',\r\n                    borderRadius: 30,\r\n                    borderWidth: 0,\r\n                    formatter: '{value}' + ((self.ctx.settings.unitValue === undefined) ? '' : self.ctx.settings.unitValue)\r\n                }\r\n            },\r\n\r\n        ]\r\n    };\r\n\r\n    setInterval(function () {\r\n        console.log(\"interval\", interval);\r\n        chart_data();\r\n        myChart.setOption({\r\n            series: [\r\n                {\r\n                    data: gaugeData,\r\n                    pointer: {\r\n                        show: false\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    }, interval);\r\n    option && myChart.setOption(option);\r\n}\r\n//1- list_stage\r\n//2- numberOfPlanning\r\n//3- runningTime\r\n//4- startTime\r\n//- planningTime\r\nself.onDataUpdated = function () {\r\n    console.log(gaugeData);\r\n    // const partData = self.ctx.data;\r\n    // if (partData[0].data.length > 0) {\r\n    //     list_stage = JSON.parse(partData[0].data[0][1]);\r\n    //     //console.log(\"list_stage\", list_stage);\r\n    //     var numberOfOutput = [list_stage.length - 1].Number_Of_Output ? list_stage[list_stage.length - 1].Number_Of_Output : 0\r\n    //     console.log(\"numberOfOutput\", numberOfOutput)\r\n    //     var numberOfPlanning = parseFloat(self.ctx.data[1].data[0][1]) ? parseFloat(self.ctx.data[1].data[0][1]) : 0;\r\n    //     console.log(\"numberOfPlanning\", numberOfPlanning)\r\n    //     //tinh toan Running_Time\r\n    //     var runningTime = parseFloat(self.ctx.data[2].data[0][1]) ? parseFloat(self.ctx.data[2].data[0][1]) : 0;\r\n    //     console.log(\"runningTime\", runningTime)\r\n    //     var startTime = parseFloat(self.ctx.data[3].data[0][1]) ? parseFloat(self.ctx.data[3].data[0][1]) : 0;\r\n    //     runningTime = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n    //     console.log(\"runningTime_2\", runningTime)\r\n    //     var planningTime = parseFloat(self.ctx.data[4].data[0][1]) ? parseFloat(self.ctx.data[4].data[0][1]) : 0;\r\n    //     console.log(\"planningTime\", planningTime)\r\n    //     var percent_ouput = numberOfPlanning ? parseFloat(numberOfOutput) / numberOfPlanning : 0;\r\n    //     var percent_time = planningTime ? (parseFloat(runningTime) / planningTime) : 0;\r\n    //     console.log(\"percent_ouput\",percent_ouput);\r\n    //     console.log(\"percent_time\",percent_time);\r\n    //     percent_ouput = percent_ouput < 1 ? (percent_ouput*100).toFixed(2) : 100;\r\n    //     percent_time = percent_time < 1 ? (percent_time*100).toFixed(2) : 100\r\n\r\n    //     gaugeData[0].value = percent_ouput;\r\n    //     gaugeData[1].value = percent_time;\r\n    // } else {\r\n\r\n    //     gaugeData[0].value = 0;\r\n    //     gaugeData[1].value = 0;\r\n    // }\r\n    //tam comment\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n    //     if (self.ctx.data[i].data[0] != undefined)\r\n    //         gaugeData[i].value = (self.ctx.data[i].data[0][1])\r\n    // }\r\n    chart_data();\r\n    //tam comment\r\n\r\n    draw();\r\n\r\n\r\n}\r\n\r\nself.onResize = function () {\r\n    if (self.ctx.width > self.ctx.height)\r\n        $('#echart', self.ctx.$container)[0].style.zoom = self.ctx.height / 500;\r\n    else\r\n        $('#echart', self.ctx.$container)[0].style.zoom = self.ctx.width / 500;\r\n\r\n    self.ctx.detectChanges();\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"maxValue\": {\n                \"title\": \"Maximum Value\",\n                \"type\": \"number\",\n                \"default\": 100\n            },\n            \"minValue\": {\n                \"title\": \"Minimum Value\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"unitValue\": {\n                \"title\": \"Unit\",\n                \"type\": \"string\",\n                \"default\": \"°C\"\n            }\n        },\n        \"required\": [\"maxValue\",\"unitValue\"]\n    },\n    \"form\": [\n        \"maxValue\",\n        \"minValue\",\n        \"unitValue\"\n       \n            ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random 2\",\"color\":\"#4caf50\",\"settings\":{},\"_hash\":0.3800055415482756,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random 3\",\"color\":\"#f44336\",\"settings\":{},\"_hash\":0.28112084108124735,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"maxValue1\":100,\"unitValue1\":\"°C\",\"maxValue2\":100,\"unitValue2\":\"°C\",\"maxValue3\":100,\"unitValue3\":\"°C\"},\"title\":\"hopcach_Gauge 4\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "gauge_1",
      "name": "Gauge1_PPM",
      "descriptor": {
        "type": "latest",
        "sizeX": 9,
        "sizeY": 8,
        "resources": [
          {
            "url": "https://www.gstatic.com/charts/loader.js"
          }
        ],
        "templateHtml": "\r\n       <div id=\"chart_div\"></div>",
        "templateCss": "\n#container{\n\n}\n\n#chart_div {\n\n      display: flex;\n  flex-flow: row wrap;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n \n}",
        "controllerScript": "var data;\nvar options;\nvar chart;\nself.onInit = function() {\n    var settings = self.ctx.settings;\n      google.charts.load('current', {'packages':['gauge']});\n      google.charts.setOnLoadCallback(drawChart);\n\n      function drawChart() {\n\n        data = google.visualization.arrayToDataTable([\n          ['Label', 'Value'],\n          [settings.description || \"PPM.\", 0]\n        ]);\n\n        options = {\n          width: self.ctx.width, height: self.ctx.height,\n          min: settings.minValue || 0, max: settings.maxValue,\n          greenFrom: settings.greenStart, greenTo: settings.greenEnd,\n          redFrom: settings.redStart, redTo: settings.redEnd,\n          yellowFrom:settings.yellowStart, yellowTo: settings.yellowEnd,\n          minorTicks: 5\n        };\n\n        chart = new google.visualization.Gauge($('#chart_div', self.ctx.$container)[0]);\n\n        chart.draw(data, options);\n        \n        self.onDataUpdated();\n\n        \n      }\n}\n\nself.onDataUpdated = function() {\n    var settings = self.ctx.settings;\n    var value = 0;\n    console.log (self.ctx);\n    const partData = self.ctx.data;\n    var sum_err = 0;\n    if (partData[0].data.length > 0)\n    {\n        var list_stage = JSON.parse(partData[0].data[0][1]);\n        \tfor (let i = 0; i < list_stage.length; i++) {\n\t    var hmi_eror = list_stage[i].Number_Of_Hmi_Error?list_stage[i].Number_Of_Hmi_Error:0\n\t\tsum_err =sum_err + parseInt(list_stage[i].Number_Of_Error)+ parseInt(hmi_eror);\n\t}\n\tvar quota = self.ctx.data[1].data[0][1]?self.ctx.data[1].data[0][1]:0;\n    var input = json[0].Number_Of_Input;\n    if(input>0&&quota>0){\n        \n        console.log(\"input\",input);\n        console.log(\"quota\",quota);\nvar ppm = parseFloat(1000000*parseInt(sum_err)/parseInt(input)/parseFloat(quota)).toFixed(2);\nconsole.log(\"ppm\",ppm);\n     value = ppm;\n    }else{\n        value = 0;\n    }\n        //if (self.ctx.data[0].data.length > 0)\n        //value = 100;\n        //console.log (value);\n\n      \n        }\n    \n        \n        if (data !=undefined)\n        {\n            console.log (value);\n            data.setValue(0, 1, value);\n            chart.draw(data, options);\n        }\n}\n\nself.onResize = function() {\n    //if (options != undefined)\n    //{\n    //options.width = self.ctx.width;\n    //options.height = self.ctx.height;\n    //}\n    //$('#chart_div', self.ctx.$container)[0].style.marginLeft = -200 + self.ctx.width/2 + \"px\";\n    \n    \n    //if (chart != undefined)\n   //chart.draw(data, options);\n   self.onInit();\n}\n\nself.onDestroy = function() {\n}\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"description\": {\n                \"title\": \"Description\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n            \"maxValue\": {\n                \"title\": \"Maximum Value\",\n                \"type\": \"number\",\n                \"default\": 100\n            },\n            \"minValue\": {\n                \"title\": \"Minimum Value\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"greenStart\": {\n                \"title\": \"Start green area\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"greenEnd\": {\n                \"title\": \"End green area\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"yellowStart\": {\n                \"title\": \"Start Yellow area\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"yellowEnd\": {\n                \"title\": \"End Yellow area\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"redStart\": {\n                \"title\": \"Start Red area\",\n                \"type\": \"number\",\n                \"default\": 0\n            },\n            \"redEnd\": {\n                \"title\": \"End Red area\",\n                \"type\": \"number\",\n                \"default\": 0\n            }\n            \n        },\n        \"required\": [\"maxValue\"]\n    },\n    \"form\": [\n        \"description\",\n        \"maxValue\",\n        \"minValue\",\n        \"greenStart\",\n        \"greenEnd\",\n        \"yellowStart\",\n        \"yellowEnd\",\n        \"redStart\",\n        \"redEnd\"\n            ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = Math.random() * 100;\\nreturn value;\",\"units\":null,\"decimals\":null,\"usePostProcessing\":null,\"postFuncBody\":null}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"Gauge1_PPM\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "doughnut_chart_js3",
      "name": "ecyber_nhietdo_3vung",
      "descriptor": {
        "type": "latest",
        "sizeX": 9.5,
        "sizeY": 6.5,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
          }
        ],
        "templateHtml": "\n\n\n            <canvas id=\"lineArea\"></canvas>\n",
        "templateCss": ".chart-container {\n  /*overflow-y: scroll;*/\n}\n",
        "controllerScript": "let data;\r\nself.onInit = function() {\r\n    // var demo = $('#demo', self.ctx.$container);\r\n    //console.log(\"Self.ctx: \", self.ctx);\r\n    const labels = [\r\n        'Vùng 1',\r\n        'Vùng 2',\r\n        'Vùng 3'\r\n    ];\r\n    data = {\r\n        labels: labels,\r\n        datasets: [{\r\n                label: 'Nhiệt độ đo',\r\n                //backgroundColor: 'rgb(24, 176, 35)',\r\n                borderColor: 'rgb(24, 176, 35)',\r\n                data: [],\r\n            },\r\n            {\r\n                label: 'Nhiệt độ tiêu chuẩn',\r\n                //backgroundColor: 'rgb(255, 0, 0)',\r\n                borderColor: 'rgb(255, 0, 0)',\r\n                data: []\r\n            }\r\n        ]\r\n    };\r\n\r\n    console.log(\"DAtaset: \", data.datasets[0].data);\r\n\r\n    // const config = {\r\n    //     type: 'line',\r\n    //     data: data,\r\n    //     options: {\r\n    //         maintainAspectRatio: false,\r\n    //         responsive: false\r\n    //     }\r\n    // };\r\n    const config = {\r\n        type: 'line',\r\n        data: data,\r\n        options: {\r\n          responsive: true,\r\n          interaction: {\r\n            mode: 'index',\r\n            intersect: false,\r\n          },\r\n          stacked: false,\r\n          plugins: {\r\n            title: {\r\n              display: true,\r\n              text: 'Chart.js Line Chart - Multi Axis'\r\n            }\r\n          },\r\n          scales: {\r\n            y: {\r\n              type: 'linear',\r\n              display: true,\r\n              position: 'left',\r\n            },\r\n            y1: {\r\n              type: 'linear',\r\n              display: true,\r\n              position: 'right',\r\n      \r\n              // grid line settings\r\n              grid: {\r\n                drawOnChartArea: false, // only want the grid lines for one axis to show up\r\n              },\r\n            },\r\n          }\r\n        },\r\n      };\r\n    var ctx = $('#lineArea', self.ctx.$container);\r\n    self.ctx.chart = new Chart(ctx, config);\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function() {\r\n    var data1 = [];\r\n    var data2 = [];\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        //list_stage = JSON.parse(partData[0].data[0][1]);\r\n        var PreH_A = parseFloat(partData[0].data[0][1]).toFixed(2);\r\n        var PreH_B = parseFloat(partData[1].data[0][1]).toFixed(2);\r\n        var PreH_C = parseFloat(partData[2].data[0][1]).toFixed(2);\r\n        var Set_PreH_A = parseFloat(partData[3].data[0][1]).toFixed(2);\r\n        var Set_PreH_B = parseFloat(partData[4].data[0][1]).toFixed(2);\r\n        var Set_PreH_C = parseFloat(partData[5].data[0][1]).toFixed(2);\r\n        data.datasets[0].data[0] = PreH_A;\r\n        data.datasets[0].data[1] = PreH_B;\r\n        data.datasets[0].data[2] = PreH_C;\r\n        data.datasets[1].data[0] = Set_PreH_A;\r\n        data.datasets[1].data[1] = Set_PreH_B;\r\n        data.datasets[1].data[2] = Set_PreH_C;\r\n    }else{\r\n        data.datasets[0].data[0] = 0;\r\n        data.datasets[0].data[1] = 0;\r\n        data.datasets[0].data[2] = 0;\r\n        data.datasets[1].data[0] = 0;\r\n        data.datasets[1].data[1] = 0;\r\n        data.datasets[1].data[2] = 0;\r\n    }\r\n\r\n\r\n    self.ctx.chart.update();\r\n}\r\n// self.onDataUpdated = function() {\r\n//     self.ctx.flot.update();\r\n// }\r\n\r\nself.onResize = function() {\r\n    // self.ctx.flot.resize();\r\n    self.ctx.chart.resize();\r\n}\r\n\r\n// self.onEditModeChanged = function() {\r\n//     self.ctx.flot.checkMouseEvents();\r\n// }\r\n\r\n// self.getSettingsSchema = function() {\r\n//     return TbFlot.settingsSchema('graph');\r\n// }\r\n\r\n// self.getDataKeySettingsSchema = function() {\r\n//     return TbFlot.datakeySettingsSchema(true, 'graph');\r\n// }\r\n\r\nself.onDestroy = function() {\r\n    // self.ctx.flot.destroy();\r\n    self.ctx.chart.destroy();\r\n}",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"borderWidth\": {\n                \"type\": \"number\",\n                \"default\": 5\n            },\n            \"borderColor\": {\n                \"title\": \"Border color\",\n                \"type\": \"string\",\n                \"default\": \"#fff\"\n            },\n            \"legend\": {\n                \"title\": \"Legend settings\",\n                \"type\": \"object\",\n                \"properties\": {\n                    \"display\": {\n                        \"title\": \"Display legend\",\n                        \"type\": \"boolean\",\n                        \"default\": true\n                    },\n                    \"labelsFontColor\": {\n                        \"title\": \"Labels font color\",\n                        \"type\": \"string\",\n                        \"default\": \"#666\"\n                    }\n                }\n            }\n        },\n        \"required\": []\n    },\n    \"form\": [\n        \"borderWidth\", \n        {\n            \"key\": \"borderColor\",\n            \"type\": \"color\"\n        }, \n        {\n            \"key\": \"legend\",\n            \"items\": [\n                \"legend.display\",\n                {\n                    \"key\": \"legend.labelsFontColor\",\n                    \"type\": \"color\"\n                }\n            ]\n        }\n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#26a69a\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#f57c00\",\"settings\":{},\"_hash\":0.545701115289893,\"funcBody\":\"var value = (prevValue-20) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+20;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Third\",\"color\":\"#afb42b\",\"settings\":{},\"_hash\":0.2592906835158064,\"funcBody\":\"var value = (prevValue-40) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+40;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Fourth\",\"color\":\"#673ab7\",\"settings\":{},\"_hash\":0.12880275585455747,\"funcBody\":\"var value = (prevValue-50) + Math.random() * 2 - 1;\\nif (value < 0) {\\n\\tvalue = 0;\\n} else if (value > 100) {\\n\\tvalue = 100;\\n}\\nreturn value+50;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"borderWidth\":5,\"borderColor\":\"#fff\",\"legend\":{\"display\":true,\"labelsFontColor\":\"#666666\"}},\"title\":\"ecyber_nhietdo_3vung\",\"dropShadow\":true,\"enableFullscreen\":true,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400}}"
      },
      "image": "data:image/png;base64,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",
      "description": "Displays latest values of the attributes or timeseries data for multiple entities in a doughnut chart. Supports numeric values only."
    },
    {
      "alias": "test_demo",
      "name": "err_stage_echart",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"
          }
        ],
        "templateHtml": " <div id=\"chart\" style=\"width:500px; height:500px;\"></div>",
        "templateCss": ".body {\r\n  height: 100%; margin: 0\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n#chart {\r\n  height: 500px;\r\n  width: 500px;\r\n}",
        "controllerScript": "//https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js\r\nvar gaugeData = [];\r\nvar legendData= [];\r\nvar list_stage;\r\nfunction chart_data() {\r\n    gaugeData = [];\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        \r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n        console.log(\"vao day roi\",list_stage);\r\n        if (list_stage != \"\") {\r\n            for (var i = 0; i < list_stage.length; i++) {\r\n                //data.labels[i]=(list_stage[i].stage_name);\r\n                let value_hmi_err = list_stage[i].Number_Of_Hmi_Error?parseInt(list_stage[i].Number_Of_Hmi_Error):0\r\n                let value = parseInt(list_stage[i].Number_Of_Error)+value_hmi_err\r\n            var element = {value: 0, name: ''};\r\n            element.name =(list_stage[i].stage_name);\r\n            element.value = value;\r\n            legendData[i] = list_stage[i].stage_name;\r\n            console.log(\"element\",element)\r\n            //if(value>0){\r\n            gaugeData[i] = element;\r\n           // }\r\n            }\r\n\r\n        }\r\n         console.log(\"gaugeData\",gaugeData);\r\n    } else {\r\n\r\n        gaugeData = [];\r\n    }\r\n}\r\nself.onInit = function () {\r\n    //Linhnv10\r\n    // const partData = self.ctx.data;\r\n    // if (partData[0].data.length > 0) {\r\n    //     list_stage = JSON.parse(partData[0].data[0][1]);\r\n    //     console.log(\"list_stage\", list_stage);\r\n    // }\r\n    // var gaugeData_hopcach_Element = {\r\n    //     name: \"Hợp cách\",\r\n    //     title: {\r\n    //         fontSize: 30,\r\n    //         font: 'tahoma',\r\n    //         color: 'green',\r\n    //         offsetCenter: [0 + '%', -20 + 0 * 60 + '%']\r\n    //     },\r\n    //     detail: {\r\n    //         valueAnimation: true,\r\n    //         offsetCenter: [0 + '%', 0 + 0 * 60 + '%'],\r\n    //         color: 'green'\r\n    //     }\r\n    // }\r\n    // gaugeData.push(gaugeData_hopcach_Element);\r\n\r\n    //End LinhNV10\r\n\r\n\r\n    //tam comment\r\n    // for (var i = 0; i < self.ctx.data.length; i++) {\r\n\r\n    //     let gaugeDataElement = {\r\n\r\n\r\n    //         name: self.ctx.data[i].dataKey.label,\r\n    //         title: {\r\n    //             offsetCenter: [0 + '%', -30 + i * 30 + '%']\r\n    //         },\r\n    //         detail: {\r\n    //             valueAnimation: true,\r\n    //             offsetCenter: [0 + '%', -20 + i * 30 + '%']\r\n    //         }\r\n    //     }\r\n\r\n\r\n    //     gaugeData.push(gaugeDataElement);\r\n    // }\r\n    //tam comment\r\n    var element = {value: 0, name: ''};\r\n    draw();\r\n    self.onResize();\r\n}\r\n//var gaugeData = [];\r\n\r\nfunction draw() {\r\n\r\nvar dom = document.getElementById(\"chart\");\r\nvar myChart = echarts.init(dom);\r\nvar app = {};\r\noption = null;\r\nchart_data();\r\noption = {\r\n    title: {\r\n        show: false,\r\n        text: 'EChart Pie',\r\n        subtext: 'Tỉ lệ lỗi công đoạn',\r\n        left: 'center'\r\n    },\r\n    tooltip: {\r\n        trigger: 'item',\r\n        formatter: '{a} <br/>{b} : {c} ({d}%)'\r\n    },\r\n    legend: {\r\n        // orient: 'vertical',\r\n        // top: 'middle',\r\n        show: true,\r\n        bottom: 4,\r\n        color :'white',\r\n        left: 'center',\r\n        data: legendData\r\n    },\r\n    series: [\r\n        {\r\n          name: \"Tỉ lệ\",  \r\n          type: 'pie',\r\n        color: ['green','red','blue','yellow','violet','cyan'\r\n  //[\"#ff8337\",\"53afff\",\"de6fff\",\"ffe272\",\"ff74bc\",\"9de16f\",\"ff3737\"\r\n        ],\r\n            radius: '90%',\r\n            center: ['50%', '50%'],\r\n            selectedMode: 'single',\r\n            data: gaugeData,\r\n            // [\r\n            //     {value: 15, name: 'Drama'},\r\n            //     {value: 30, name: 'Scifi'},\r\n            //     {value: 16, name: 'Crime'},\r\n            //     {value: 3, name: 'Horror'}\r\n            // ],\r\n            emphasis: {\r\n                itemStyle: {\r\n                    shadowBlur: 10,\r\n                    shadowOffsetX: 0,\r\n                    shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n                }\r\n            },\r\n            label: {\r\n                // color: ['white','white','white','white','white','white','white','white'],\r\n                // fontSize :60,\r\n                normal: {\r\n                    //formatter: '{b} : {c}',\r\n                    formatter: '{b} ({d}%)',\r\n                    position: 'inside', //inside\r\n                    fontSize :20,\r\n                    color:'white',\r\n                    center:'center'\r\n                }\r\n            },\r\n        }\r\n    ]\r\n};\r\n\r\nif (option && typeof option === \"object\") {\r\n    myChart.setOption(option, true);\r\n}\r\n   // option && myChart.setOption(option);\r\n}\r\n//1- list_stage\r\n//2- numberOfPlanning\r\n//3- runningTime\r\n//4- startTime\r\n//- planningTime\r\nself.onDataUpdated = function () {\r\n    //chart_data();\r\n    draw();\r\n}\r\n\r\nself.onResize = function () {\r\n     if (self.ctx.width > self.ctx.height)\r\n         $('#chart', self.ctx.$container)[0].style.zoom = self.ctx.height / 500;\r\n     else\r\n         $('#chart', self.ctx.$container)[0].style.zoom = self.ctx.width / 500;\r\n\r\n    self.ctx.detectChanges();\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"err_stage_echart\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "bar_line_echart",
      "name": "bar_line_echart",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"
          }
        ],
        "templateHtml": "<div class = \"div_xxx\" id=\"line_bar_chart\" style=\"width:600px; height:200px;\"></div>",
        "templateCss": ".div_xxx{\n  position: relative;\n  left: auto;\n  width: auto;\n  margin-left: 10%;\n}",
        "controllerScript": "//https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js\r\nvar barData = [];\r\nvar lineData = [];\r\nvar legendData= [\"Sản lượng\",\"Năng suất\"];\r\nvar xAxisData = [];\r\nvar list_stage;\r\nvar test_productivity = [{\"Time\":1,\"Avg_Productivity\":0},{\"Time\":1,\"Avg_Productivity\":0},{\"Time\":2,\"Avg_Productivity\":0},{\"Time\":3,\"Avg_Productivity\":0},{\"Time\":4,\"Avg_Productivity\":7168},{\"Time\":5,\"Avg_Productivity\":0},{\"Time\":6,\"Avg_Productivity\":1792},{\"Time\":7,\"Avg_Productivity\":60},{\"Time\":8,\"Avg_Productivity\":0},{\"Time\":9,\"Avg_Productivity\":0},{\"Time\":10,\"Avg_Productivity\":0},{\"Time\":11,\"Avg_Productivity\":50},{\"Time\":12,\"Avg_Productivity\":0}];\r\nfunction chart_data() {\r\n    var partData = self.ctx.data;\r\n        if (partData[0].data.length > 0) {\r\n        var json_parse = partData[0]?partData[0].data[0][1]:test_productivity;\r\n        avarage_productivity = JSON.parse(json_parse);\r\n        //test_productivity\r\n        //avarage_productivity = test_productivity\r\n        //end\r\n        console.log(\"avarage_productivity\",avarage_productivity);\r\n            for(i=0;i<avarage_productivity.length;i++){\r\n        var v = avarage_productivity[i];\r\n        var normal_productivity = partData[1]?partData[1].data[0][1]:0\r\n        //var normal_productivity = 100;\r\n        //data.labels.push(v.Time);\r\n        //data.datasets[1].data.push(v.Avg_Productivity)\r\n        //data.datasets[0].data.push(normal_productivity);\r\n        xAxisData[i] = v.Time;\r\n        lineData[i] = normal_productivity;\r\n        barData[i] = v.Avg_Productivity;\r\n    }\r\n        \r\n        \r\n        \r\n        \r\n    }else{\r\n        xAxisData = [];\r\n        lineData = [];\r\n        barData = [];\r\n    }\r\n    \r\n    \r\n    // for(var i=0;i<20;i++){\r\n    //     xAxisData[i] = i+\" :00\";\r\n    //     lineData[i] = 20;\r\n    //     barData[i] = 6+i;\r\n    // }\r\n}\r\nself.onInit = function () {\r\n\r\n    var element = {value: 0, name: ''};\r\n    draw();\r\n    \r\n}\r\n//var gaugeData = [];\r\n\r\nfunction draw() {\r\n\r\nvar dom = document.getElementById(\"line_bar_chart\");\r\nvar myChart = echarts.init(dom);\r\nvar app = {};\r\noption = null;\r\nchart_data();\r\noption = {\r\n    tooltip: {\r\n        trigger: 'axis',\r\n        axisPointer: {\r\n            type: 'cross',\r\n            crossStyle: {\r\n                color: '#999'\r\n            }\r\n        }\r\n    },\r\n    toolbox: {\r\n        feature: {\r\n            dataView: {show: true, readOnly: false},\r\n            magicType: {show: true, type: ['line', 'bar']},\r\n            restore: {show: true},\r\n            saveAsImage: {show: true}\r\n        }\r\n    },\r\n    legend: {\r\n        data: legendData\r\n    },\r\n    xAxis: [\r\n        {\r\n            type: 'category',\r\n            data: xAxisData,\r\n            // axisPointer: {\r\n            //     type: 'shadow'\r\n            // }\r\n        }\r\n    ],\r\n    yAxis: [\r\n        {\r\n            type: 'value',\r\n            name: 'Sản lượng',\r\n            min: 0,\r\n            max: 'auto',\r\n            interval: 'auto',\r\n             axisLabel: {\r\n                 formatter: '{value} sp/gio'\r\n             }\r\n        },\r\n        // {\r\n        //     type: 'value',\r\n        //     name: 'Sản lượng',\r\n        //     min: 0,\r\n        //     max: 25,\r\n        //     interval: 5,\r\n        //     axisLabel: {\r\n        //         formatter: '{value} °C'\r\n        //     }\r\n        // }\r\n    ],\r\n    series: [\r\n        \r\n        {\r\n            name: 'Sản lượng theo giờ',\r\n            type: 'bar',\r\n            data: barData,\r\n            color : 'green'\r\n        },\r\n        {\r\n            name: 'Năng suất trung bình',\r\n            type: 'line',\r\n            yAxisIndex: 0,\r\n            data: lineData,\r\n            color : 'red'\r\n        }\r\n    ]\r\n};\r\n\r\n\r\nif (option && typeof option === \"object\") {\r\n    myChart.setOption(option, true);\r\n}\r\nself.onResize();\r\n   // option && myChart.setOption(option);\r\n}\r\n//1- list_stage\r\n//2- numberOfPlanning\r\n//3- runningTime\r\n//4- startTime\r\n//- planningTime\r\nself.onDataUpdated = function () {\r\n    //chart_data();\r\n    draw();\r\n}\r\n\r\nself.onResize = function () {\r\n    //  if (self.ctx.width > self.ctx.height)\r\n    //      $('#line_bar_chart', self.ctx.$container)[0].style.zoom = self.ctx.height / 500;\r\n    //  else\r\n    //      $('#line_bar_chart', self.ctx.$container)[0].style.zoom = self.ctx.width / 500;\r\n        $('#line_bar_chart', self.ctx.$container)[0].style.height = self.ctx.height + \"px\";\r\n        $('#line_bar_chart', self.ctx.$container)[0].style.width = (self.ctx.width-15) + \"px\";\r\n        $('#line_bar_chart', self.ctx.$container)[0].style.paddingLeft = (5) + \"px\";\r\n        \r\n        //draw();\r\n     self.ctx.detectChanges();\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"bar_line_echart\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "demo_table",
      "name": "demo_table",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"
          }
        ],
        "templateHtml": "<table id=\"dt-select\" class=\"thead-dark\" cellspacing=\"0\" width=\"100%\">\r\n  <thead>\r\n    <tr>\r\n      <th>Mã sản phẩm</th>\r\n      <th>Tên sản phẩm</th>\r\n      <th>Trạng thái</th>\r\n    </tr>\r\n  </thead>\r\n</table>\r\n<div>\r\n   <button id = \"saveButton\" type=\"button\" class=\"btn btn-outline-primary\">Lưu</button>\r\n</div>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}",
        "controllerScript": "\r\nlet $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\n\r\nvar productList= [\r\n    {\r\n      \"productCode\": \"Code_001\",\r\n      \"productName\": \"Name_001\"\r\n    },\r\n    {\r\n      \"productCode\": \"Code_002\",\r\n      \"productName\": \"Name_002\"\r\n    },\r\n    {\r\n      \"productCode\": \"Code_003\",\r\n      \"productName\": \"Name_003\"\r\n    }\r\n  ]\r\n  \r\n                var infoDialogTemplate =\r\n                    `\r\n    <div id=\"exampleModal\">\r\n        <mat-toolbar fxLayout=\"row\" color=\"accent\" >\r\n            <h2>trUNG OI tRUNG</h2>\r\n            <span fxFlex></span>\r\n            <button mat-button mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n                <mat-icon class=\"material-icons\">close</mat-icon>\r\n            </button>\r\n        </mat-toolbar>\r\n        </div>`;\r\n         infoDialogTemplate = '<dialog open>This is an open dialog window</dialog>';\r\n\r\nself.onInit = function() {\r\n    \r\n    $scope = self.ctx.$scope;\r\n        utils = $scope.$injector.get(self.ctx.servicesMap.get(\r\n        'utils'));\r\n    settings = utils.deepClone(self.ctx.settings) || {};\r\n    settings.showLabel = utils.defaultValue(settings\r\n        .showLabel, true);\r\n    settings.showResultMessage = utils.defaultValue(settings\r\n        .showResultMessage, true);\r\n    $scope.settings = settings;\r\n    $scope = self.ctx.$scope;\r\n        customDialog = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('customDialog'));\r\n    var datasource = self.ctx.datasources;\r\n    \r\n    $container = self.ctx.$container;\r\nattributeService = $scope.$injector.get(self.ctx.servicesMap.get('attributeService'));\r\nvar dataSet = [\r\n    [\"SP_CODE_001\",\"SP_NAME_001\",\"Active\"],\r\n    [\"SP_CODE_002\",\"SP_NAME_002\",\"InActive\"],\r\n    [\"SP_CODE_003\",\"SP_NAME_003\",\"Active\"],\r\n    [\"SP_CODE_004\",\"SP_NAME_004\",\"InActive\"]\r\n]\r\n    \r\n\r\n$(document).ready(function () {\r\nvar table = $('#dt-select').DataTable({\r\ndata: dataSet,\r\ncolumns: [{\r\ntitle: \"Mã sản phẩm\"\r\n},\r\n{\r\ntitle: \"Tên sản phẩm\"\r\n},\r\n{\r\ntitle: \"Trạng thái sử dụng\"\r\n}\r\n],\r\n\r\ndom: 'Bfrtip',\r\nselect: true,\r\nbuttons: [{\r\ntext: 'Select all',\r\naction: function () {\r\ntable.rows().select();\r\n}\r\n},\r\n{\r\ntext: 'Select none',\r\naction: function () {\r\ntable.rows().deselect();\r\n}\r\n}\r\n]\r\n});\r\n});\r\n\r\n$( \"#saveButton\" ).click(function() {\r\n    dialog = customDialog.customDialog(\r\n    infoDialogTemplate).subscribe();\r\n    //alert(\"luu lai du lieu\");\r\n    //let attributeTimeSeries = [];\r\n    var product_update = [];\r\n    var list_product = JSON.stringify(dataSet);\r\n    product_update.push({\r\n                key: 'Product_List',\r\n                value: list_product\r\n    });\r\n   // alert(list_product);\r\n    console.log(\"$scope.entityId\",datasource[0].entity.id);\r\n    attributeService.saveEntityAttributes(datasource[0].entity.id, 'SERVER_SCOPE', product_update).subscribe(\r\n                    function success() {\r\n                        console.log(\r\n                            \"Cập nhật trạng thái thành công\"\r\n                        );\r\n                        if (settings\r\n                            .showResultMessage\r\n                        ) {\r\n                            $scope.showSuccessToast(\"Cập nhật thành công\");\r\n                        }\r\n                    },\r\n                    function fail() {\r\n                        if (settings\r\n                            .showResultMessage\r\n                        ) {\r\n                            $scope.showErrorToast(\"Cập nhật thất bại\");\r\n                        }\r\n                    }\r\n                );\r\n    \r\n    \r\n});\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function() {\r\n}\r\n\r\nself.onResize = function() {\r\n   \r\n}\r\n\r\nself.onDestroy = function() {\r\n}\r\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"demo_table\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "demo_table2",
      "name": "talbe_nhom_sp_test",
      "descriptor": {
        "type": "latest",
        "sizeX": 13.5,
        "sizeY": 8,
        "resources": [
          {
            "url": "https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js",
            "isModule": false
          },
          {
            "url": "https://code.jquery.com/jquery-3.3.1.slim.min.js"
          },
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"
          },
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
          }
        ],
        "templateHtml": "<div id=\"modal_update\" class=\"modal\" tabindex=\"-1\" data-bs-backdrop=\"false\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\">Cập nhật</h5>\r\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <div class=\"input-modal\">\r\n                    <label class=\"form-label\">Mã</label>\r\n                    <input type=\"\" id=\"input-code-update\" class=\"form-control\"  placeholder=\"Mã\">\r\n                </div>\r\n                <div class=\"input-modal\">\r\n                    <label class=\"form-label\">Name</label>\r\n                    <input type=\"\" id=\"input-name-update\" class=\"form-control\"  placeholder=\"Code\">\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n                <button type=\"button\" class=\"btn btn-primary\" id=\"submit-update\">Lưu</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n    <div id=\"modal_new\" class=\"modal\" tabindex=\"-1\" data-bs-backdrop=\"false\">\r\n        <div class=\"modal-dialog\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">Thêm mới</h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div class=\"input-modal\">\r\n                        <label class=\"form-label\">Mã</label>\r\n                        <input type=\"\" id=\"input-code\" class=\"form-control\"  placeholder=\"Mã\">\r\n                    </div>\r\n                    <div class=\"input-modal\">\r\n                        <label class=\"form-label\">Name</label>\r\n                        <input type=\"\" id=\"input-name\" class=\"form-control\"  placeholder=\"Code\">\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n                    <button type=\"button\" class=\"btn btn-primary\" id=\"submit\">Lưu</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"main\">\r\n        <div class=\"search\">\r\n            <h4> Kết quả tìm kiếm</h4>\r\n            <div class=\"search-control\">\r\n                <button type=\"button\" data-bs-toggle=\"modal\" data-bs-target=\"#modal_new\" class=\"btn btn-primary\">Thêm mới</button>\r\n                <input type=\"text\" class=\"form-control\" id=\"\" placeholder=\"Search\">\r\n            </div>\r\n        </div>\r\n        <div class=\"result\">\r\n            <table id=\"table\" class=\"table table-striped table-bordered\">\r\n                <thead>\r\n                    <tr>\r\n                        <th  width=\"5%\"><input type=\"checkbox\"></th>\r\n                        <th width=\"5%\" scope=\"col\">STT</th>\r\n                        <th scope=\"col\">Mã</th>\r\n                        <th scope=\"col\">Tên</th>\r\n                        <th  width=\"10%\" scope=\"col\">Trạng thái</th>\r\n                        <th  width=\"10%\" scope=\"col\">Thao tác</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody id=\"result_table\">\r\n\r\n\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n    </div>",
        "templateCss": ".main{\r\n}\r\n.main .result{\r\n    width: 100%;\r\n    margin-top: 2rem;\r\n}\r\n.search{\r\n    margin-top: 2rem;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n}\r\n.search input{\r\n    width: 300px;\r\n    margin: 0 1rem;\r\n}\r\n.search h4 {\r\n    width: 300px;\r\n    margin-left: 1rem;\r\n}\r\n.search .search-control{\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n.action{\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n.action i {\r\n    margin-left: 10px;\r\n}\r\ntr th{\r\n    text-align: center;\r\n}\r\n.status{\r\n    text-align: center;\r\n}\r\ntr td{\r\n    text-align: center;\r\n}\r\n.input-modal{\r\n    margin-top: 10px;\r\n}\r\nbody .modal-backdrop.show {\r\n    display: none !important;\r\n}\r\n\r\ndiv.modal-backdrop.show {\r\n    z-index: -1;\r\n}\r\n",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\n!function(e,d){\"use strict\";d.fn.simpleCheckboxTable=function(t){var c=d.extend({},e,t);return this.each(function(t,e){var n=d(e);n.find(\"thead th:nth-child(1) input[type='checkbox']\").on(\"change\",function(){d(this).is(\":checked\")?n.find(\"tbody td:nth-child(1) input[type='checkbox']:not(:disabled):not(:checked)\").prop(\"checked\",!0).trigger(\"change\"):n.find(\"tbody td:nth-child(1) input[type='checkbox']:not(:disabled):checked\").prop(\"checked\",!1).trigger(\"change\")}).end().find(\"tbody tr\").on(\"click\",function(){var t=d(this).find(\"td:nth-child(1) input[type='checkbox']:not(:disabled)\");t.prop(\"checked\",!t.is(\":checked\")).trigger(\"change\")}).end().find(\"tbody td:nth-child(1) input[type='checkbox']\").on(\"change\",function(){var t=0===d(this).closest(\"tbody\").find(\"td:nth-child(1) input[type='checkbox']:not(:disabled):not(:checked)\").length;n.find(\"thead th:nth-child(1) input[type='checkbox']\").prop(\"checked\",t),c.onCheckedStateChanged.call(n,d(this))}).trigger(\"change\").end().find(\"tbody td a,input[type='checkbox']\").on(\"click\",function(t){t.stopPropagation()}).end()})}}({onCheckedStateChanged:function(){}},jQuery);\r\nopenModalUpdate = function (id) {\r\n        $('#modal_update').modal('show');\r\n        console.log(id)\r\n    }\r\ndel = function del(id) {\r\n        alert(\"Xóa bản ghi id: \"+id+\" thành công\")\r\n    }\r\n  test =  function() {\r\n        alert(\"Test\")\r\n    }\r\nvar productList = [\r\n    {\r\n        \"productCode\": \"Code_001\",\r\n        \"productName\": \"Name_001\"\r\n    },\r\n    {\r\n        \"productCode\": \"Code_002\",\r\n        \"productName\": \"Name_002\"\r\n    },\r\n    {\r\n        \"productCode\": \"Code_003\",\r\n        \"productName\": \"Name_003\"\r\n    }\r\n];\r\n   var data = [\r\n        {\r\n            id: 1,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        },\r\n        {\r\n            id: 2,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : false\r\n        }\r\n        ,\r\n        {\r\n            id: 3,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        },\r\n        {\r\n            id: 4,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : false\r\n        },\r\n        {\r\n            id: 5,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        }\r\n        ,\r\n        {\r\n            id: 6,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        }\r\n        ,\r\n        {\r\n            id: 7,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        },\r\n        {\r\n            id: 8,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        },\r\n        {\r\n            id: 9,\r\n            code:'Code',\r\n            name: 'Name',\r\n            status : true\r\n        }\r\n    ]\r\n    function getData() {\r\n        for(let i=0;i<data.length;i++){\r\n            $('#result_table').append(\r\n                `<tr>\r\n                    <td><input type=\"checkbox\"></td>\r\n                    <td >${i+1}</td>\r\n                    <td>${data[i].code}</td>\r\n                    <td>${data[i].name}</td>\r\n                    <td class=\"status\"><input class=\"form-check-input\" type=\"checkbox\" value=\"\" ${data[i].status?'checked':''}></td>\r\n                    <td>\r\n                        <div class=\"action\">\r\n                            <i title=\"Xóa\" onclick=\"del(${data[i].id})\" class=\"bi bi-trash3\"></i>\r\n                            <i title=\"Cập nhật\" onclick=\"openModalUpdate(${data[i].id})\" class=\"bi bi-pencil-square\"></i>\r\n                           \r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n                `\r\n            )\r\n        }\r\n    }\r\n\r\nself.onInit = function () {\r\n \r\n\r\n        $('#submit').click(function (){\r\n        $('#modal_new').modal('toggle');\r\n        let newData = {\r\n            code: $('#input-code').val() ,\r\n            name:$('#input-name').val(),\r\n            status:\"true\",\r\n        }\r\n        data.push(newData)\r\n        console.log(data)\r\n        $('#result_table').empty();\r\n        $('#input-code').val('');\r\n        $('#input-code').val('')\r\n        getData();\r\n    })\r\n    $('#submit-update').click(function (){\r\n        $('#modal_update').modal('toggle');\r\n        let updateData = {\r\n            code: $('#input-code-update').val() ,\r\n            name:$('#input-name-update').val(),\r\n            status:\"true\",\r\n        }\r\n    })\r\n    getData();\r\n    $(document).ready(function(){\r\n        \r\n        $(\"#table\").simpleCheckboxTable({\r\n            onCheckedStateChanged: function($checkbox) {\r\n                // Do something\r\n                console.log($checkbox)\r\n            }\r\n        });\r\n\r\n    });\r\n   // test();\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n}\r\n\r\nself.onResize = function () {\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"required\": [\"cardHtml\"],\n        \"properties\": {\n            \"cardCss\": {\n                \"title\": \"CSS\",\n                \"type\": \"string\",\n                \"default\": \".card {\\n font-weight: bold; \\n}\"\n            },\n            \"cardHtml\": {\n                \"title\": \"HTML\",\n                \"type\": \"string\",\n                \"default\": \"<div class='card'>HTML code here</div>\"\n            }\n        }\n    },\n    \"form\": [\n        {\n            \"key\": \"cardCss\",\n            \"type\": \"css\"\n        },           \n        {\n            \"key\": \"cardHtml\",\n            \"type\": \"html\"\n        }    \n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"cardCss\":\".card {\\n font-weight: bold; \\n}\",\"cardHtml\":\"<div class='card'>HTML code here</div>\"},\"title\":\"talbe_nhom_sp_test\",\"showTitleIcon\":false,\"iconColor\":\"rgba(100,82,82,0.87)\",\"iconSize\":\"24px\",\"titleTooltip\":\"\",\"dropShadow\":true,\"enableFullscreen\":true,\"widgetStyle\":{},\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"showLegend\":false}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "test_demo2",
      "name": "err_group_stage_echart",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"
          }
        ],
        "templateHtml": " <div id=\"chart_nhom\" style=\"width:500px; height:500px;\"></div>",
        "templateCss": ".body {\r\n  height: 100%; margin: 0\r\n}\r\n\r\n.container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n#chart_nhom {\r\n  height: 500px;\r\n  width: 500px;\r\n}",
        "controllerScript": "//https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js\r\nlet $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\n\r\nvar gaugeData = [];\r\nvar legendData = [];\r\nvar list_stage;\r\nvar err_list;\r\n\r\n\r\nfunction mapping(arrValue, arrGroupName) {\r\n    let arrError = []\r\n    let arrName = []\r\n    let arrErrorAll = []\r\n    //Lấy list danh sách lỗi, danh sách tên group\r\n    for (let n = 0; n < arrGroupName.length; n++){\r\n        let checkExistErr =false;\r\n        checkExistErr = arrError.find(element => {\r\n            if (element.err_key === arrGroupName[n].err_key) {\r\n                return true;\r\n            }\r\n        });\r\n        if(!checkExistErr){\r\n            arrError.push({err_key:arrGroupName[n].err_key,total:0})\r\n        }\r\n        let checkName = false;\r\n        checkName = arrName.find(element => {\r\n            if (element.groupName === arrGroupName[n].groupName) {\r\n                return true;\r\n            }\r\n        });\r\n        if(!checkName){\r\n            arrName.push({groupName:arrGroupName[n].groupName,value:0})\r\n        }\r\n    }\r\n    for (let j = 0; j < arrValue.length; j++) {\r\n        if (arrValue[j]['Error_Detail'] !== undefined) {\r\n            for (let k = 0; k < arrValue[j]['Error_Detail'].length; k++) {\r\n                let checkExistErr =false;\r\n                checkExistErr = arrErrorAll.find(element => {\r\n                    if (element.err_key === arrValue[j]['Error_Detail'][k].err_key) {\r\n                        return true;\r\n                    }\r\n                });\r\n                if(!checkExistErr){\r\n                    arrErrorAll.push({err_key:arrValue[j]['Error_Detail'][k].err_key,total:0})\r\n                }\r\n            }\r\n\r\n        }\r\n        if (arrValue[j]['Error_Detail_HMI'] !== undefined) {\r\n            for (let k = 0; k < arrValue[j]['Error_Detail_HMI'].length; k++) {\r\n                let checkExistErr =false;\r\n                checkExistErr = arrErrorAll.find(element => {\r\n                    if (element.err_key === arrValue[j]['Error_Detail_HMI'][k].err_key) {\r\n                        return true;\r\n                    }\r\n                });\r\n                if(!checkExistErr){\r\n                    arrErrorAll.push({err_key:arrValue[j]['Error_Detail_HMI'][k].err_key,total:0})\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n    //tính tổng value của từng lỗi\r\n    for (let i = 0; i < arrErrorAll.length; i++) {\r\n        let count = 0;\r\n        for (let j = 0; j < arrValue.length; j++) {\r\n            if (arrValue[j]['Error_Detail'] !== undefined) {\r\n                for (let k = 0; k < arrValue[j]['Error_Detail'].length; k++) {\r\n                    if (arrValue[j]['Error_Detail'][k]['err_key'] === arrErrorAll[i]['err_key']) {\r\n                        count = count + parseInt(arrValue[j]['Error_Detail'][k]['value']);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        arrErrorAll[i].total = count\r\n    }\r\n    for(let m = 0;m < arrName.length; m++){\r\n        for (let i = 0; i< arrGroupName.length;i++){\r\n            if(arrName[m].groupName === arrGroupName[i].groupName){\r\n                if(arrErrorAll.find(x => x.err_key==arrGroupName[i].err_key) !=undefined){\r\n                    arrName[m].value = arrName[m].value + arrErrorAll.find(x => x.err_key==arrGroupName[i].err_key).total;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    let objectUndefined = {'groupName':undefined,value : 0}\r\n    for (let i = 0; i < arrErrorAll.length; i++) {\r\n        let checkExistErr =false;\r\n        checkExistErr = arrError.find(element => {\r\n            if (element.err_key === arrErrorAll[i].err_key) {\r\n                return true;\r\n            }\r\n        });\r\n        if(!checkExistErr){\r\n            objectUndefined.value = objectUndefined.value + arrErrorAll[i].total;\r\n        }\r\n    }\r\n    arrName.push(objectUndefined)\r\n    return arrName.filter(e=>e.value !== 0);\r\n}\r\nfunction chart_data(mappingErr) {\r\n    gaugeData = [];\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n\r\n        var list_stage = JSON.parse(partData[0].data[0][1]);\r\n        \r\n        var group_error = [];\r\n        let result = mapping(list_stage, mappingErr);\r\n        console.log(\"input_tutt20\",     JSON.stringify(list_stage));\r\n        console.log(\"mappingErr_tutt20\",JSON.stringify(mappingErr));\r\n        console.log(\"result_tutt20\",result);\r\n        if (result != \"\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                //data.labels[i]=(list_stage[i].stage_name);\r\n                //let value_hmi_err = list_stage[i].Number_Of_Hmi_Error ? parseInt(list_stage[i].Number_Of_Hmi_Error) : 0\r\n                let value = parseInt(result[i].value);\r\n                var name  = (result[i].groupName);\r\n                var element = { value: 0, name: '' };\r\n                element.name = (result[i].groupName);\r\n                element.value = value;\r\n                legendData[i] = result[i].groupName;\r\n                console.log(\"element\", element)\r\n                if(value>0){\r\n                gaugeData[i] = element;\r\n                }\r\n            }\r\n\r\n        }\r\n        console.log(\"gaugeData_nhom\", gaugeData);\r\n    } else {\r\n\r\n        gaugeData = [];\r\n    }\r\n}\r\nself.onInit = function () {\r\n    scope = self.ctx.$scope;\r\n    $scope = self.ctx.$scope;\r\n    customDialog = $scope.$injector.get(self.ctx.servicesMap\r\n        .get('customDialog'));\r\n    attributeService = $scope.$injector.get(self.ctx\r\n        .servicesMap.get('attributeService'));\r\n    datasource = self.ctx.datasources;\r\n    get_temp_data(attributeService);\r\n}\r\n//var gaugeData = [];\r\n//lay du lieu trong nhom loi\r\nfunction get_temp_data(attributeService) {\r\n    //huongnv75 start 11072022\r\n    $.get(\"http://192.168.68.21:8888/publicAsset\", function(data, status){\r\n        var template = [];\r\n        var mappingErr = data? data: template;\r\n        draw(mappingErr);\r\n        self.onResize();\r\n\r\n    });\r\n    //huongnv75 end  11072022\r\n    //huongnv75 start comment 11072022\r\n    // var entitycommon = {\r\n    //     entityType: \"ASSET\",\r\n    //     id: \"c4c13d20-af47-11ec-a2e4-f190c8c68231\"\r\n    // }\r\n    // attributeService.getEntityAttributes(entitycommon, 'SERVER_SCOPE', [\"error_mapping\"]).subscribe(data => {\r\n    //     var template = [];\r\n    //     console.log(\"data[0].value-------------->\", data[0].value);\r\n    //     var mappingErr = data[0] ? data[0].value : template;\r\n    //     console.log(\"mappingErr\", mappingErr);\r\n    //     var element = { value: 0, name: '' };\r\n    //     draw(mappingErr);\r\n    //     self.onResize();\r\n    // });\r\n    //huongnv75 end comment 11072022\r\n\r\n}\r\n\r\nfunction draw(mapping) {\r\n\r\n    var dom = document.getElementById(\"chart_nhom\");\r\n    var myChart = echarts.init(dom);\r\n    var app = {};\r\n    option = null;\r\n    chart_data(mapping);\r\n    option = {\r\n        title: {\r\n            show: false,\r\n            text: 'EChart Pie',\r\n            subtext: 'Tỉ lệ lỗi công đoạn',\r\n            left: 'center'\r\n        },\r\n        tooltip: {\r\n            trigger: 'item',\r\n            formatter: '{a} <br/>{b} : {c} ({d}%)'\r\n        },\r\n        legend: {\r\n            // orient: 'vertical',\r\n            // top: 'middle',\r\n            show: true,\r\n            bottom: 4,\r\n            color: 'white',\r\n            left: 'center',\r\n            data: legendData\r\n        },\r\n        series: [\r\n            {\r\n                name: \"Tỉ lệ\",\r\n                type: 'pie',\r\n                color: ['green', 'red', 'blue', 'yellow', 'violet', 'cyan'\r\n                    //[\"#ff8337\",\"53afff\",\"de6fff\",\"ffe272\",\"ff74bc\",\"9de16f\",\"ff3737\"\r\n                ],\r\n                radius: '90%',\r\n                center: ['50%', '50%'],\r\n                selectedMode: 'single',\r\n                data: gaugeData,\r\n                // [\r\n                //     {value: 15, name: 'Drama'},\r\n                //     {value: 30, name: 'Scifi'},\r\n                //     {value: 16, name: 'Crime'},\r\n                //     {value: 3, name: 'Horror'}\r\n                // ],\r\n                emphasis: {\r\n                    itemStyle: {\r\n                        shadowBlur: 10,\r\n                        shadowOffsetX: 0,\r\n                        shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n                    }\r\n                },\r\n                label: {\r\n                    // color: ['white','white','white','white','white','white','white','white'],\r\n                    // fontSize :60,\r\n                    normal: {\r\n                        //formatter: '{b} : {c}',\r\n                        formatter: '{b} ({d}%)',\r\n                        position: 'inside', //inside\r\n                        fontSize: 20,\r\n                        color: 'white',\r\n                        center: 'center'\r\n                    }\r\n                },\r\n            }\r\n        ]\r\n    };\r\n\r\n    if (option && typeof option === \"object\") {\r\n        myChart.setOption(option, true);\r\n    }\r\n    // option && myChart.setOption(option);\r\n}\r\n//1- list_stage\r\n//2- numberOfPlanning\r\n//3- runningTime\r\n//4- startTime\r\n//- planningTime\r\nself.onDataUpdated = function () {\r\n    //chart_data();\r\n    //draw();\r\n    get_temp_data(attributeService);\r\n}\r\n\r\nself.onResize = function () {\r\n    if (self.ctx.width > self.ctx.height)\r\n        $('#chart_nhom', self.ctx.$container)[0].style.zoom = self.ctx.height / 500;\r\n    else\r\n        $('#chart_nhom', self.ctx.$container)[0].style.zoom = self.ctx.width / 500;\r\n\r\n    self.ctx.detectChanges();\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"err_group_stage_echart\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "showtime",
      "name": "showTime",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          }
        ],
        "templateHtml": "<div class=\"text-center\">\r\n    <img height=\"30px\" src=\"data:image/jpeg;base64,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\"/>\r\n    </div>\r\n<div class=\"d-flex justify-content-center\">\r\n    <button class= \"btn-circle m-2\">\r\n    </button>\r\n    <button class= \"btn-circle m-2\">\r\n    </button>\r\n    <button class= \"btn-circle m-2\">\r\n    </button>\r\n</div>\r\n<div class=\"d-flex justify-content-center\">\r\n    <span class=\"m-2\">PLC</span>\r\n    <span class=\"m-2\">IOT</span>\r\n    <span class=\"m-2\">API</span>\r\n</div>\r\n<div>\r\n<label id=\"L_OEE\">OEE: </label><br>\r\n<label id=\"L_error\">Tổng số lỗi: </label><br>\r\n<label id=\"L_Start_Time\">Thời gian chạy: </label><br>\r\n<label id=\"L_Resume_Time\"></label><br>\r\n<label id=\"L_Running_Time\">Thời gian chạy máy:</label><br>\r\n<label id=\"L_Stopping_Time\">Dừng máy: </label><br>\r\n<label id=\"L_Real_Productivity\">Năng suất thực tính: </label><br>\r\n<label id=\"L_Default_Productivity\">Năng suất mặc định: </label><br>\r\n<label id=\"L_Speed\">Tốc độ: </label>\r\n</div>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}\n.card {\n   width: 100%;\n   height: 100%;\n   border: 2px solid #ccc;\n   box-sizing: border-box;\n}\n\n.card .content {\n   padding: 20px;\n   display: flex;\n   flex-direction: row;\n   align-items: center;\n   justify-content: space-around;\n   height: 100%;\n   box-sizing: border-box;\n}\n\n.card .content .column {\n   display: flex;\n   flex-direction: column;    \n   justify-content: space-around;\n   height: 100%;\n}\n\n.card h1 {\n    text-transform: uppercase;\n    color: #999;\n    font-size: 20px;\n    font-weight: bold;\n    margin: 0;\n    padding-bottom: 10px;\n    line-height: 32px;\n}\n\n.card .value {\n    font-size: 38px;\n    font-weight: 200;\n}\n\n.card .description {\n    font-size: 20px;\n    color: #999;\n}\n",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\nvar list_stage;\r\nfunction show_time() {\r\n    $scope = self.ctx.$scope;\r\n    $container = self.ctx.$container;\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        var STATUS = partData[0].data[0][1];\r\n        var OLDSTATUS = partData[1].data[0][1];\r\n        console.log(\"STATUS1111\", STATUS);\r\n        var runningTime = partData[2].data[0][1];\r\n        var stoppingTime = partData[3].data[0][1];\r\n        var startTime = partData[4].data[0][1];\r\n        var stopTime = partData[5].data[0][1];\r\n        var resumTime = partData[6].data[0][1];\r\n        var cycle_time = parseInt(partData[7].data[0][1])\r\n        var speed = partData[8].data[0][1]\r\n        list_stage = JSON.parse(partData[9].data[0][1]);\r\n        var Planning_Time = partData[10]?parseInt(partData[10].data[0][1]):0\r\n        var Number_Of_Planning = partData[11]?parseInt(partData[11].data[0][1]):0;\r\n        var countRunning;\r\n        var countStoping;\r\n        switch (STATUS) {\r\n            case 1:\r\n                countRunning = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n                countStoping = parseInt(stoppingTime) / 1000;\r\n                break;\r\n            case 3:\r\n                countRunning = parseInt(runningTime) / 1000;\r\n                countStoping = Math.floor((Date.now() - parseInt(stopTime) + parseInt(stoppingTime)) / 1000);\r\n                break;\r\n            case 5:\r\n                countRunning = parseInt(runningTime) / 1000;\r\n                countStoping = parseInt(stoppingTime) / 1000;\r\n                break;\r\n\r\n        }\r\n        //countRunning = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n        var output = parseInt(list_stage[list_stage.length - 1].Number_Of_Output);\r\n        var input = parseInt(list_stage[0].Number_Of_Input);\r\n        var sum_err = 0;\r\n        for (let i = 0; i < list_stage.length; i++) {\r\n            var hmi_eror = list_stage[i].Number_Of_Hmi_Error ? list_stage[i].Number_Of_Hmi_Error : 0\r\n            var common_err = list_stage[i].Number_Of_Error ? list_stage[i].Number_Of_Error : 0\r\n            sum_err = sum_err + parseInt(common_err) + parseInt(hmi_eror)\r\n        }\r\n        var nsthuctinh = output / (countRunning / 3600)\r\n        var OEE ;\r\n        if ((countRunning > 0) && (input>0) && (cycle_time>0) && (Planning_Time>0) && (Number_Of_Planning>0)) {\r\n            //var OEE1 = parseInt(countRunning) / (parseInt(countStoping) + parseInt(countRunning)) //* \r\n            var OEE1 = parseInt(countRunning)/parseInt(Planning_Time)\r\n            var OEE2 = parseFloat(cycle_time) * (parseInt(input) / parseInt(countRunning))\r\n            //var OEE3 = (parseInt(input) - parseInt(sum_err)) / parseInt(input)\r\n            var OEE3 = parseInt(output)/parseInt(Number_Of_Planning)\r\n            console.log(\"OEE1 \", OEE1);\r\n            console.log(\"OEE2 \", OEE2);\r\n            console.log(\"OEE3: \", OEE3);\r\n            OEE = OEE1 * OEE2 * OEE3\r\n        }else{\r\n            OEE = 0;\r\n        }\r\n        console.log(\"countRunning\", countRunning);\r\n        // var OEE = (parseInt(runningTime_OEE)/(parseInt(runningTime_OEE)+parseInt(stoppingTime_OEE)/1000)) * (parseInt(cycle_time/1000)*parseInt(input))/parseInt(runningTime_OEE) *((parseInt(input)-parseInt(sum_err))/parseInt(input))\r\n        document.getElementById(\"L_error\").innerHTML = \"Tổng số lỗi: \" + parseInt(sum_err)\r\n        //this.countRunning+=1;L_OEE\r\n\r\n        //document.getElementById(\"L_Running_Time\").innerHTML = \"Thời gian chạy máy: \" + secondsToHms(parseInt(runningTime) / 1000)\r\n        document.getElementById(\"L_Running_Time\").innerHTML = \"Thời gian chạy máy: \" + secondsToHms(parseInt(countRunning))\r\n        document.getElementById(\"L_Stopping_Time\").innerHTML = \"Dừng máy: \" + secondsToHms(countStoping)\r\n        document.getElementById(\"L_Start_Time\").innerHTML = \"Thời gian bắt đầu chạy: \" + timeConverter(parseInt(startTime))\r\n        document.getElementById(\"L_Real_Productivity\").innerHTML = \"Năng suất thực tính: \" + parseInt(nsthuctinh)\r\n        document.getElementById(\"L_error\").innerHTML = \"Tổng số lỗi: \" + parseInt(sum_err)\r\n        document.getElementById(\"L_OEE\").innerHTML = \"OEE: \" + parseFloat(OEE).toFixed(2);\r\n        self.onResize();\r\n    }\r\n}\r\nself.onInit = function () {\r\n    setInterval(function () {\r\n        console.log(\"interval\", 1000);\r\n        show_time(), 1000\r\n\r\n    });\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n    // setInterval(function () {\r\n    // console.log(\"interval\",1000);\r\n    // show_time(),1000\r\n\r\n    // });\r\n}\r\n\r\nself.onResize = function () {\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\nfunction secondsToHms(secs) {\r\n    var time = new Date();\r\n    // create Date object and set to today's date and time\r\n    time.setHours(parseInt(secs / 3600) % 24);\r\n    time.setMinutes(parseInt(secs / 60) % 60);\r\n    time.setSeconds(parseInt(secs % 60));\r\n    time = time.toTimeString().split(\" \")[0];\r\n    return time;\r\n}\r\nfunction timeConverter(UNIX_timestamp) {\r\n    var a = new Date(UNIX_timestamp);\r\n    var months = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];\r\n    var year = a.getFullYear();\r\n    var month = months[a.getMonth()];\r\n    var date = a.getDate();\r\n    var hour = a.getHours();\r\n    var min = a.getMinutes();\r\n    var sec = a.getSeconds();\r\n    var time = date + '/' + month + '/' + year + '/ ' + hour + ':' + min + ':' + sec;\r\n    return time;\r\n}\r\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"showTime\"}"
      },
      "image": null,
      "description": null
    },
    {
      "alias": "showTime_nhua",
      "name": "showTime_nhua",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          }
        ],
        "templateHtml": "<div class=\"text-center\">\r\n    <img height=\"30px\" src=\"data:image/jpeg;base64,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\"/>\r\n    </div>\r\n<div class=\"d-flex justify-content-center\">\r\n    <button class= \"btn-circle m-2\">\r\n    </button>\r\n    <button class= \"btn-circle m-2\">\r\n    </button>\r\n    <button class= \"btn-circle m-2\">\r\n    </button>\r\n</div>\r\n<div class=\"d-flex justify-content-center\">\r\n    <span class=\"m-2\">PLC</span>\r\n    <span class=\"m-2\">IOT</span>\r\n    <span class=\"m-2\">API</span>\r\n</div>\r\n<div>\r\n<label id=\"L_OEE\">OEE: </label><br>\r\n<label id=\"L_error\">Tổng số lỗi: </label><br>\r\n<label id=\"L_Start_Time\">Thời gian chạy: </label><br>\r\n<label id=\"L_Resume_Time\"></label><br>\r\n<label id=\"L_Running_Time\">Thời gian chạy máy:</label><br>\r\n<label id=\"L_Stopping_Time\">Dừng máy: </label><br>\r\n<label id=\"L_Real_Productivity\">Năng suất thực tính: </label><br>\r\n<label id=\"L_Default_Productivity\">Năng suất mặc định: </label><br>\r\n<label id=\"L_Speed\">Tốc độ: </label>\r\n<label id=\"L_nhuaduavao\"></label><br>\r\n<label id=\"L_nhualoi\"></label><br>\r\n<label id=\"L_nhuadadung\"></label><br>\r\n<label id=\"L_tongchieudai\"></label>\r\n</div>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}\n.card {\n   width: 100%;\n   height: 100%;\n   border: 2px solid #ccc;\n   box-sizing: border-box;\n}\n\n.card .content {\n   padding: 20px;\n   display: flex;\n   flex-direction: row;\n   align-items: center;\n   justify-content: space-around;\n   height: 100%;\n   box-sizing: border-box;\n}\n\n.card .content .column {\n   display: flex;\n   flex-direction: column;    \n   justify-content: space-around;\n   height: 100%;\n}\n\n.card h1 {\n    text-transform: uppercase;\n    color: #999;\n    font-size: 20px;\n    font-weight: bold;\n    margin: 0;\n    padding-bottom: 10px;\n    line-height: 32px;\n}\n\n.card .value {\n    font-size: 38px;\n    font-weight: 200;\n}\n\n.card .description {\n    font-size: 20px;\n    color: #999;\n}\n",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\nvar list_stage;\r\nfunction show_time() {\r\n    $scope = self.ctx.$scope;\r\n    $container = self.ctx.$container;\r\n    const partData = self.ctx.data;\r\n    if (partData[0].data.length > 0) {\r\n        var STATUS = partData[0].data[0][1];\r\n        var OLDSTATUS = partData[1].data[0][1];\r\n        console.log(\"STATUS1111\", STATUS);\r\n        var runningTime = partData[2].data[0][1];\r\n        var stoppingTime = partData[3].data[0][1];\r\n        var startTime = partData[4].data[0][1];\r\n        var stopTime = partData[5].data[0][1];\r\n        var resumTime = partData[6].data[0][1];\r\n        var cycle_time = parseInt(partData[7].data[0][1])\r\n        var speed = partData[8].data[0][1]\r\n        list_stage = JSON.parse(partData[9].data[0][1]);\r\n        var nhua_duavao = parseFloat(partData[10].data[0][1])\r\n        var nhua_loi = parseFloat(partData[11].data[0][1])\r\n        var chieudai = parseFloat(partData[12].data[0][1])\r\n        var nhua_dadung = (nhua_duavao-nhua_loi).toFixed(2);\r\n        var Planning_Time = partData[13]?parseInt(partData[13].data[0][1]):0\r\n        var Number_Of_Planning = partData[14]?parseInt(partData[14].data[0][1]):0;\r\n        var countRunning;\r\n        var countStoping;\r\n        switch (STATUS) {\r\n            case 1:\r\n                countRunning = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n                countStoping = parseInt(stoppingTime) / 1000;\r\n                break;\r\n            case 3:\r\n                countRunning = parseInt(runningTime) / 1000;\r\n                countStoping = Math.floor((Date.now() - parseInt(stopTime) + parseInt(stoppingTime)) / 1000);\r\n                break;\r\n            case 5:\r\n                countRunning = parseInt(runningTime) / 1000;\r\n                countStoping = parseInt(stoppingTime) / 1000;\r\n                break;\r\n\r\n        }\r\n        //countRunning = Math.floor((Date.now() - parseInt(startTime) + parseInt(runningTime)) / 1000);\r\n        var output = parseInt(list_stage[list_stage.length - 1].Number_Of_Output);\r\n        var input = parseInt(list_stage[0].Number_Of_Input);\r\n        var sum_err = 0;\r\n        for (let i = 0; i < list_stage.length; i++) {\r\n            var hmi_eror = list_stage[i].Number_Of_Hmi_Error ? list_stage[i].Number_Of_Hmi_Error : 0\r\n            var common_err = list_stage[i].Number_Of_Error ? list_stage[i].Number_Of_Error : 0\r\n            sum_err = sum_err + parseInt(common_err) + parseInt(hmi_eror)\r\n        }\r\n        var nsthuctinh = output / (countRunning / 3600)\r\n        var OEE ;\r\n        if ((countRunning > 0) && (input>0) && (cycle_time>0) && (Planning_Time>0) && (Number_Of_Planning>0)) {\r\n            //var OEE1 = parseInt(countRunning) / (parseInt(countStoping) + parseInt(countRunning)) //* \r\n            var OEE1 = parseInt(countRunning)/parseInt(Planning_Time)\r\n            var OEE2 = parseFloat(cycle_time) * (parseInt(input) / parseInt(countRunning))\r\n            //var OEE3 = (parseInt(input) - parseInt(sum_err)) / parseInt(input)\r\n            var OEE3 = parseInt(output)/parseInt(Number_Of_Planning)\r\n            console.log(\"OEE1 \", OEE1);\r\n            console.log(\"OEE2 \", OEE2);\r\n            console.log(\"OEE3: \", OEE3);\r\n            OEE = OEE1 * OEE2 * OEE3\r\n        }else{\r\n            OEE = 0;\r\n        }\r\n        console.log(\"countRunning\", countRunning);\r\n        // var OEE = (parseInt(runningTime_OEE)/(parseInt(runningTime_OEE)+parseInt(stoppingTime_OEE)/1000)) * (parseInt(cycle_time/1000)*parseInt(input))/parseInt(runningTime_OEE) *((parseInt(input)-parseInt(sum_err))/parseInt(input))\r\n        document.getElementById(\"L_error\").innerHTML = \"Tổng số lỗi: \" + parseInt(sum_err)\r\n        //this.countRunning+=1;L_OEE\r\n\r\n        //document.getElementById(\"L_Running_Time\").innerHTML = \"Thời gian chạy máy: \" + secondsToHms(parseInt(runningTime) / 1000)\r\n        document.getElementById(\"L_Running_Time\").innerHTML = \"Thời gian chạy máy: \" + secondsToHms(parseInt(countRunning))\r\n        document.getElementById(\"L_Stopping_Time\").innerHTML = \"Dừng máy: \" + secondsToHms(countStoping)\r\n        document.getElementById(\"L_Start_Time\").innerHTML = \"Thời gian bắt đầu chạy: \" + timeConverter(parseInt(startTime))\r\n        document.getElementById(\"L_Real_Productivity\").innerHTML = \"Năng suất thực tính: \" + parseInt(nsthuctinh)\r\n        document.getElementById(\"L_error\").innerHTML = \"Tổng số lỗi: \" + parseInt(sum_err)\r\n        document.getElementById(\"L_OEE\").innerHTML = \"OEE: \" + parseFloat(OEE).toFixed(2);\r\n        document.getElementById(\"L_nhuaduavao\").innerHTML = \"Nhựa đưa vào: \"+ nhua_duavao\r\n        document.getElementById(\"L_nhualoi\").innerHTML = \"Nhựa lỗi: \"+ nhua_loi\r\n        document.getElementById(\"L_nhuadadung\").innerHTML = \"Nhựa đã dùng: \"+ nhua_dadung\r\n        document.getElementById(\"L_tongchieudai\").innerHTML = \"Tổng chiều dài: \"+ chieudai\r\n        self.onResize();\r\n    }\r\n}\r\nself.onInit = function () {\r\n    setInterval(function () {\r\n        console.log(\"interval\", 1000);\r\n        show_time(), 1000\r\n\r\n    });\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n    // setInterval(function () {\r\n    // console.log(\"interval\",1000);\r\n    // show_time(),1000\r\n\r\n    // });\r\n}\r\n\r\nself.onResize = function () {\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}\r\nfunction secondsToHms(secs) {\r\n    var time = new Date();\r\n    // create Date object and set to today's date and time\r\n    time.setHours(parseInt(secs / 3600) % 24);\r\n    time.setMinutes(parseInt(secs / 60) % 60);\r\n    time.setSeconds(parseInt(secs % 60));\r\n    time = time.toTimeString().split(\" \")[0];\r\n    return time;\r\n}\r\nfunction timeConverter(UNIX_timestamp) {\r\n    var a = new Date(UNIX_timestamp);\r\n    var months = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];\r\n    var year = a.getFullYear();\r\n    var month = months[a.getMonth()];\r\n    var date = a.getDate();\r\n    var hour = a.getHours();\r\n    var min = a.getMinutes();\r\n    var sec = a.getSeconds();\r\n    var time = date + '/' + month + '/' + year + '/ ' + hour + ':' + min + ':' + sec;\r\n    return time;\r\n}\r\n",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"showTime_nhua\"}"
      },
      "image": null,
      "description": null
    }
  ]
}