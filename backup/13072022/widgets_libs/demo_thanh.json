{
  "widgetsBundle": {
    "alias": "demo_thanh",
    "title": "demo_thanh",
    "image": null,
    "description": null
  },
  "widgetTypes": [
    {
      "alias": "demo_table",
      "name": "demo_table",
      "descriptor": {
        "type": "latest",
        "sizeX": 7.5,
        "sizeY": 3,
        "resources": [
          {
            "url": "https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"
          },
          {
            "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          }
        ],
        "templateHtml": "\r\n    <input type=\"hidden\" id=\"hfRowIndex\" value=\"\" />\r\n    <table class=\" table-striped\">\r\n        <tr>\r\n            <td>Mã sản phẩm</td>\r\n            <td>\r\n                <input type=\"text\" name=\"Id\" id=\"txtId\" value=\"\" class=\"form-control\" />\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td>Tên sản phẩm</td>\r\n                <td>\r\n                    <input type=\"text\" name=\"Name\" id=\"txtName\" value=\"\" class=\"form-control\"/>\r\n                </td>\r\n        </tr>\r\n        <tr>\r\n            <td>Trạng thái sử dụng</td>\r\n            <td>\r\n                <section>\r\n                     <input type=\"radio\" id=\"btn-Active\" style=\"padding-right:40px;padding-top:15px;\" name=\"check\" value=\"Active\" />\r\n                       <label style=\"padding:15px 10px 0;\" for=\"btn-Active\">Active</label>\r\n                      <input type=\"radio\" id=\"btn-Active\" name=\"check\" value=\"Inactive\" />\r\n                        <label for=\"btn-Active\" style=\"padding:15px 10px 0;\">Inactive</label>\r\n                </section>\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td>\r\n                <button mat-button mat-raised-button color=\"primary\" style=\"margin-right: 20px; margin-top:25px;\" type=\"button\" id=\"btnAdd\">\r\n                Add\r\n            </button>\r\n            <button mat-button mat-raised-button color=\"primary\" style=\"margin-right: 20px;\" type=\"button\" id=\"btnUpdate\">\r\n                Update\r\n            </button>\r\n            </td>\r\n            <td>\r\n                \r\n                <button mat-button mat-raised-button color=\"accent\" style=\"margin-right: 20px;margin-top:25px;\" type=\"button\" id=\"btnDelete\">\r\n                Delete\r\n            </button>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n<br>\r\n    <table id=\"tblCustomers\" class=\"table table-striped\" cellspacing=\"0\" width=\"100%\">\r\n        <thead>\r\n            <tr>\r\n                <th>Mã SP</th>\r\n                <th>Tên SP</th>\r\n                <th>Trạng Thái</th>\r\n                <th>Edit</th>\r\n                <th>Delete</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody></tbody>\r\n    </table>\r\n<div>\r\n   <button id = \"saveButton\" type=\"button\" class=\"btn btn-outline-primary\">Lưu</button>\r\n</div>",
        "templateCss": "#container {\n    overflow: auto;\n}\n\n.tbDatasource-container {\n    margin: 5px;\n    padding: 8px;\n}\n\n.tbDatasource-title {\n    font-size: 1.200rem;\n    font-weight: 500;\n    padding-bottom: 10px;\n}\n\n.tbDatasource-table {\n    width: 100%;\n    box-shadow: 0 0 10px #ccc;\n    border-collapse: collapse;\n    white-space: nowrap;\n    font-size: 1.000rem;\n    color: #757575;\n}\n\n.tbDatasource-table td {\n    position: relative;\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n    padding: 0px 18px;\n    box-sizing: border-box;\n}\n",
        "controllerScript": "let $scope;\r\nlet settings;\r\nlet attributeService;\r\nlet utils;\r\nlet translate;\r\nlet $container;\r\nlet dialog;\r\nvar productList = [\r\n    {\r\n        \"productCode\": \"Code_001\",\r\n        \"productName\": \"Name_001\"\r\n    },\r\n    {\r\n        \"productCode\": \"Code_002\",\r\n        \"productName\": \"Name_002\"\r\n    },\r\n    {\r\n        \"productCode\": \"Code_003\",\r\n        \"productName\": \"Name_003\"\r\n    }\r\n]\r\n\r\nself.onInit = function () {\r\n    $scope = self.ctx.$scope;\r\n    utils = $scope.$injector.get(self.ctx.servicesMap.get(\r\n        'utils'));\r\n    settings = utils.deepClone(self.ctx.settings) || {};\r\n    settings.showLabel = utils.defaultValue(settings\r\n        .showLabel, true);\r\n    settings.showResultMessage = utils.defaultValue(settings\r\n        .showResultMessage, true);\r\n    $scope.settings = settings;\r\n    $scope = self.ctx.$scope;\r\n    var datasource = self.ctx.datasources;\r\n\r\n    $container = self.ctx.$container;\r\n    attributeService = $scope.$injector.get(self.ctx.servicesMap.get('attributeService'));\r\n    var dataSet = [];\r\n        $(function () {\r\n            $('#btnShow').on('click', function(){\r\n                $('#formAdd').removeClass('hidden');\r\n            })\r\n            $('#btnAdd').on('click', function () {\r\n                var name, acitve, id;\r\n                id = $(\"#txtId\").val();\r\n                name = $(\"#txtName\").val();\r\n                active = $(\"#btn-Active[name=check]:checked\").val();\r\n                console.log(active);\r\n                var edit = \"<a class='edit' href='JavaScript:void(0);' >Edit</a>\";\r\n                var del = \"<a class='delete' href='JavaScript:void(0);'>Delete</a>\";\r\n                let arr = [];\r\n                arr.push(id);\r\n                arr.push(name);\r\n                arr.push(active);\r\n                dataSet.push(arr);\r\n                if (name == \"\" || id == \"\") {\r\n                    alert(\"Name and Code fields required!\");\r\n                } else {\r\n                    var table = \"<tr><td>\" + id + \"</td><td>\" + name + \"</td><td>\" + active + \"</td><td>\" + edit + \"</td><td>\" + del + \"</td></tr>\";\r\n                    $(\"#tblCustomers\").append(table);\r\n                }\r\n                id = $(\"#txtId\").val(\"\");\r\n                name = $(\"#txtName\").val(\"\");\r\n                active = $(\"#btn-Active\").val(\"\");\r\n                Clear();\r\n            });\r\n \r\n            $('#btnUpdate').on('click', function () {\r\n                var name, active, id;\r\n                id = $(\"#txtId\").val();\r\n                name = $(\"#txtName\").val();\r\n                active = $('#btn-Active[name=check]:checked').val();\r\n \r\n                $('#tblCustomers tbody tr').eq($('#hfRowIndex').val()).find('td').eq(1).html(name);\r\n                $('#tblCustomers tbody tr').eq($('#hfRowIndex').val()).find('td').eq(2).html(active)\r\n \r\n                $('#btnAdd').show();\r\n                $('#btnUpdate').hide();\r\n                Clear();\r\n            });\r\n \r\n            $(\"#tblCustomers\").on(\"click\", \".delete\", function (e) {\r\n                if (confirm(\"Are you sure want to delete this record!\")) {\r\n                    $(this).closest('tr').remove();\r\n                } else {\r\n                    e.preventDefault();\r\n                }\r\n            });\r\n \r\n            $('#btnClear').on('click', function () {\r\n                Clear();\r\n            });\r\n \r\n            $(\"#tblCustomers\").on(\"click\", \".edit\", function (e) {\r\n                var row = $(this).closest('tr');\r\n                $('#hfRowIndex').val($(row).index());\r\n                var td = $(row).find(\"td\");\r\n                $('#txtId').val($(td).eq(0).html());\r\n                $('#txtName').val($(td).eq(1).html());\r\n                $('#btn-Active[name=sex]:checked').val($(td).eq(2).html());\r\n                $('#btnAdd').hide();\r\n                $('#btnUpdate').show();\r\n            });\r\n        });\r\n        function Clear() {\r\n            $(\"#txtId\").val(\"\");\r\n            $(\"#txtName\").val(\"\");\r\n            $('#btn-Active[name=sex]:checked').val(\"\");\r\n            $(\"#hfRowIndex\").val(\"\");\r\n        }\r\n\r\n    $(document).ready(function () {\r\n        var table = $('#tblCustomers').DataTable({\r\n            data: dataSet,\r\n            columns: [{\r\n                title: \"Mã sản phẩm\"\r\n            },\r\n            {\r\n                title: \"Tên sản phẩm\"\r\n            },\r\n            {\r\n                title: \"Trạng thái sử dụng\"\r\n            }\r\n            ],\r\n\r\n            dom: 'Bfrtip',\r\n            select: true,\r\n            buttons: [{\r\n                text: 'Select all',\r\n                action: function () {\r\n                    table.rows().select();\r\n                }\r\n            },\r\n            {\r\n                text: 'Select none',\r\n                action: function () {\r\n                    table.rows().deselect();\r\n                }\r\n            }\r\n            ]\r\n        });\r\n    });\r\n\r\n    $(\"#saveButton\").click(function () {\r\n        alert(\"luu lai du lieu\");\r\n        //let attributeTimeSeries = [];\r\n        var product_update = [];\r\n        var list_product = JSON.stringify(dataSet);\r\n        product_update.push({\r\n            key: 'Product_List',\r\n            value: list_product\r\n        });\r\n        alert(list_product);\r\n        console.log(\"$scope.entityId\", datasource[0].entity.id);\r\n        attributeService.saveEntityAttributes(datasource[0].entity.id, 'SERVER_SCOPE', product_update).subscribe(\r\n            function success() {\r\n                console.log(\r\n                    \"Cập nhật trạng thái thành công\"\r\n                );\r\n                if (settings\r\n                    .showResultMessage\r\n                ) {\r\n                    $scope.showSuccessToast(\"Cập nhật thành công\");\r\n                }\r\n            },\r\n            function fail() {\r\n                if (settings\r\n                    .showResultMessage\r\n                ) {\r\n                    $scope.showErrorToast(\"Cập nhật thất bại\");\r\n                }\r\n            }\r\n        );\r\n\r\n\r\n    });\r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function () {\r\n}\r\n\r\nself.onResize = function () {\r\n\r\n}\r\n\r\nself.onDestroy = function () {\r\n}",
        "settingsSchema": "{}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"demo_table\",\"showTitleIcon\":false,\"titleTooltip\":\"\",\"dropShadow\":true,\"enableFullscreen\":true,\"widgetStyle\":{},\"widgetCss\":\"\",\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"noDataDisplayMessage\":\"\",\"showLegend\":false}"
      },
      "image": null,
      "description": null
    }
  ]
}